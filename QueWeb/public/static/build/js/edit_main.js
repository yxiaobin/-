!function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=43)}([function(t,e,i){"use strict";i.d(e,"b",function(){return l}),i.d(e,"B",function(){return d}),i.d(e,"t",function(){return r}),i.d(e,"c",function(){return c}),i.d(e,"A",function(){return p}),i.d(e,"x",function(){return u}),i.d(e,"u",function(){return m}),i.d(e,"j",function(){return v}),i.d(e,"s",function(){return f}),i.d(e,"p",function(){return h}),i.d(e,"o",function(){return q}),i.d(e,"r",function(){return g}),i.d(e,"h",function(){return w}),i.d(e,"d",function(){return b}),i.d(e,"e",function(){return y}),i.d(e,"l",function(){return x}),i.d(e,"k",function(){return T}),i.d(e,"w",function(){return j}),i.d(e,"q",function(){return $}),i.d(e,"C",function(){return C}),i.d(e,"v",function(){return S}),i.d(e,"n",function(){return k}),i.d(e,"m",function(){return I}),i.d(e,"y",function(){return E}),i.d(e,"f",function(){return O}),i.d(e,"i",function(){return N}),i.d(e,"a",function(){return P}),i.d(e,"z",function(){return U}),i.d(e,"g",function(){return L});var o=i(16),n=i(13),a=i(5),s=i(11),_=i(1);function l(t){if(this.question=arguments[0]||null,isNotEmpty(this.question)&&(this.qid=get_oid(this.question),this.title=copy_obj(this.question.title),isNotEmpty(this.question.cid))){var e=copy_obj(this.question.cid);this.seq=e.substring(1,e.length)}}function d(t){l.call(this,t)}function r(t){l.call(this,t)}function c(t){l.call(this,t)}function p(t){l.call(this,t)}function u(t){l.call(this,t)}function m(t){l.call(this,t)}function v(t){l.call(this,t)}function f(t){l.call(this,t)}function h(t){l.call(this,t)}function q(t){l.call(this,t)}function g(t){l.call(this,t)}function w(t){l.call(this,t)}function b(t){c.call(this,t)}function y(t){m.call(this,t)}function x(t){d.call(this,t)}function T(t){r.call(this,t)}function j(t){p.call(this,t)}function $(t){p.call(this,t)}function C(t){d.call(this,t)}function S(t){l.call(this,t)}function k(t){d.call(this,t)}function I(t){r.call(this,t)}function E(t){p.call(this,t);var e=t.custom_attr.min_answer_num,i=t.custom_attr.max_answer_num,o=Object(a.d)(e,i);t.custom_attr.tick_data=o,t.custom_attr.tick_width=100/(o.length-1)}function O(t){l.call(this,t)}function N(t){p.call(this,t)}function P(t){m.call(this,t),t.custom_attr.stem_content_obj_list=Object(s.a)(t.custom_attr.stem_content_list),Object(s.b)(t.extra_option_list)}function U(t){p.call(this,t)}function L(t){m.call(this,t)}l.prototype.set_question=function(t){this.question=t},l.prototype.get_survey_html=function(){return""},l.prototype.get_base_option_list=function(){return isNotEmpty(this.question.option_list)?this.question.option_list:[]},l.prototype.get_base_matrixrow_list=function(){return isNotEmpty(this.question.matrixrow_list)?this.question.matrixrow_list:[]},l.prototype.get_current_answer=function(){return total_answers[this.qid]},l.prototype.get_survey_source=function(){return""},l.prototype.gen_survey_template=function(){var t=this.get_survey_source(),e=Object(n.a)(["hidden","hideQuestionSeq"]);if(isNotEmpty(t)){var i=window.location.href,a=!1;i.indexOf("preview=1")>=0?a=i.indexOf("show_seq=1")>=0||!(i.indexOf("show_seq=0")>=0)&&1!=e:1!=e&&(a=!0);var s=this.question.custom_attr?this.question.custom_attr.allow_null:"";if(this.question.question_type===QUESTION_TYPE_BLANK&&(s=1===this.question.option_list.length&&this.question.option_list[0].custom_attr?this.question.option_list[0].custom_attr.allow_null:""),(a||"on"!==s)&&-1===this.title.indexOf("Qnum")&&70!=this.question.question_type){var l=Object(_.d)(this.title,this.seq,s,a);this.title='<span class="answer_title">'+l+"</span>"}return o.a.getHtml(this,t)}return console.warn("QModel: "+this+"has no survey_source yet."),""},l.prototype.get_selected=function(){return""},l.prototype.get_input=function(){return""},l.prototype.get_validate_function=function(){return function(){return!0}},l.prototype.get_getanswer_function=function(){return function(){return null}},l.prototype.bind_event_function=function(){},l.prototype.estimate_time=function(){return estimate_map[this.qid]},l.prototype.show_option_msg=function(t,e){},l.prototype.clear_option_msg=function(t){},l.prototype.get_custom_type=function(){return this.question.custom_attr.disp_type||this.question.custom_attr.drop_type},d.prototype=new l,r.prototype=new l,c.prototype=new l,p.prototype=new l,u.prototype=new l,m.prototype=new l,v.prototype=new l,f.prototype=new l,h.prototype=new l,q.prototype=new l,g.prototype=new l,w.prototype=new l,b.prototype=new l,y.prototype=new l,x.prototype=new d,T.prototype=new r,j.prototype=new p,$.prototype=new p,C.prototype=new d,S.prototype=new r,k.prototype=new x,I.prototype=new T,E.prototype=new p,O.prototype=new l,N.prototype=new p,P.prototype=new m,U.prototype=new p,L.prototype=new m},function(t,e,i){"use strict";i.d(e,"h",function(){return n}),i.d(e,"g",function(){return a}),i.d(e,"f",function(){return s}),i.d(e,"i",function(){return _}),i.d(e,"b",function(){return l}),i.d(e,"m",function(){return d}),i.d(e,"j",function(){return r}),i.d(e,"c",function(){return c}),i.d(e,"l",function(){return p}),i.d(e,"a",function(){return u}),i.d(e,"k",function(){return m}),i.d(e,"e",function(){return h}),i.d(e,"d",function(){return q});i(4);var o=i(12);i(10);function n(t){for(var e in QUESTION_DICT)if(get_oid(QUESTION_DICT[e])==t||QUESTION_DICT[e].cid==t)return QUESTION_DICT[e];return null}function a(t,e){var i=n(t);if(!isNotEmpty(i))return null;if(e.constructor==Array){for(var o=[],a=0;a<i.option_list.length;a++){var s=i.option_list[a];check_in(get_oid(s),e)&&o.push(s)}return o}for(a=0;a<i.option_list.length;a++){s=i.option_list[a];if(get_oid(s)==e)return s}for(a=0;a<i.related_question_list.length;a++)for(var _=0;_<i.related_question_list[a].option_list.length;_++){s=i.related_question_list[a].option_list[_];if(get_oid(s)==e)return s}for(a=0;a<i.extra_option_list.length;a++){s=i.extra_option_list[a];if(get_oid(s)==e)return s}return null}function s(t,e){var i=n(t);if(!isNotEmpty(i)||!isNotEmpty(i.matrixrow_list))return null;if(e.constructor!=String){var o=[];for(a=0;a<i.matrixrow_list.length;a++){s=i.matrixrow_list[a];check_in(get_oid(s),e)&&o.push(s)}return o}for(var a=0;a<i.matrixrow_list.length;a++){var s=i.matrixrow_list[a];if(get_oid(s)==e)return s}return null}function _(t){return QUESTIONPAGE_DICT[t]}function l(t){var e=$("#question_"+t).css("display"),i=!!isNotEmpty($("#question_"+t).attr("hideByLogic"));return!(isNotEmpty(e)&&"none"!=e||!i)}function d(t,e,i,o,n,a){for(var s=o.find(".uploadfile_loading"),_=i.name.replace(/[,锛宂/g,""),l=_.split(".")[_.split(".").length-1],d=_.split("."),r=[],c=0;c<d.length-1;c++)r.push(d[c]);d=r.join("."),o.find(".uploadfile_loading").removeClass("hide");var p=function(t,e,i,o){var n,a="",s=hex_md5((new Date).getTime()+"");return o=o.replace(/[&]/g,"_"),$.ajax({url:"/upload/qiniu/token/",type:"GET",data:"pid="+t+"&qid="+e+"&u="+o+"_"+s+"."+i,dataType:"json",async:!1,success:function(t){var e=t.data;e&&(n=e.uptoken,a=e.key)}}),{token:n,key:a}}(t,e,l,d),u=p.token,m=p.key;i.length<=0||!u||!m?a(e):function(t,e,i,o,n,a,s){var _,l,d,r=new XMLHttpRequest;r.open("POST","https://upload.qiniup.com",!0),_=new FormData,null!=t&&_.append("key",t);_.append("token",e),_.append("file",o),r.upload.addEventListener("progress",function(t){if(t.lengthComputable&&a.length){a.removeClass("hide");var e=(new Date).getTime();d=e-l;var i=t.loaded/1024,o=d/1e3,n=i/o;n>1024?(n/1024).toFixed(2)+"Mb/s":n.toFixed(2)+"Kb/s";var s=Math.round(100*t.loaded/t.total);a.find(".uploadfile_bar").width(s+"%"),a.find(".progress_txt").text(s+"%")}},!1),r.onreadystatechange=function(e){4==r.readyState&&200==r.status&&""!=r.responseText?s(i,t,n,o):200!=r.status&&r.responseText&&console.log("fdsafdsfasdf")},l=(new Date).getTime(),r.send(_)}(m,u,e,i,o,s,n)}function r(){return{png:["JPG","jpg","JPEG","jpeg","PNG","png","GIF","gif","TIFF","tiff"],doc:["DOC","doc","docx","DOCX","docm","DOCM","dotx","DOTX"],xlsx:["xls","XLS","xlsx","XLSX","xlsm","XLSM","xltx","XLTX","xltm","XLTM","xlsb","XLSB","xlam","XLAM"],ppt:["ppt","PPT","pps","PPS","pptx","PPTX","pptm","PPTM","ppsx","PPSX","potx","POTX","potm","POTM","ppam","PPAM","ppsm","PPSM"],pdf:["pdf","PDF"],zip:["rar","RAR","zip","ZIP","gzip","GZIP","GZip","7-zip","7-Zip","7-ZIP","7z","7Z","cab","CAB","arj","ARJ","lzh","LZH","ace","ACE","tar","TAR","uue","UUE","bz2","BZ2","jar","JAR","iso","ISO","z","Z"],mov:["wmv","WMV","rmvb","RMVB","rm","RM","asf","ASF","avi","AVI","navi","NAVI","3gp","3GP","3gpp","3GPP","dvd","DVD","ogm","OGM","mov","MOV","qt","QT","mpeg","MPEG","mpeg1","MPEG1","mpeg2","MPEG2","mpeg4","MPEG4","mpg","MPG","mpe","MPE","dat","DAT","flv","FLV","divx","DIVX","vob","VOB","mkv","MKV","mp4","MP4"],mp3:["MP3","mp3","OGG","ogg","WAV","wav","APE","ape","CDA","cda","AU","au","MAC","mac","SND","snd","AAC","aac","ACM","acm","aif","AIF","aifc","AIFC","aiff","AIFF","MIDI","midi","MID","mid","CMF","cmf","VOC","voc","SVX","svx"],html:["BAT","bat","HTML","html","HTM","htm","SHTML","shtml","SHTM","shtm","JS","js","CSS","css","svg","SVG"]}}function c(t,e,i){t.on({click:function(){var t=$(this);t.addClass("reupload"),$("#upload_files_"+e+" .upload_file").length>1?t.parents(".upload_file").remove():(t.parents(".upload_file").find(".option").val(""),t.parents(".upload_file").addClass("hide")),i&&i(e),$("#before_file_upload_"+e).removeClass("hide")}},".delete_link, .cancel ")}function p(t,e){var i=$("#upload_files_"+t+" .upload_file:first").clone();$("#upload_files_"+t).append(i),m(t),u($("#before_file_upload_"+t),e)}function u(t,e){t.on({click:function(){var t=e.qid,i=e.question.custom_attr.upload_num||1;($("#upload_files_"+t+" .upload_file").removeClass("rechoose"),i>1)&&$("#file_"+t)[0].setAttribute("multiple","multiple")}})}function m(t,e){(e=e||$("#upload_files_"+t).find(".upload_file:last")).find(".cancel").removeClass("hide"),e.find(".operation_file").addClass("hide"),e.find(".info_img").attr("data-type","").html(""),e.removeClass("upload_success")}function v(t,e,i){for(var o in t){var n=t[o];if(e==n.question_type&&(""==i||n.disp_type==i)&&"show"===n.option_show_video)return!0}}function f(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var i=t.match(/http(s)?:\/\/v.qq.com\/txp\/iframe\/player.html\?vid=([^&"]+)/)||t.match(/http(s)?:\/\/player.youku.com\/embed\/(.*)==/),o=parseInt(e),n=parseInt(e/1.78);return null!=i?t.replace(/<iframe.*<\/iframe>/,'<iframe class="video-show-iframe" src = "'+i[0]+'"  style="width:'+o+"px;height:"+n+'px;margin-top:10px;margin-bottom:10px;" frameborder="0" allowfullscreen referrerpolicy="origin"></iframe>'):t.replace(/<iframe.*<\/iframe>/,"")}return t.replace(/<iframe.*<\/iframe>/,"")}function h(t,e,i,n,a){var s,_=QUESTION_DICT[t.question_id].question_type,l=QUESTION_DICT[t.question_id].custom_attr.disp_type;s=v(o.a,_,l)||!1;var d="",r="";if(1==i)d=f(n,r="phone"==e?$("#question_"+t.obj_id+" .topic_title").width():$("#question_"+t.obj_id+" .title").width(),!0),a=f(a,r,!0);else if(2==i){if("phone"==e)r=$("#question_"+t.question_id+" .label_"+t.obj_id).width();else r=($("#question_"+t.question_id+" .label_"+t.obj_id).closest(".option_cell").css("max-width")||"").replace("px","");d=f(n,r,s),a=f(a,r,!0)}else d=f(n,0,!1);return[d,a]}function q(t,e,i,o){var n="",a=o?'<span class="Qnum">'+e+".</span>":"",s="on"==i?"":'<span class="asterisk">*</span>',_=$("<span>"+t+"</span>").contents(),l=_.length;if(0===l)n=a+s;else if(1===l)n=1===_[0].nodeType?$(_[0]).prepend(a).append(s)[0].outerHTML:a+t+s;else{var d=a+$(_[0])[0].textContent,r=$(_[l-1])[0].textContent+s;if(1===_[0].nodeType&&(d=$(_[0]).prepend(a)[0].outerHTML),1===_[l-1].nodeType&&(r=$(_[l-1]).append(s)[0].outerHTML),1===_[0].nodeType||1===_[l-1].nodeType)for(var c=1;c<l-1;c++)1===_[c].nodeType?n+=$(_[c])[0].outerHTML:n+=$(_[c])[0].textContent;n=d+n+r}return n}},function(t,e,i){"use strict";var o={singleSelectType:{question_type:QUESTION_TYPE_SINGLE,question_name:"single_select"},multipleSelectType:{question_type:QUESTION_TYPE_MULTIPLE,question_name:"multiple_select"},judgeType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"judge",question_name:"judge"},imageType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"image_single",question_name:"image_select"},imageVoteType:{question_type:QUESTION_TYPE_MULTIPLE,disp_type:"image_vote_single",question_name:"image_vote"},fontVoteType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"singlevote",question_name:"font_vote"},fontVoteMultipleType:{question_type:QUESTION_TYPE_MULTIPLE,disp_type:"multiplevote",question_name:"font_vote_multiple"},dropdownType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"dropdown",question_name:"dropdown"},cascaderType:{question_type:QUESTION_TYPE_BLANK_DROPDOWN,disp_type:"cascader",question_name:"cascader"},blankType:{question_type:QUESTION_TYPE_BLANK,question_name:"blank"},multipleBlankType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,question_name:"multiple_blank"},shortAnswerType:{question_type:QUESTION_TYPE_BLANK,disp_type:"short_answer",question_name:"short_answer"},scoreType:{question_type:QUESTION_TYPE_SCORE,disp_type:"score",question_name:"score"},matrixScaleType:{question_type:QUESTION_TYPE_SCORE,disp_type:"matrix_scale",question_name:"matrix_scale"},scaleType:{question_type:QUESTION_TYPE_SCORE,disp_type:"scale",question_name:"scale"},npsType:{question_type:QUESTION_TYPE_SCORE,disp_type:"nps_score",question_name:"nps"},proportionType:{question_type:QUESTION_TYPE_SCORE,disp_type:"proportion",question_name:"proportion"},sortType:{question_type:QUESTION_TYPE_ORDER,question_name:"sort"},remarkType:{question_type:QUESTION_TYPE_DESC,question_name:"remark"},splitPageType:{question_type:"page",question_name:"split_page"},splitLineType:{question_type:QUESTION_TYPE_DESC,disp_type:"split_line",question_name:"split_line"},nameType:{question_type:QUESTION_TYPE_BLANK,disp_type:"name",question_name:"name"},mobileType:{question_type:QUESTION_TYPE_BLANK,disp_type:"mobile",question_name:"mobile"},emailType:{question_type:QUESTION_TYPE_BLANK,disp_type:"email",question_name:"email"},sexType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"sex",question_name:"sex"},dateType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"date",question_name:"date"},timeType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"time",question_name:"time"},ageType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"age",question_name:"age"},educationType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"education",question_name:"education"},majorType:{question_type:QUESTION_TYPE_BLANK_DROPDOWN,disp_type:"major",question_name:"major"},universityType:{question_type:QUESTION_TYPE_BLANK_DROPDOWN,disp_type:"university",question_name:"university"},industryType:{question_type:QUESTION_TYPE_BLANK_DROPDOWN,disp_type:"industry",question_name:"industry"},occupationType:{question_type:QUESTION_TYPE_SINGLE,disp_type:"occupation",question_name:"occupation"},addressType:{question_type:QUESTION_TYPE_BLANK_DROPDOWN,disp_type:"address",question_name:"address"},geographyType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"geographical_multiple_blank",question_name:"geography"},uploadFileType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"upload_file",question_name:"upload"},matrixSelectType:{question_type:QUESTION_TYPE_MATRIX_SINGLE,question_name:"matrix_select"},matrixScoreType:{question_type:QUESTION_TYPE_MATRIX_SCORE,question_name:"matrix_score"},matrixBlankType:{question_type:QUESTION_TYPE_MATRIX_BLANK,question_name:"matrix_blank"},horizontalBlankType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"horz_blank",question_name:"horizontal_blank"},classificationType:{question_type:QUESTION_TYPE_CLASSIFICATION,question_name:"classification"},evaluationType:{question_type:QUESTION_TYPE_SCORE,disp_type:"evaluation",question_name:"evaluation"},clozeType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"cloze",question_name:"cloze"},bankedClozeType:{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"banked_cloze",question_name:"banked_cloze"}};e.a=o},,function(t,e,i){"use strict";i.d(e,"e",function(){return o}),i.d(e,"d",function(){return n}),i.d(e,"b",function(){return a}),i.d(e,"c",function(){return s}),i.d(e,"a",function(){return _});i(7);function o(t){return t.replace(/\s/g,"")}function n(t){return t.length>9999}var a={show:function(t,e){t.text()===e&&t.is(":visible")||(t.velocity("stop",!0),t.text(e).css({height:0,marginLeft:"50%",opacity:0,display:"block"}).velocity({height:"0.22rem"},{delay:200,duration:100,easing:[.17,.67,.83,.67]}).velocity({marginLeft:"-0.1rem",opacity:1},{duration:200,easing:[.17,.67,.83,.67]}).velocity({marginLeft:"0"},{duration:120,easing:[.17,.67,.83,.67]}))},hide:function(t){t.velocity("stop",!0),t.is(":visible")&&t.velocity({marginLeft:"-100%",opacity:0},{duration:300,easing:[.17,.67,.83,.67]}).velocity({height:0},{duration:100,easing:[.17,.67,.83,.67],complete:function(){t.text("").css({display:"none"})}})},hideAll:function(t){var e=$("#question_"+t),i=e.find("#tip_"+t);i.is(":visible")&&a.hide(i),e.find(".option_tip").each(function(){var t=$(this);t.is(":visible")&&a.hide(t)})}};function s(){return!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}function _(t,e){var i=$("#"+t),o=e.question_type,n=$("table tr:eq(0) td",i),a=$(".matrix",i).width(),s=n.length,_=.2*a,l=80/(s-1)/100*a;if(o===QUESTION_TYPE_MATRIX_SCORE){var d=parseInt(e.custom_attr.max_answer_num)-parseInt(e.custom_attr.min_answer_num),r=$(".score_td",i),c=32*d+(parseInt(r.css("paddingLeft"))+parseInt(r.css("paddingRight"))),p=c*s;p>a&&(a=p,_=l=c)}$(".matrix_table_wrap",i).width(a),n.each(function(t,e){0==t?$(this).attr("width",_+""):$(this).attr("width",l+"")})}},function(t,e,i){"use strict";i.d(e,"d",function(){return a}),i.d(e,"f",function(){return s}),i.d(e,"e",function(){return _}),i.d(e,"a",function(){return l}),i.d(e,"b",function(){return d}),i.d(e,"g",function(){return u}),i.d(e,"h",function(){return m}),i.d(e,"i",function(){return v}),i.d(e,"c",function(){return f});var o=i(2),n=i(6);function a(t,e){var i=parseInt(t),o=parseInt(e);if(isNaN(i)||isNaN(o)||i>=o)return[];var n=o-i,a=[];if(n<6){for(var s=i;s<=o;s++)a.push(s);return a}var _=Math.floor(n/5);a=[i,_,_,_,_,_];switch(n%5){case 1:a[3]=_+1;break;case 2:a[2]=a[4]=_+1;break;case 3:a[1]=a[3]=a[5]=_+1;break;case 4:a[1]=a[2]=a[4]=a[5]=_+1}for(s=1;s<6;s++)a[s]=a[s]+a[s-1];return a}function s(t){return t.question_type==o.a.proportionType.question_type&&t.custom_attr.disp_type==o.a.proportionType.disp_type}function _(t,e,i,o){var n=parseInt(o),a=parseInt(e),s=parseInt(i);return"ge"==t&&n>a||("le"==t&&n<a||("eq"==t&&n==a||"in"==t&&n>=a&&n<=s))}function l(t){var e=t.find(".option_item"),i=0;return e.each(function(t,e){var o=parseInt($(e).find(".selected_value input").val());isNaN(o)||(i+=o)}),i}function d(t,e){var i=t.attr("oid"),o=e.find(".option_item"),n=0;return o.each(function(t,e){if($(e).attr("oid")!=i){var o=parseInt($(e).find(".selected_value input").val());isNaN(o)||(n+=o)}}),n}function r(t,e,i){var o=p(e,i),n=t.parents(".q_proportion");t.find(".slider_handle").css("left",o),t.find(".selected_bar").css("width",o),t.find(".selected_value input").val(e),n.attr("data-changed","true"),n.find(".err_color").removeClass("err_color")}function c(t,e,i,o){var n=i.question,a=$("#question_"+i.qid),s=(parseInt(n.custom_attr.min_answer_num),parseInt(n.custom_attr.max_answer_num)),_=n.custom_attr.tick_data,d=parseInt(n.custom_attr.total_value),r=o.filter(function(){return $(this).attr("oid")!==t}),c=d-e>s?s:d-e,u=p(c,_);r.find(".slider_handle").css("left",u),r.find(".selected_bar").css("width",u),r.find(".selected_value input").val(c);var m=l(a);a.find(".selected_sum").text(m+"/"),r.find(".proportion_bar_primary").slider("option","value",100*c)}function p(t,e){for(var i=0,o=e.length,n=0;n<o-1;n++)if(t>=e[n]&&t<=e[n+1]){i=100*((t-e[n])/(e[n+1]-e[n])/(o-1)+n/(o-1));break}return i+"%"}function u(t,e,i){var o=$("#question_"+t.qid),n=o.find(".option_item"),a=e.attr("oid"),s=t.question,_=parseInt(s.custom_attr.min_answer_num),l=(parseInt(s.custom_attr.max_answer_num),s.custom_attr.tick_data),p=parseInt(s.custom_attr.total_value),u=s.custom_attr.limit_total,m=d(e,o);i<_||u&&m>p||!u&&m>1e3||(u?(i>p-m&&(i=2==n.length?i>p-_?p-_:i:p-m),r(e,i,l),2==n.length&&c(a,i,t,n)):(i>1e3-m&&(i=1e3-m),r(e,i,l)))}function m(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pc",a=$("#question_"+t.qid),s=t.question,_=a.find(".option_item"),l=s.custom_attr.limit_total,p=s.custom_attr.total_value,u=s.custom_attr.tick_data,m=d(e,a);r(e,i,u),l&&(2==_.length?c(e.attr("oid"),i,t,_):m+i<=p&&(m+i<p?_.each(function(){var t=$(this);t.find(".disabled_handle").removeClass("disabled_handle"),"mobile"==o&&"true"!==t.find(".selected_value input").attr("data-isFocus")&&t.find(".edit_icon").css("visibility","visible")}):v(t,o),l&&m+i<=p&&a.find(".selected_sum").text(m+i+"/"))),Object(n.a)(t.qid)}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pc",i=$("#question_"+t.qid),o=t.question,n=o.custom_attr.min_answer_num,a=o.custom_attr.total_value,s=l(i);i.find(".option_item").each(function(t,i){var o=$(i),_=parseInt(o.find(".selected_value input").val()),l=o.find(".proportion_bar");isNaN(_)||_!=n||(s==a?(l.addClass("disabled_handle"),o.find(".edit_icon").css("visibility","hidden")):(l.removeClass("disabled_handle"),"mobile"==e&&"true"!==o.find(".selected_value input").attr("data-isFocus")&&o.find(".edit_icon").css("visibility","visible")))})}function f(t,e){var i=$("#question_"+t.qid),o=t.question,n=parseInt(o.custom_attr.min_answer_num),a=parseInt(o.custom_attr.max_answer_num),s=parseInt(o.custom_attr.total_value),_=o.custom_attr.limit_total,l=i.find(".option_item"),r=(e.parents(".selected_value").find(".err_msg"),e.parents(".option_item")),c=parseInt(e.val()),p=d(r,i),u={isSuccess:!0,errMsg:""};return isNaN(c)?u={isSuccess:!1,errMsg:"鏁板€间笉寰椾负绌�"}:c<n?u={isSuccess:!1,errMsg:"鏁板€间笉寰楀皬浜庯紙{0}锛�".format([n])}:_&&2!=l.length&&p+c>s?u={isSuccess:!1,errMsg:"鏁板€间笉寰楀ぇ浜庯紙{0}锛�".format([s-p])}:_&&2==l.length&&c+n>s?u={isSuccess:!1,errMsg:"鏁板€间笉寰楀ぇ浜庯紙{0}锛�".format([s-n])}:c>a?u={isSuccess:!1,errMsg:"鏁板€间笉寰楀ぇ浜庯紙{0}锛�".format([a])}:!_&&p+c>1e3?u={isSuccess:!1,errMsg:"鍚勯」姣旈噸涔嬪拰涓嶅緱澶т簬1000锛岃閲嶆柊杈撳叆"}:c>1e3?u={isSuccess:!1,errMsg:"鏁板€间笉寰楀ぇ浜庯紙{0}锛�".format([1e3])}:u}},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var o=i(9),n=i(1),a=i(5);function s(t){var e=get_qmodel(t),i=e.get_getanswer_function()(e);if(isNotEmpty(i))return i;var o=i;return total_answers&&t in total_answers&&(i=total_answers[t],isNotEmpty(i)||(i=o)),i}function _(t){if(isNotEmpty(current_page_id)){var e=s(t);if(get_qmodel(t).question.question_type==QUESTION_TYPE_SCORE)var i=!p(e);else i=isNotEmpty(e);return i?function(t){s(t),get_qmodel(t);for(var e=JUMPCONSTRAINT_SOURCE_Q_DICT[t],i=[],o=0;o<e.length;o++){var a=e[o].condition,_=e[o].next_qid;if(u(a)){var l=Object(n.i)(current_page_id),d=l.question_id_list.indexOf(t);if(check_in(_,["1","2"]))i=i.concat(l.question_id_list.slice(d+1));else{var r=l.question_id_list.indexOf(_);i=i.concat(l.question_id_list.slice(d+1,r))}}}return i.unique()}(t):function(t){for(var e=JUMPCONSTRAINT_SOURCE_Q_DICT[t],i=[],o=Object(n.i)(current_page_id),a=o.question_id_list.indexOf(t),s=0;s<e.length;s++){var _=e[s];if(check_in(_.next_qid,["1","2"]))i="1"==$("#question_"+t).attr("hidebylogic")?[]:i.concat(o.question_id_list.slice(a+1));else{var l=o.question_id_list.indexOf(_.next_qid);i=-1==l?i.concat(o.question_id_list.slice(a+1)):i.concat(o.question_id_list.slice(a+1,l))}}return i.unique()}(t)}return[]}function l(t){var e=s(t),i=get_qmodel(t);if(t in JUMPCONSTRAINT_SOURCE_Q_DICT){var o=JUMPCONSTRAINT_SOURCE_Q_DICT[t];if(i.question.question_type==QUESTION_TYPE_SCORE)var a=!p(e);else a=isNotEmpty(e);if(!a){var _=0,l=Object(n.i)(current_page_id);for(r=0;r<o.length;r++){var d=o[r].next_qid;if(check_in(d,["1","2"]))return d;if(-1==l.question_id_list.indexOf(d))return d;l.question_id_list.indexOf(d)>=_&&(_=l.question_id_list.indexOf(d))}return l.question_id_list[_]}for(var r=0;r<o.length;r++){if(u(o[r].condition))return o[r].next_qid}}var c=(l=Object(n.i)(current_page_id)).question_id_list.indexOf(t);if(c!==l.question_id_list.length-1)return l.question_id_list[c+1]}function d(t){get_qmodel(t);if(t in JUMPCONSTRAINT_SOURCE_Q_DICT){for(var e=JUMPCONSTRAINT_SOURCE_Q_DICT[t],i=0,o=Object(n.i)(current_page_id),a=0;a<e.length;a++){var s=e[a].next_qid;if(check_in(s,["1","2"]))return s;if(-1==o.question_id_list.indexOf(s))return s;o.question_id_list.indexOf(s)>=i&&(i=o.question_id_list.indexOf(s))}return o.question_id_list[i]}var _=(o=Object(n.i)(current_page_id)).question_id_list.indexOf(t);if(_!==o.question_id_list.length-1)return o.question_id_list[_+1]}function r(t){var e=get_qmodel(t),i=s(t),o=null;if(e.question.question_type==QUESTION_TYPE_SCORE)var a=!p(i);else a=isNotEmpty(i);var u=Object(n.i)(current_page_id),m=u.question_id_list.indexOf(t),h=l(t);if(isNotEmpty(h)){var q=[];if(check_in(h,["1","2"]))q=q.concat(u.question_id_list.slice(m+1)),h=t,o=m;else if(Object(n.h)(h).questionpage_id!==current_page_id){q=q.concat(u.question_id_list.slice(m+1)),o=u.question_id_list.length-1;for(var g=0;g<q.length;g++){v(x=q[g])}}else{if(o=u.question_id_list.indexOf(h),q=q.concat(u.question_id_list.slice(m+1,o)),!a&&check_in(e.question.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_SCORE]))for(g=0;g<q.length;g++){if((x=q[g])in JUMPCONSTRAINT_SOURCE_Q_DICT){var w=d(x);page.question_id_list.indexOf(w)>=page.question_id_list.indexOf(h)?(h=w,o=u.question_id_list.indexOf(h)):check_in(w,["1","2"])&&(q=u.question_id_list.slice(m+1),h=t,o=m)}}var b=u.question_id_list.slice(o);for(g=0;g<b.length;g++){(x=b[g])in JUMPCONSTRAINT_SOURCE_Q_DICT&&c(x)&&(q=q.concat(_(x)))}}q=q.unique();var y=[];for(g=0;g<u.question_id_list.length;g++)if(!(g<m)){var x=u.question_id_list[g];e=get_qmodel(x);check_in(x,q)?(v(x),q.push(x)):x in DISPLAYCONSTRAINT_SOURCE_Q_DICT?c(x)?(f(x),y.push(e)):(v(x),q.push(x)):"none"!==$("#question_"+x).css("display")||"need_permission"in e.question.custom_attr||(f(x),y.push(e))}if((!h||!(h in JUMPCONSTRAINT_SOURCE_Q_DICT))&&y.length)for(g=0;g<y.length;g++){var T=y[g];T.qid in JUMPCONSTRAINT_SOURCE_Q_DICT&&(h=T.qid)}24==h.length&&h!==t&&check_in(h,u.question_id_list)&&h in JUMPCONSTRAINT_SOURCE_Q_DICT&&!check_in(h,q)&&r(h)}}function c(t){var e=get_qmodel(t);if(!(t in DISPLAYCONSTRAINT_SOURCE_Q_DICT))return!0;for(var i=DISPLAYCONSTRAINT_SOURCE_Q_DICT[t],o=0;o<i.length;o++){var n=i[o].condition;if(e.question.custom_attr.condition_relation==CONDITION_RELATION_AND&&!u(n))return!1;if(e.question.custom_attr.condition_relation==CONDITION_RELATION_OR&&u(n))return!0}return e.question.custom_attr.condition_relation==CONDITION_RELATION_AND}function p(t){for(var e=Object.keys(t),i=0;i<e.length;i++){var o=t[e[i]][0];if("string"==typeof o&&""!=o||"number"==typeof o&&-1!==o)return!1}return!0}function u(t){for(var e=0;e<t.condition_item_list.length;e++){var i=t.condition_item_list[e];if(t.logic_relation==CONDITION_RELATION_AND&&!m(i))return!1;if(t.logic_relation==CONDITION_RELATION_OR&&m(i))return!0}return t.logic_relation==CONDITION_RELATION_AND}function m(t){var e=get_qmodel(t.question_id),i=s(e.qid);if(e.question.question_type==QUESTION_TYPE_SCORE)var o=!p(i);else o=isNotEmpty(i);if(t.operation_type==CONDITION_OPERATION_TYPE_SELECTED){if(-1!=[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE,QUESTION_TYPE_BLANK,QUESTION_TYPE_MATRIX_SCORE,QUESTION_TYPE_BLANK_DROPDOWN,QUESTION_TYPE_ORDER,QUESTION_TYPE_DESC,QUESTION_TYPE_MULTIPLE_BLANK,QUESTION_TYPE_MATRIX_BLANK].indexOf(e.question.question_type))return-1==hide_qid_list_by_logic.indexOf(e.qid);if(!o)return!1;if(e.question.question_type==QUESTION_TYPE_SINGLE){if(-1!=hide_qid_list_by_logic.indexOf(e.qid)&&$("#question_"+e.qid).attr("hideByLogic"))return!1;if("any"==t.option_id)return!0;if(check_in(t.option_id,i))return!0}else if(e.question.question_type==QUESTION_TYPE_MULTIPLE){if(-1!=hide_qid_list_by_logic.indexOf(e.qid)&&$("#question_"+e.qid).attr("hideByLogic"))return!1;if("any"==t.option_id)return!0;for(var n=i.map(function(t){return t[0]}),_=t.option_id.split(","),l=!0,d=0;d<_.length;d++)-1==n.indexOf(_[d])&&(l=!1);if(l)return!0}else if(e.question.question_type==QUESTION_TYPE_SCORE)if(Object(a.f)(e.question)){var r=t.disp_type,c=t.score_range.start_score,u=t.score_range.end_score;if("any"!=t.option_id){v=i[t.option_id]?i[t.option_id][0]:null;return Object(a.e)(r,c,u,v)}for(_=Object.keys(i),d=0;d<_.length;d++){if(v=i[_[d]])return Object(a.e)(r,c,u,v)}}else{if("any"==t.option_id)for(_=Object.keys(i),d=0;d<_.length;d++){if(v=i[_[d]]){if(t.score_range.start_score&&"any"==t.score_range.start_score)return!0;if(parseInt(v)<=parseInt(t.score_range.end_score)&&parseInt(v)>=parseInt(t.score_range.start_score))return!0}}else if(v=i[t.option_id]?i[t.option_id][0]:null){if(t.score_range.start_score&&"any"==t.score_range.start_score)return!0;if(parseInt(v)<=parseInt(t.score_range.end_score)&&parseInt(v)>=parseInt(t.score_range.start_score))return!0}}}else if(t.operation_type==CONDITION_OPERATION_TYPE_UNSELECTED){if(!o)return!1;if(e.question.question_type==QUESTION_TYPE_SINGLE){if("any"==t.option_id&&1!=e.option_list.length)return!0;if("any"!=t.option_id&&!check_in(t.option_id,i))return!0}else if(e.question.question_type==QUESTION_TYPE_MULTIPLE){n=i.map(function(t){return t[0]}),_=t.option_id.split(",");if("any"==t.option_id&&n!=e.option_list.length)return!0;var m=!0;for(d=0;d<_.length;d++)-1!=n.indexOf(_[d])&&(m=!1);if(m)return!0}else if(e.question.question_type==QUESTION_TYPE_SCORE){if("any"==t.option_id)for(_=Object.keys(i),d=0;d<_.length;d++){var v;if(v=i[_[d]]){if(t.score_range.start_score&&"any"==t.score_range.start_score)return!1;if(parseInt(v)<=parseInt(t.score_range.end_score)&&parseInt(v)>=parseInt(t.score_range.start_score))return!1}}else if(v=i[t.option_id]?i[t.option_id][0]:null){if(t.score_range.start_score&&"any"==t.score_range.start_score)return!1;if(parseInt(v)<=parseInt(t.score_range.end_score)&&parseInt(v)>=parseInt(t.score_range.start_score))return!1}return!0}}else if(t.operation_type==CONDITION_OPERATION_TYPE_DISPLAYED){if(-1==hide_qid_list_by_logic.indexOf(e.qid))return!0}else if(t.operation_type==CONDITION_OPERATION_TYPE_NOTDISPLAYED&&-1!=hide_qid_list_by_logic.indexOf(e.qid))return!0;return!1}function v(t){$("#question_"+t).attr("hideByLogic")||($("#question_"+t).attr("hideByLogic","1").hide(),-1==hide_qid_list_by_logic.indexOf(t)&&hide_qid_list_by_logic.push(t))}function f(t){$("#question_"+t).attr("hideByLogic")&&($.browser&&!0===$.browser.msie&&"7.0"===$.browser.version?($("#question_"+t).attr("hideByLogic",null).show(),Object(n.h)(t).question_type==QUESTION_TYPE_ORDER&&Object(o.c)("question_"+t)):$("#question_"+t).attr("hideByLogic",null).hide().slideDown("slow",function(){Object(n.h)(t).question_type==QUESTION_TYPE_ORDER&&Object(o.c)("question_"+t)}));-1!=hide_qid_list_by_logic.indexOf(t)&&hide_qid_list_by_logic.splice(hide_qid_list_by_logic.indexOf(t),1)}},function(t,e,i){var o;function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t}).apply(this,arguments)}!function(s,_){function l(t,e,i){this.uri_="//"+e+"."+t+"/logstores/"+i+"/track?APIVersion=0.6.0",this.params_=new Array(0),this.httpRequest_=s.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):s.XMLHttpRequest?new XMLHttpRequest:void 0}l.prototype={push:function(t,e){t&&e&&(this.params_.push(t),this.params_.push(e))},logger:function(){for(var t=this.uri_,e=0;this.params_.length>0;)t+=e%2==0?"&"+encodeURIComponent(this.params_.shift()):"="+encodeURIComponent(this.params_.shift()),++e;try{this.httpRequest_.open("GET",t,!0),this.httpRequest_.send(null)}catch(e){s&&s.console&&"function"==typeof s.console.log&&(console.log("Failed to log to ali log service because of this exception:\n"+e),console.log("Failed log data:",t))}}};var d=new l("cn-hangzhou.log.aliyuncs.com","wenjuan","memberaction");var r=new function(){this.push=function(t,e){if(d.push("__topic__",t),e=a(e,this.appendExtraData()))for(var i in e){var o=e[i];null!=o&&d.push(i,o.toString())}d.logger()},this.appendExtraData=function(){return a(this.getExtraCookieData(),{pageurl:s.location.href,ds:(s.screen.width||0)+"x"+(s.screen.height||0),vl:this.scrollTop()+this.clientHeight(),su:_.referrer})},this.getExtraCookieData=function(){var t={};return["hawkeye_mid","browser_id"].map(function(e){t[e]=s.getCookie(e)}),t},this.scrollTop=function(){var t;return t=t||_,parseInt(s.pageYOffset||t.documentElement.scrollTop||t.body&&t.body.scrollTop||0,10)},this.clientHeight=function(){var t=_;return parseInt(s.innerHeight||t.documentElement.clientHeight||t.body&&t.body.clientHeight||0,10)}};"object"===n(i(18))&&i(18)?void 0===(o=function(){return r}.call(e,i,e,t))||(t.exports=o):s._aliLog=r()}(window,document)},,function(t,e,i){"use strict";function o(t){var e=[];if($("#"+t+" .Sorting li").sortable({connectWith:"#"+t+" .pxlist tr td",receive:function(e,i){$("#"+t+" .Sorting li label").attr("site","").removeClass("pt_on")},stop:function(e,i){$("#"+t+" .pxlist tr td").each(function(e,i){var o=e+1;if($(this).find("label").length>1){var n=$(this).find(".pt_on"),a=n.attr("name")-1;$("#"+t+" .Sorting li:eq("+a+")").append(n)}$(this).find("label").attr("site",o).addClass("pt_on")}),$("#"+t+" .Sorting li label").attr("site","").removeClass("pt_on"),console.log("Sorting stop"),get_qmodel(t.replace("question_","")).changeAnswerHandler()}}).disableSelection(),$("#"+t+" .pxlist tr td").sortable({connectWith:"#"+t+" .pxlist tr td",over:function(t,e){e.placeholder.parent().addClass("jda")},out:function(t,e){e.placeholder.parent().removeClass("jda")},start:function(t,e){e.item.removeClass("pt_on")},update:function(e,i){$("#"+t+" .pxlist tr td").removeClass("jda")},beforeStop:function(e,i){var o=i.placeholder.parent(),n=i.item.attr("site")-1,a=o.find(".pt_on");o.find("label").length>2&&$("#"+t+" .pxlist tr td:eq("+n+")").append(a);var s=o.attr("name");i.item.attr("site",s)},stop:function(e,i){$("#"+t+" .pxlist tr td").each(function(e,i){var o=e+1;if($(this).find("label").length>1){var n=$(this).find(".pt_on"),a=n.attr("name")-1;$("#"+t+" .Sorting li:eq("+a+")").append(n)}$(this).find("label").attr("site",o).addClass("pt_on")}),$("#"+t+" .Sorting li label").attr("site","").removeClass("pt_on"),console.log("pxlist stop"),get_qmodel(t.replace("question_","")).changeAnswerHandler()}}).disableSelection(),"none"!=$("#"+t).css("display")){$("#"+t+" .Sorting label").each(function(t,i){var o=$(this).height();o<23&&(o=23),e.push(o)}),e.sort(n),$("#"+t+" .Sorting label").height(e[0]),$("#"+t+" .Sorting li,.pxlist tr td").height(e[0]+2);e.length,e[0]}}function n(t,e){return t>e?-1:t<e?1:0}function a(t){var e="question_"+t.qid,i=$("#"+e),o=$("#tip_"+t.qid),n=!0;return i.find(".pxlist tr td").each(function(){0!=$(this).find("label").length||"allow_null"in t.question.custom_attr||(n=!1)}),n?o.text(""):(o.text("璇峰鎵€鏈夐€夐」杩涜鎺掑簭"),scroll_to(i)),n}function s(t){for(var e="question_"+t.qid,i={},o=$("#"+e).find(".pxlist tr"),n=0;n<o.length;n++){var a=o[n],s=$(a).find(".pxla");if(s.length>0)i[$(s).attr("id")]=[n+1]}return i}function _(t){setTimeout(function(){o("question_"+t.qid)},1e3)}i.d(e,"c",function(){return o}),i.d(e,"d",function(){return a}),i.d(e,"b",function(){return s}),i.d(e,"a",function(){return _})},function(t,e,i){"use strict";for(var o=[],n=[],a=("undefined"!=typeof Uint8Array?Uint8Array:Array,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),s=0,_=a.length;s<_;++s)o[s]=a[s],n[a.charCodeAt(s)]=s;function l(t,e,i){for(var n,a,s=[],_=e;_<i;_+=3)n=(t[_]<<16&16711680)+(t[_+1]<<8&65280)+(255&t[_+2]),s.push(o[(a=n)>>18&63]+o[a>>12&63]+o[a>>6&63]+o[63&a]);return s.join("")}function d(t){for(var e,i=t.length,n=i%3,a=[],s=0,_=i-n;s<_;s+=16383)a.push(l(t,s,s+16383>_?_:s+16383));return 1===n?(e=t[i-1],a.push(o[e>>2]+o[e<<4&63]+"==")):2===n&&(e=(t[i-2]<<8)+t[i-1],a.push(o[e>>10]+o[e>>4&63]+o[e<<2&63]+"=")),a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63,window.wj_ad_keywords="",window.wj_ad_token="",window.wj_ad_pinfo="",window.wj_ad_rinfo="";var r=function(){function t(t,e){for(var i=0;i<t.length;i++)if(t[i]==e)return 1;return 0}function e(t){return t._id.$oid}function i(t){return strip_tags(t)}function o(t){for(var i=t.questionpage_list.length,o=new Array,n=0;n<i;n++)o=o.concat(t.questionpage_list[n].question_list);var a=new Array,s=o.length;for(n=0;n<s;n++){for(var _=o[n],l=e(_),d=new Array,r=_.option_list,c=0;c<r.length;c++){var p=r[c];d[e(p)]=p}_.option_dict=d,a[l]=_}return a}function n(t){for(var o=t.questionpage_list.length,n=new Array,a=0;a<o;a++)n=n.concat(t.questionpage_list[a].question_list);var s=new Array,_=n.length;for(a=0;a<_;a++){for(var l=n[a],d=e(l),r=i(l.title),c=l.question_type,p=new Array,u=l.option_list.length,m=0;m<u;m++){var v=l.option_list[m],f={option_id:e(v),title:i(v.title)};p.push(f)}var h={question_id:d,question_type:c,title:r,option_list:p};s.push(h)}return{project_id:e(t),title:i(t.title),begin_desc:i(t.begin_desc),end_desc:i(t.end_desc),question_list:s}}function a(e,i){var o=[2,3,4,5,6,8,95,100],n=new Array;for(var a in i){var s=e[a],_=i[a],l=s.question_type;if(t(o,l)){var d=(0,c.parse_answer_func_dict[l])(s,_);n.push({question_id:a,question_type:l,data:d})}}return n}function s(t,i,s,_,l,d,r){return{ua:l,remote_ip:d,zip_type:"gzip",token:_,mtc:s,p_info:n(t),r_info:{mtc:s,project_id:e(t),answers:a(o(t),i)},open_id:r}}function _(t){l(JSON.stringify(t.p_info)),l(JSON.stringify(t.r_info)),t.p_info=d(pako.gzip(JSON.stringify(t.p_info))),t.r_info=d(pako.gzip(JSON.stringify(t.r_info))),l(t.p_info),l(t.r_info),t.mtc=window.getCookie("mtc"),window.wj_ad_keywords="",window.wj_ad_token=t.token,window.wj_ad_pinfo=t.p_info,window.wj_ad_rinfo=t.r_info,$.ajax({type:"POST",url:"https://api.wenjuan.link/dmp/0.0.1/user/get_keyword",data:t,dataType:"json",timeout:3e3,success:function(t){l("success"+t.keyword),window.wj_ad_keywords=t.keyword},error:function(t){l("fail"+t.keyword),window.wj_ad_keywords=""}})}function l(t){window.debugFlag&&("string"==typeof t?console.log("------"+t+"------"):console.log(t))}return{is_in_array:t,parse_oid:e,parse_text:i,parse_project_questions:o,parse_project:n,parse_respondent:a,parse_request_data:s,send_request:_,get_ad_keywords:function(t,e,i,o,n,a,l){_(s(t,e,i,o,n,a,l=l||""))},get_keyword_data:function(t,e,i,o,n,a,_){var l=s(t,e,i,o,n,a,_=_||"");return l.mtc=window.getCookie("mtc"),l=d(pako.gzip(JSON.stringify(l)))}}}(),c=function(){function t(t){return strip_tags(t)}function e(e,i,o){var n=i.option_dict[e],a=t(n?n.title:"");return o.length>1&&(a=a+","+o[1]),a}function i(t,i){return e(i[0],t,i)}function o(t,i){for(var o=new Array,n=0;n<i.length;n++){var a=e(i[n][0],t,i[n]);o.push(a)}return o}function n(t,e){var i="";for(var o in e)i+=e[o];return i}function a(t,e){var i=new Array;for(var o in e)i.push(e[o]);return i}function s(t,e){return a(0,e)}function _(t,i){var o=new Array;for(var n in i){var a=e(i[n][0],t,i[n]);o.push(a)}return o}function l(t,i){var o=new Array;for(var n in i){for(var a=new Array,s=0;s<i[n].length;s++){var _=e(i[n][s][0],t,i[n][s]);a.push(_)}o.push(a)}return o}function d(t,e){var i=new Array;for(var o in e){var n="";for(var a in e[o])n=n+","+e[o][a];i.push(n)}return i}return{parse_answer_func_dict:{2:i,3:o,4:_,5:l,6:n,8:s,95:a,100:d},parse_text:t,single_option:e,single:i,multiple:o,blank:n,multiple_blank:a,blank_dropdown:s,matrix_single:_,matrix_multiple:l,matrix_blank:d}}();function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){document.URL.match("fromMiniApp")||(window.globalData&&"feishu_mini_app"===window.globalData.createClient&&document.URL.match("fs=1")?$(".end_create_btn").remove():h(t.position)||"form"===globalData.sceneType||100*Math.random()<50?function(t){var e={rid:t.rid||"",adc_time:t.adc_time||"",adc_sign:t.adc_sign||"",member_type:t.memberType||2};$.extend(e,t);var i="https://dc.wenjuan.com/api",o=-1!==window.site_rspd_url.indexOf("wenjuan.in")?"in":"net",n=q(),a=f(e.position,e.sceneType),s={rid:e.rid,short_id:n,channel:"wenjuan",source:o,adc_time:e.adc_time,adc_sign:e.adc_sign,member_type:e.member_type,mtc:window.getCookie("mtc")||"",_wj_ad_position:e.position,site_seq:a};"undefined"!=typeof total_answers&&(s.res_data=JSON.stringify(r.get_keyword_data(project,total_answers,ad_mtc,ad_token,ad_ua,ad_remote_ip,"")));m(e.position)&&window.super_account&&(s._user_type=1===Number(window.super_account)?"senior":"normal",window._hmt.push(["_trackEvent","/s/","show","luck_ad_"+s._user_type+"_"+window.globalData.sceneType]));var _=i+"/display/",l="",d=null;null!=(d=/\?adc_project_id=(\w+)($|&)/.exec(location.search))&&(l=d[1],_+="&project_id="+l);$.ajax({url:_,type:"POST",data:s,success:function(t){var o=t.data,n={position:e.position,prize_ad_name:o.identify,rid:e.rid,apiUrl:i,adHtml:o.ad,id:o.id,landingPage:o.landing_page,postId:o.post_id,siteSeq:o.siteSeq,statsLog:o.stats_log};window.project&&window.project.link_dc?window._hmt.push(["_trackPageview","/s/luck_draw_dc_"+n.prize_ad_name+"_linkdc"]):window._hmt.push(["_trackPageview","/s/luck_draw_dc_"+n.prize_ad_name]);var a=$("#wj_luck_draw");a.html(n.adHtml).show()}})}($.extend({},window.globalData,t)):function(t){var e=t.invalideAnswer;"invalid_answer_ip"!==t.position&&"invalid_answer_region"!==t.position||(e=3);var i={selector:"#wj_luck_draw",short_id:"object"===("undefined"==typeof project?"undefined":p(project))?window.project.short_id:"",platform:"",position:"",invalideAnswer:e};$.extend(i,t);try{var o=$("body").attr("btn_style"),n=function(t,e){var i={survey:109,vote_scene:184,form:186,assess:188,satis:213,default:1},o={survey:180,vote_scene:185,form:187,assess:189,satis:214,default:108};-1===["check_points_fail","answer_finish_filter"].indexOf(t)&&0!==t.indexOf("answer_filter_")&&0!==t.indexOf("answer_finish_")||(t="answer_finish");var n={project_bottom_close:87,not_draw_envelope:88,answer_finish:i[e]||i.default,default:o[e]||o.default},a=n[t]||n.default;return console.log("getCByPositionAndScene",t,e,a),a}(i.position,t.sceneType),a={z:"wenjuan",c:n,op:1,_sp:3,_site:1,_wj_ad_position:i.position,_end_create_btn:o,_ad:o,_title:encodeURI(document.title),_wj_short_id:i.short_id,_keywords:window.wj_ad_keywords||"",_browser_id:window.getCookie("browser_id")};i.invalideAnswer&&(a._invalide_answer=i.invalideAnswer),m(i.position)&&window.super_account&&(a._user_type=1===Number(window.super_account)?"senior":"normal",window._hmt.push(["_trackEvent","/s/","show","luck_ad_"+a._user_type+"_"+window.globalData.sceneType]));var s="https://d1.wenjuan.link/s?"+g(a),_=$(i.selector),l={pc:{width:"800",height:"425",margin:"0 -106px"},mobile:{width:$(window).width()-20,height:"400",margin:"0 -10px"}};!function(t,e){window._hmt&&window._hmt.push(["_trackPageview","/s/record_ad_data_statistics"]),window._hawkeye&&window._hawkeye.push(["buttonclick","/s/record_ad_data_statistics"]);var i="browser_id="+window.getCookie("browser_id")+"&shord_id="+t+"&ad_position="+e,o=new XMLHttpRequest;o.open("get","https://hawkeye.wenjuan.com/adlog?"+i,!0),o.send(null)}(i.short_id,i.position),_.html('<iframe id="wj_luck_draw_iframe" src="'+s+'" frameborder="0" scrolling="no" width="'+l[i.platform].width+'" height="'+l[i.platform].height+'" style="margin:'+l[i.platform].margin+';"></iframe>').show()}catch(t){console.log("luck_draw_ad",t)}}(t))}function m(t){var e=!1;return["answer_finish_","answer_filter_","not_draw_envelope","check_points_fail"].forEach(function(i){-1===t.indexOf(i)||(e=!0)}),e}function v(t,e,i){window.getCookie("mtc")||$.ajax({url:e.server,type:"GET",async:!i,data:{mid:e.mid,project_id:t,token:e.token},dataType:"JSON",success:function(t){var e=t.data.mtc,i=new Date,o=new Date(i.setFullYear(i.getFullYear()+10));window.setCookie("mtc",e,o)}})}function f(t,e){var i={survey:1,form:2,assess:3,vote_scene:4,satis:5,default:8},o=window.isSaveTotalAnswerRemoveTimeout?10:h(t)||i[e]||i.default;return console.log("getDCSiteSeqByPositionAndScene",t,e,o),o}function h(t){return{project_finished:6,project_paused:6,project_delete:6,project_limit_word:6,time_not_start:6,project_not_exist:6,answer_repeat:7,answer_repeat_ip:7,project_email_answer_only:7,invalid_answer_ip:7,invalid_answer_region:7,survey_link_invalid:7,form_link_invalid:7,assess_link_invalid:7,link_invalid:7,survey_has_update:7,form_has_update:7,assess_has_update:7,answer_repeat_exceeded_limit:7,answer_repeat_ip_exceeded_limit:7}[t]}function q(){var t=/^\/s\/([a-zA-Z0-9]+)\/?/,e=document.location.pathname;return t.test(e)?e.match(t)[1]:""}function g(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")}i.d(e,"a",function(){return u}),i.d(e,"b",function(){return v}),function(t){var e=[0,1,2,5,8,7,6,3],i={init:function(e){this.options={width:3,height:3,initSpeed:300,speed:0,upStep:60,upMax:60,downStep:50,downMax:300,waiting:1e3,index:7,target:5},this.options=t.extend(!0,this.options,e),this.options.speed=this.options.initSpeed,this.elements=this.find("td"),this.count=this.elements.length-1,i.enable.call(this)},roll:function(){var t=this;this.elements[e[this.options.index]].className="",this.options.index=++this.options.index%this.count,this.elements[e[this.options.index]].className="active",this.rollerTimer=setTimeout(function(){i.roll.call(t)},this.options.speed),this.isRunning||(i.up.call(t),this.isRunning=!0)},up:function(){var t=this;this.options.speed<=this.options.upMax?i.constant.call(this):(this.options.speed-=this.options.upStep,this.upTimer=setTimeout(function(){i.up.call(t)},this.options.speed))},constant:function(){var t=this;clearTimeout(this.upTimer),setTimeout(function(){i.down.call(t)},this.options.waiting)},down:function(){var t=this;this.options.speed>this.options.downMax&&this.options.target==this.options.index?i.stop.call(t):(this.options.speed+=this.options.downStep,this.downTimer=setTimeout(function(){i.down.call(t)},this.options.speed))},stop:function(){clearTimeout(this.downTimer),clearTimeout(this.rollerTimer),this.options.speed=this.options.initSpeed,this.isRunning=!1,o.afterStop.call(this)},enable:function(){var e=this;e.find("#_W-draw-bd").one("click",function(){t(this).css({background:"#A9A9A9"}),o.beforeRoll.call(e)}),e.find("a.close").one("click",function(){e.find("#_W-l-r").css({display:"none"})})}},o={beforeRoll:function(){this.options.beforeRoll&&this.options.beforeRoll.call(this),i.roll.call(this)},beforeDown:function(){o.aim.call(this),this.options.beforeDown&&this.options.beforeDown.call(this),i.down.call(this)},afterStop:function(){var t=this.elements[e[this.options.index]];this.options.afterStop&&!this.options.afterStop.call(this,t)||i.enable.call(this)},aim:function(){this.options.aim?this.options.target=this.options.aim.call(this):this.options.target=parseInt(parseInt(10*Math.random())*this.count/10)}};t.fn.lottery=function(t){i.init.call(this,t)}}(jQuery),window.luck_draw_flow_distribution=u,window.show_luck_draw_ad=function(){_hmt.push(["_trackEvent","/s/","click","luck_ad_postmessage"]),$("#wj_luck_draw").show(),document.getElementById("wj_luck_draw_iframe").contentWindow.postMessage('{"event_type":"display"}',"https://d1.wenjuan.link")}},function(t,e,i){"use strict";function o(t){for(var e=0,i=[],o=0;o<t.length;o++){for(var n=[],a=t[o].length,s=0;s<a;s++)n.push({content:t[o][s],optionIndex:s<a-1?e++:null});i.push(n)}return i}i.d(e,"a",function(){return o}),i.d(e,"c",function(){return a}),i.d(e,"b",function(){return s});var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function a(t){var e="",i=parseInt(t/26);return i>0&&(e+=a(i-1)),e+=n[t%26]}function s(t){t.forEach(function(t,e){t.order=a(e)+"."})}},function(t,e,i){"use strict";var o=i(2),n={singleSelectType:{question_type:o.a.singleSelectType.question_type,option_show_video:"show"},multipleSelectType:{question_type:o.a.multipleSelectType.question_type,option_show_video:"show"},fontVoteType:{question_type:o.a.fontVoteType.question_type,disp_type:o.a.fontVoteType.disp_type,option_show_video:"show"},fontVoteMultipleType:{question_type:o.a.fontVoteMultipleType.question_type,disp_type:o.a.fontVoteMultipleType.disp_type,option_show_video:"show"},sexType:{question_type:o.a.sexType.question_type,disp_type:o.a.sexType.disp_type,option_show_video:"show"}};e.a=n},function(t,e,i){"use strict";i.d(e,"a",function(){return s}),$.ajaxSetup({cache:!1});var o={hideWelcome:$("#begin_content"),hideProgressBar:$(".wjprogress_new")},n={hideTitle:$(".wjtitle.project_title"),hideWelcome:$(".wjintro.desc_begin"),hideProgressBar:$(".wjprogress")};function a(t,e){if(t){var i=t.color_rgb();return i instanceof Array==1?"rgba("+i.join(",")+","+e+")":i}}function s(t){for(var e=project.appearSetting,i=0;i<t.length;i++)e&&(e=e[t[i]]);return e}function _(t){t.preventDefault()}function l(){document.body.addEventListener("touchmove",_,!1),$("body").css({position:"fixed",width:"100%"})}function d(){document.body.removeEventListener("touchmove",_,!1),$("body").css({position:"initial"})}String.prototype.color_rgb=function(){var t=this.toLowerCase();if(t&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t)){if(4===t.length){for(var e="#",i=1;i<4;i+=1)e+=t.slice(i,i+1).concat(t.slice(i,i+1));t=e}var o=[];for(i=1;i<7;i+=2)o.push(parseInt("0x"+t.slice(i,i+2)));return o}return t},window.render_appearset_template=function(t,e,i,s,_,l){t.porject_title=_;var r,c,p,u,m,v,f,h="",q="",g="",w="",b="",y="";if(!t.headerImgUrl&&(!t.cover||t.cover&&("color"!=t.cover.coverSetting&&!t.cover.coverImgUrl||"color"==t.cover.coverSetting&&!t.cover.coverColor))&&t.logo&&""!=t.logo.logoUrl&&(b=document.getElementById("appearance_logo_template").innerHTML,y=juicer(b,t)),t.headerImgUrl&&""!=t.headerImgUrl&&(h=document.getElementById("appearance_header_template").innerHTML,q=juicer(h,t)),t.cover&&(t.cover.coverImgUrl&&"color"!=t.cover.coverSetting||t.cover.coverColor&&"color"==t.cover.coverSetting)?(g=document.getElementById("appearance_cover").innerHTML,w=juicer(g,t),$("body").removeClass("hide_cover")):$("body").addClass("hide_cover"),"Phone"==s){"None"!=project_checkpoints&&project_checkpoints||($("#appearset_header").html(q),$("#appearset_cover").html(w),$("#appearset_logo").html(y),!t.cover||t.cover&&"begin_btn"!=t.cover.beginBtnStyle?$(".cover_div, .cover_img").click(function(){$(".phone_content_wrap").show(),window.scrollTo(0,$(".cover_img").height())}):t.cover&&(t.cover.coverImgUrl&&"color"!=t.cover.coverSetting||t.cover.coverColor&&"color"==t.cover.coverSetting)&&$(".cover_btn").click(function(){$(".phone_content_wrap").show(),d(),$("body").addClass("hide_appearset_cover"),$("#appearset_cover").hide(),window.parent.switching_arrow&&window.parent.switching_arrow(t,!0)})),c=(r=t).background&&(r.background.bgOpacity||0==r.background.bgOpacity)?r.background.bgOpacity:1,p=a(r.style.btnsColor,.2),u=a("#fff",c),m={data:r,sRgbColor:p,wjbColor:u},v=document.getElementById("mobile_btncolor_template").innerHTML,f=juicer(v,m),$("#appearset_style").remove(),$("body").append('<style id="appearset_style">'+f+"</style>");var x={hideTitle:$(".wj_title")};for(var T in o=$.extend(o,x))t.hidden&&1==t.hidden[T]?o[T].addClass("hide"):o[T].removeClass("hide");!function(t){t.cover&&(t.cover.coverImgUrl||t.cover.coverColor)&&(1==t.cover.titleShowOnCover&&t.hidden&&1==t.hidden.hideWelcome||1!=t.cover.titleShowOnCover&&t.hidden&&1==t.hidden.hideWelcome&&1==t.hidden.hideTitle)||!t.cover||t.cover&&!t.cover.coverImgUrl&&!t.cover.coverColor&&t.hidden&&1==t.hidden.hideWelcome&&1==t.hidden.hideTitle?$(".survey_cover_text").addClass("hide_padding").removeClass("hide_desc_begin"):t.cover&&(t.cover.coverImgUrl||t.cover.coverColor)&&(1==t.cover.titleShowOnCover||1!=t.cover.titleShowOnCover&&t.hidden&&1==t.hidden.hideTitle)||(!t.cover||t.cover&&!t.cover.coverImgUrl&&!t.cover.coverColor)&&t.hidden&&1==t.hidden.hideTitle?$(".survey_cover_text").removeClass("hide_padding").addClass("hide_desc_begin"):$(".survey_cover_text").removeClass("hide_padding hide_desc_begin")}(t),"en_US"==e&&($(".MobileServeyFooter .footer_content .jubao,.MobileServeyFooter .footer_content .btn_link_dc").hide(),$(".MobileServeyFooter .ma_auto .footer_content").css("text-align","center"),$(".MobileServeyFooter").addClass("appear_tips"))}else if("PC"==s){for(var T in $("#appearset_header").html(q),$("#appearset_logo").html(y),0==$("#appearset_header").find(".header_img").length&&0==$("#appearset_logo").find(".logo_img").length?$(".wjContent .content_box").addClass("content_top"):0==$("#appearset_header").find(".header_img").length&&0==$("#appearset_logo").find(".logo_img").length||$(".wjContent .content_box").removeClass("content_top"),n)t.hidden&&1==t.hidden[T]?n[T].addClass("hide"):n[T].removeClass("hide");!function(t){var e,i=t.background&&t.background.wjBgColor?t.background.wjBgColor:"#FFF",o=t.background&&(t.background.bgOpacity||0==t.background.bgOpacity)?t.background.bgOpacity:1,n=a(i,o),s={data:t,wjbColor:n},_=document.getElementById("pc_btncolor_template").innerHTML;e=juicer(_,s),$("#pc_appearset_style").remove(),$("body").append('<style id="pc_appearset_style">'+e+"</style>")}(t)}t.background&&function(t,e){$(".footer_mini").removeClass("change_font_color"),"PC"==e?"select_color"==t.backgroudType?($("body").css({backgroundColor:t.bgColor,backgroundImage:"none"}),t.bgColor&&"#f5f5f5"!=t.bgColor&&$(".footer_mini").addClass("change_font_color")):($("body").css({backgroundImage:"url("+t.bgImageUrl+")",backgroundRepeat:t.bgRepeat,backgroundColor:"#f5f5f5"}),t.bgImageUrl&&$(".footer_mini").addClass("change_font_color")):("select_color"==t.backgroudType?$("#appearset_bg").css({backgroundColor:t.bgColor,backgroundImage:"none"}):t.bgImageUrl?$("#appearset_bg").css({backgroundImage:"url("+t.bgImageUrl+")",backgroundColor:"#fff"}):$("#appearset_bg").css({backgroundImage:"none",backgroundColor:"#fff"}),"select_color"!=t.backgroudType&&t.bgImageUrl||"select_color"==t.backgroudType&&t.bgColor?$("body").addClass("change_body_color"):$("body").removeClass("change_body_color"))}(t.background,s),t.submit_btn&&"鎻愪氦"!=t.submit_btn.submitBtnText&&""!=t.submit_btn.submitBtnText&&t.submit_btn.submitBtnText,"1"!=i&&t.submit_btn?update_progress(t.submit_btn.submitBtnText):update_submit(t.submit_btn.submitBtnText),l&&function(t){var e=[],i=t.headerImgUrl,o=t.logo?t.logo.logoUrl:"";i&&e.push(i),o&&e.push(o);var n=e.length;$(".assess_header_div img").load(function(){--n>0||window.parent.getIframeHeight&&window.parent.getIframeHeight($("body").height())}),window.parent.getIframeHeight&&window.parent.getIframeHeight($("body").height())}(t),t.cover&&"1"==t.cover.titleShowOnCover&&(t.cover.coverImgUrl&&"color"!=t.cover.coverSetting||t.cover.coverColor&&"color"==t.cover.coverSetting)?$("body").addClass("title_show_cover"):$("body").removeClass("title_show_cover")},window.cover_show_mode=function(t){$.isEmptyObject(window.prev_answers_data)&&("None"==project_checkpoints||!project_checkpoints)&&t&&t.cover&&("color"!=t.cover.coverSetting&&t.cover.coverImgUrl||"color"==t.cover.coverSetting&&t.cover.coverColor)&&"begin_btn"==t.cover.beginBtnStyle?(l(),$("#appearset_cover").show(),$("body").removeClass("hide_appearset_cover")):(d(),$(".phone_content_wrap").show(),$("#appearset_cover").show(),$("body").removeClass("hide_appearset_cover"))},window.hide_cover=function(){$(".phone_content_wrap").show(),$("#appearset_cover").hide(),d(),$("body").addClass("hide_appearset_cover")},window.show_cover=function(){$("body").hasClass("answer_end_page")?location.reload():"None"!=project_checkpoints&&project_checkpoints||(l(),$("#appearset_cover").show(),$("body").removeClass("hide_appearset_cover"))}},,,function(t,e,i){"use strict";var o={getHtml:function(t,e){var i=t.question.custom_attr.disp_type||t.question.custom_attr.layout||"vertical",o=t.question.custom_attr.column_count||"1",n=100/parseInt(o)+"%";if("vertical"==i)n="100%";else if("matrix_scale"==i||"scale"==i)var a=parseInt(t.question.custom_attr.max_answer_num)-parseInt(t.question.custom_attr.min_answer_num)+1;var s={qmodel:t,question:t.question,disp_type:i,layout:i,column_count:o,col_width:n,star_off:window.star_off,extremum:a},_=juicer(e,s);return juicer.unregister("horz_blank_underline_change_to_input"),_}};e.a=o},function(t,e,i){"use strict";function o(t){QUESTION_DICT[get_oid(t)]=t}function n(t){delete QUESTION_DICT[t]}function a(){if(isNotEmpty(project)){window.project.title=_(window.project.title),window.project.begin_desc=_(window.project.begin_desc),window.project.end_desc=_(window.project.end_desc);for(var t=0;t<project.questionpage_list.length;t++){window.page=project.questionpage_list[t],QUESTIONPAGE_DICT[get_oid(page)]=page;for(var e=0;e<page.question_list.length;e++){var i=page.question_list[e];i.matrixrow_id_list&&0===i.matrixrow_id_list.length&&(i.matrixrow_list=[]),project.extra_data&&(i.extra_data={},i.extra_data.sms_quota=project.extra_data.sms_quota),QUESTION_DICT[get_oid(i)]=s(i)}}if(project.hasOwnProperty("jumpconstraint_list"))for(t=0;t<project.jumpconstraint_list.length;t++){var o=project.jumpconstraint_list[t];JUMPCONSTRIANT_DICT[o.id]=o,JUMPCONSTRAINT_SOURCE_Q_DICT[o.question_id]?JUMPCONSTRAINT_SOURCE_Q_DICT[o.question_id].push(o):JUMPCONSTRAINT_SOURCE_Q_DICT[o.question_id]=[o]}if(project.hasOwnProperty("displayconstraint_list"))for(t=0;t<project.displayconstraint_list.length;t++){var n=project.displayconstraint_list[t];DISPLAYCONSTRIANT_DICT[n.id]=n,DISPLAYCONSTRAINT_SOURCE_Q_DICT[n.question_id]?DISPLAYCONSTRAINT_SOURCE_Q_DICT[n.question_id].push(n):DISPLAYCONSTRAINT_SOURCE_Q_DICT[n.question_id]=[n];for(var a=0;a<n.condition.condition_item_list.length;a++)DISPLAYCONSTRIANT_DEST_QID_LIST.push(n.condition.condition_item_list[a].question_id)}if(project.hasOwnProperty("question_relation_list"))for(t=0;t<project.question_relation_list.length;t++){var l=project.question_relation_list[t];l.from_qid in RELATED_QUESTION_DICT?RELATED_QUESTION_DICT[l.from_qid].push(l):RELATED_QUESTION_DICT[l.from_qid]=[l]}if(project.hasOwnProperty("autoreplace_list"))for(t=0;t<project.autoreplace_list.length;t++){var d=project.autoreplace_list[t],r=AUTOREPLACE_SOURCE_Q_DICT[d.source_qid],c=AUTOREPLACE_OBJ_ID_DICT[d.obj_id];isNotEmpty(r)?(r.push(d),AUTOREPLACE_SOURCE_Q_DICT[d.source_qid]=r):AUTOREPLACE_SOURCE_Q_DICT[d.source_qid]=[d],isNotEmpty(c)?(c.push(d),AUTOREPLACE_OBJ_ID_DICT[d.obj_id]=c):AUTOREPLACE_OBJ_ID_DICT[d.obj_id]=[d]}}}function s(t){t.title=_(t.title);var e=t.option_list;if(e&&e.length>0)for(var i=0;i<e.length;i++)void 0!==e[i].title&&(e[i].title=_(e[i].title));return t}function _(t){return/schemas-microsoft-com|worddocument|mso-\w+/i.test(t)&&(t=function(t){var e=new RegExp("\x3c!--(.*?)--\x3e","g"),i=new RegExp("<(/)*(meta|link|\\?xml:|st1:|o:|font)(.*?)>","gi");return t.replace(/(\n|\r| class=(")?Mso[a-zA-Z]+(")?)/g,"").replace(e,"").replace(i,"")}(t)),t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*[<\/script>]+/gi,"").replace(/on\w+=[^>]+/g,"").replace(/[src|href]=['|"]?javascript:[^>]+/g,"")}i.d(e,"a",function(){return o}),i.d(e,"c",function(){return n}),i.d(e,"b",function(){return a}),window.QUESTION_DICT={},window.QUESTIONPAGE_DICT={},window.QMODEL_DICT={},window.JUMPCONSTRIANT_DICT={},window.DISPLAYCONSTRIANT_DICT={},window.AUTOREPLACE_SOURCE_Q_DICT={},window.AUTOREPLACE_OBJ_ID_DICT={},window.total_answers={},window.JUMPCONSTRAINT_SOURCE_Q_DICT={},window.DISPLAYCONSTRAINT_SOURCE_Q_DICT={},window.RELATED_QUESTION_DICT={},window.DISPLAYCONSTRIANT_DEST_QID_LIST=[],window.answer_path=[],window.curr_time_cost=0,window.site_url=window.location.protocol+"//"+window.location.host,window.mobile_auth_queston_status,window.selected_related_questions=[]},function(t,e){(function(e){t.exports=e}).call(this,{})},,,,,,,,function(t,e,i){var o;function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(a,s){function _(t,e){e=e||function(t){var e=JSON.parse(localStorage.getItem(t))||{},i={proportion:{endTime:l("2019-07-01"),showRedDot:!0},qlib:{endTime:l("2019-08-01"),showRedDot:!0},matrix_scale:{endTime:l("2019-07-13"),showRedDot:!0},settings:{endTime:l("2019-08-04"),showRedDot:!0},evaluation:{endTime:l("2019-07-30"),showRedDot:!0},banked_cloze:{endTime:l("2019-09-30"),showRedDot:!0},classification:{endTime:l("2019-08-30"),showRedDot:!0},scale:{endTime:l("2019-08-25"),showRedDot:!0},cloze:{endTime:l("2019-09-10"),showRedDot:!0}};return $.extend(i,e),i}(t);var i=(new Date).getTime();if("{}"!=JSON.stringify(e)){for(var o in e){i-e[o].endTime>0?(e[o].showRedDot=!1,delete e[o]):1==e[o].showRedDot&&($(".question_type_dl label[question-name='"+o+"']").addClass("showRedDot"),$(".left_nav li."+o).addClass("showRedDot"))}!function(t,e){localStorage.setItem(t,e)}(t,JSON.stringify(e))}}function l(t){return new Date(t).getTime()}function d(){this.configs=function(t,e){_(t,e)}}var d=new d;"object"===n(i(18))&&i(18)?void 0===(o=function(){return d}.call(e,i,e,t))||(t.exports=o):a._redSpotTip=d}(window,document)},,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e);var o=i(16),n=i(0),a=i(2),s={service:{title:"璇锋偍瀵规垜浠殑鏈嶅姟杩涜璇勪环",iconType:"star",maxAnwser:5,labelData:{1:{score_desc:"闈炲父涓嶆弧鎰�",label_list:["鎬佸害鍐锋贰","鎺ㄩ攢澶�","鎶€鏈樊"]},2:{score_desc:"姣旇緝涓嶆弧鎰�",label_list:["閫熷害鎱�","浠〃涔�","涓嶄笓涓�"]},3:{score_desc:"涓€鑸�",label_list:["鏃犱簰鍔�","涓嶇Н鏋�","涓氬姟涓嶇簿"]},4:{score_desc:"姣旇緝婊℃剰",label_list:["鏂囨槑绀艰矊","閫熷害蹇�","杈冧笓涓�"]},5:{score_desc:"闈炲父婊℃剰",label_list:["鐑儏濂藉","鏁笟绮剧","鎶€鑳戒笓涓�"]}}},food:{title:"璇峰鎮ㄦ娆＄殑鐢ㄩ浣撻獙杩涜璇勪环",iconType:"smile",maxAnwser:5,labelData:{1:{score_desc:"闈炲父涓嶆弧鎰�",label_list:["闅惧悆","鑴忎贡宸�","鐜鍢堟潅","鍒嗛噺灏�"]},2:{score_desc:"姣旇緝涓嶆弧鎰�",label_list:["鍛抽亾涓€鑸�","涓嶅崼鐢�","鐜涓嶅ソ","鎬佸害鍐锋贰"]},3:{score_desc:"涓€鑸�",label_list:["鍛抽亾杩樿","鍗敓涓€鑸�","鐜杩樿","鎬佸害涓€鑸�"]},4:{score_desc:"姣旇緝婊℃剰",label_list:["鍛抽亾涓嶉敊","骞插噣鍗敓","鐜涓嶉敊","鏂囨槑绀艰矊"]},5:{score_desc:"闈炲父婊℃剰",label_list:["鍛抽亾璧�","鎬т环姣旈珮","瑁呬慨濂界湅","鏈嶅姟鐑儏"]}}},shopping:{title:"璇峰鎮ㄦ娆＄殑璐墿浣撻獙杩涜璇勪环",iconType:"star",maxAnwser:5,labelData:{1:{score_desc:"闈炲父涓嶆弧鎰�",label_list:["璐ㄩ噺宸�","鎬т环姣斾綆","鏃犲敭鍚�"]},2:{score_desc:"姣旇緝涓嶆弧鎰�",label_list:["铏氬亣瀹ｄ紶","閫€鎹㈤夯鐑�","鎬佸害鍐锋贰"]},3:{score_desc:"涓€鑸�",label_list:["鏃犱紭鎯�","鏃犺禒鍝�","鏃犳湇鍔�"]},4:{score_desc:"姣旇緝婊℃剰",label_list:["鎬т环姣旈珮","鏈夎禒鍝�","鏂囨槑绀艰矊"]},5:{score_desc:"闈炲父婊℃剰",label_list:["瓒呰繃棰勬湡","璐ㄩ噺濂�","鍞悗鍛ㄥ埌"]}}},activity:{title:"璇锋偍瀵规垜浠殑杩欐娲诲姩杩涜璇勪环",iconType:"star",maxAnwser:3,labelData:{1:{score_desc:"涓嶆弧鎰�",label_list:["鍦哄湴鑴�","澶亸鍍�","绠＄悊娣蜂贡"]},2:{score_desc:"杩樺彲浠�",label_list:["浜烘皵涓€鑸�","鏃犵ぜ鍝�","鐜涓€鑸�"]},3:{score_desc:"婊℃剰",label_list:["鏈嶅姟鍒颁綅","瀹夋帓鍚堢悊","鐜涓€娴�"]}}},customerService:{title:"璇锋偍瀵规垜浠殑鏈嶅姟杩涜璇勪环",iconType:"smile",maxAnwser:2,labelData:{1:{score_desc:"涓嶆弧鎰�",label_list:["鎬佸害宸�","鎺ㄨ劚璐ｄ换","閫熷害鎱�"]},2:{score_desc:"婊℃剰",label_list:["楂樻晥","浜插垏","鑰愬績","琛ㄨ揪娓呮櫚"]}}},customize:{title:"璇勪环棰�",iconType:"star",maxAnwser:5,labelData:{1:{score_desc:"闈炲父涓嶆弧鎰�",label_list:["鏍囩1","鏍囩2"]},2:{score_desc:"姣旇緝涓嶆弧鎰�",label_list:["鏍囩1","鏍囩2"]},3:{score_desc:"涓€鑸�",label_list:["鏍囩1","鏍囩2"]},4:{score_desc:"姣旇緝婊℃剰",label_list:["鏍囩1","鏍囩2"]},5:{score_desc:"闈炲父婊℃剰",label_list:["鏍囩1","鏍囩2"]}}}};function l(t){return t.question_type==a.a.evaluationType.question_type&&t.custom_attr.disp_type==a.a.evaluationType.disp_type}n.b.prototype.gen_edit_template=function(){var t=this.get_edit_template();return o.a.getHtml(this,t)},n.b.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.b.prototype.hide_edit_error_msg=function(){verify_question_option.hide(this.qid)},n.B.prototype.get_edit_template=function(){return"dropdown"==(this.question.custom_attr.disp_type||this.question.custom_attr.layout||"vertical")||"dropdown"in this.question.custom_attr?'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堜笅鎷夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul">{@each question.related_question_list as related_question}{@each related_question.option_list as option}<li class="option_association disabled" data-related="true" data-related-question-id="&{related_question._id.$oid}"><div class="option_title_wrap"><i class="icon_wj icon_xxgl"></i><div class="option_title" id="&{option._id.$oid}">&&{option.title}<span class="text-relation"> [鍏宠仈鑷�&&{related_question.cid}]</span></div></div></li>{@/each}{@/each}{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_dropdown"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>':'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable">{@if question.title == \'鎬у埆\'}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟€у埆棰橈級" tabindex="0">&&{question.title}</div>{@else}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div>{@/if}</div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul"{@if question.custom_attr.layout == \'column\'} data-column="&{question.custom_attr.column_count}"{@else if !(\'layout\' in question.custom_attr)} data-column="1"{@/if}>{@each question.related_question_list as related_question}{@each related_question.option_list as option}<li class="option_association disabled" data-related="true" data-related-question-id="&{related_question._id.$oid}"><div class="option_title_wrap"><i class="icon_wj icon_xxgl"></i><div class="option_title" id="&{option._id.$oid}">&&{option.title}<span class="text-relation"> [鍏宠仈鑷�&&{related_question.cid}]</span></div></div></li>{@/each}{@/each}{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}{@if question.p_type == 2}{@if question.title != \'鎬у埆\' && option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if question.title != \'鎬у埆\' && (option.custom_attr.score && option.custom_attr.score != 0)}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div><div class="option_operate">{@if disp_type == "singlevote"}<div class="icon_wj btn_icon show_title {@if option.custom_attr && option.custom_attr.description}optiondescription_cot{@else}btn_option_description{@/if}" data-title="{@if option.custom_attr && option.custom_attr.description}閫夐」璇存槑{@else}娣诲姞閫夐」璇存槑{@/if}" edit-type="optiondescription">{@if option.custom_attr}&&{option.custom_attr.description}{@/if}</div>{@/if}<a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a>{@if disp_type != "judge"}<a class="btn_text_icon btn_add_other" operate-type="add_other_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_other"></i>娣诲姞銆屽叾浠栥€嶉」</a>{@/if}</div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.B.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.t.prototype.get_edit_template=function(){return"multiple_dropdown"==(this.question.custom_attr.disp_type||this.question.custom_attr.layout||"vertical")||"multiple_dropdown"in this.question.custom_attr?'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堜笅鎷夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul">{@each question.related_question_list as related_question}{@each related_question.option_list as option}<li class="option_association disabled" data-related="true" data-related-question-id="&{related_question._id.$oid}"><div class="option_title_wrap"><i class="icon_wj icon_xxgl"></i><div class="option_title" id="&{option._id.$oid}">&&{option.title}<span class="text-relation"> [鍏宠仈鑷�&&{related_question.cid}]</span></div></div></li>{@/each}{@/each}{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_dropdown"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>':'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true"  placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul"{@if question.custom_attr.layout == \'column\'} data-column="&{question.custom_attr.column_count}"{@else if !(\'layout\' in question.custom_attr)} data-column="1"{@/if}>{@each qmodel.question.related_question_list as related_question}{@each related_question.option_list as option}<li class="option_association disabled" data-related="true" data-related-question-id="&{related_question._id.$oid}"><div class="option_title_wrap"><i class="icon_wj icon_xxgl"></i><div class="option_title" id="&{option._id.$oid}">&&{option.title}<span class="text-relation"> [鍏宠仈鑷�&&{related_question.cid}]</span></div></div></li>{@/each}{@/each}{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true"  placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div><div class="option_operate">{@if disp_type == "multiplevote"}<div class="icon_wj btn_icon show_title {@if option.custom_attr && option.custom_attr.description}optiondescription_cot{@else}btn_option_description{@/if}" oid="&{qmodel.qid}" data-title="{@if option.custom_attr && option.custom_attr.description}閫夐」璇存槑{@else}娣诲姞閫夐」璇存槑{@/if}" edit-type="optiondescription">{@if option.custom_attr}&&{option.custom_attr.description}{@/if}</div>{@/if}<a class="icon_wj btn_icon btn_option_setting show_title" oid="&{qmodel.qid}" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" oid="&{qmodel.qid}" data-title="鍒犻櫎"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a><a class="btn_text_icon btn_add_other" operate-type="add_other_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_other"></i>娣诲姞銆屽叾浠栥€嶉」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.t.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.c.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable">{@if question.title == \'濮撳悕\'}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝鍚嶉锛�" tabindex="0">&&{question.title}</div>{@else if question.title == \'鎵嬫満鍙风爜\'}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟墜鏈哄彿鐮侀锛�" tabindex="0">&&{question.title}</div>{@else if question.title == \'閭\'}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堥偖绠遍锛�" tabindex="0">&&{question.title}</div>{@else}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝～绌洪锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div>{@/if}</div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list pr"><div class="blank_wrap">\x3c!-- 鏂版坊鍔犵殑濉┖棰� blank_type 鍊间负 single --\x3e<div disabled = "disabled" class="blanksframe input_vr_wrap"{@if question.custom_attr.blank_type != \'single\'} row="{@if question.option_list[0].custom_attr.text_row < 2}1{@else if question.option_list[0].custom_attr.text_row < 4}3{@else}5{@/if}"{@/if}>{@if question.p_type == 2}{@if question.option_list[0].custom_attr.correct_answer}<span class="right_key">姝ｇ‘绛旀锛�&&{question.option_list[0].custom_attr.correct_answer}</span>{@/if}{@/if}<div class="input_vr_icon"></div></div><div class="verification_code{@if !(\'sms_auth\' in question.option_list[0].custom_attr)} none{@/if}">鍙戦€侀獙璇佺爜</div></div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.A.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question score" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟墦鍒嗛锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul &&{question.custom_attr.score_display}">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap{@if question.option_list.length == 1} none{@/if}"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><div class="score_wrap"><div num="&&{question.custom_attr.max_answer_num - question.custom_attr.min_answer_num + 1}">{@each i in range(question.custom_attr.min_answer_num - 1, question.custom_attr.max_answer_num)}<span{@if i==question.custom_attr.min_answer_num - 1} class="active"{@/if}><em></em><i></i></span>{@/each}</div></div></li>{@/each}</ul><div class="prompt_view &&{question.custom_attr.score_display}"><span class="left">&&{question.custom_attr.desc_left}</span><span class="middle">&&{question.custom_attr.desc_middle}</span><span class="right">&&{question.custom_attr.desc_right}</span></div></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.A.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓墦鍒嗛」")},n.q.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question question_matrix_scale" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟墦鍒嗛锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul &&{question.custom_attr.score_display}"><div class="option_item table_head {@if question.custom_attr.scale_tag==0}noshow{@/if}"><div class="table_head_left"></div><div class="option_scale"><div class="scale_num_wrapper" num="&&{question.custom_attr.max_answer_num - question.custom_attr.min_answer_num + 1}">{@each i in range(question.custom_attr.min_answer_num-1, question.custom_attr.max_answer_num)}<div class="scale_num_inner"><div class="scale_lable_wrapper {@if i == question.custom_attr.min_answer_num-1 || i == question.custom_attr.max_answer_num-1}show_scale_lable{@/if}" data-direction="up" data-color-type="true" data-title="{@if i == question.custom_attr.min_answer_num-1}&&{question.custom_attr.desc_left}{@else if i == question.custom_attr.max_answer_num-1}&&{question.custom_attr.desc_right}{@/if}">{@if i == question.custom_attr.min_answer_num-1}<div class="scale_lable">&&{question.custom_attr.desc_left}</div>{@else if i == question.custom_attr.max_answer_num-1}<div class="scale_lable">&&{question.custom_attr.desc_right}</div>{@/if}</div><div class="scale_num">&&{i + 1}</div></div>{@/each}</div></div></div>{@if question.related_question_list.length>0}<div class="option_item related_question_display show_related_question" data-related="true"><div class="related_question_title"><div class="">琛屾爣棰樺紩鐢ㄨ嚜{@each question.related_question_list as related_question, index}&&{related_question.cid.replace(\'Q\', \'\')}{@if index!=question.related_question_list.length-1}銆亄@/if}{@/each}棰樼瓟妗�</div></div><div class="related_question_option &&{question.custom_attr.score_display}">{@each j in range(0, 3)}<div class="score_wrap"><div num="&&{question.custom_attr.max_answer_num - question.custom_attr.min_answer_num + 1}">{@each i in range(question.custom_attr.min_answer_num - 1, question.custom_attr.max_answer_num)}{@if question.custom_attr.score_display=="slider"}<span {@if i==question.custom_attr.min_answer_num}class="active {@if i==question.custom_attr.max_answer_num-1}last{@/if}"{@else if i==question.custom_attr.min_answer_num-1}class="first"{@else if i==question.custom_attr.max_answer_num-1}class="last"{@/if} ><em></em><i></i></span>{@else}<span{@if i==question.custom_attr.min_answer_num-1} class="active"{@/if} ><em></em><i></i></span>{@/if}{@/each}</div></div>{@/each}</div></div>{@/if}{@each question.option_list as option}<div class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrapper" name="scale"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{option._id.$oid}"></a></div></div><div class="score_wrap"><div num="&&{question.custom_attr.max_answer_num - question.custom_attr.min_answer_num + 1}">{@each i in range(question.custom_attr.min_answer_num - 1, question.custom_attr.max_answer_num)}{@if question.custom_attr.score_display=="slider"}<span {@if i==question.custom_attr.min_answer_num}class="active {@if i==question.custom_attr.max_answer_num-1}last{@/if}"{@else if i==question.custom_attr.min_answer_num-1}class="first"{@else if i==question.custom_attr.max_answer_num-1}class="last"{@/if} ><em></em><i></i></span>{@else}<span{@if i==question.custom_attr.min_answer_num-1} class="active"{@/if} ><em></em><i></i></span>{@/if}{@/each}</div></div></div>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.q.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓煩闃佃")},n.z.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question question_scale" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟墦鍒嗛锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><div num="&&{question.custom_attr.max_answer_num - question.custom_attr.min_answer_num + 1}" class="q_option_ul &&{question.custom_attr.score_display}" >{@if question.custom_attr.score_display=="slider"}{@each i in range(question.custom_attr.min_answer_num, question.custom_attr.max_answer_num + 1)}<div class="score-items"><div class="score-item-inner">{@if i==question.custom_attr.min_answer_num}<div class="pointer"></div>{@/if}</div>{@if question.p_type == 2}<div class="assess-score-title">{@if question.custom_attr.options && question.custom_attr.options[i - question.custom_attr.min_answer_num]}&&{question.custom_attr.options[i - question.custom_attr.min_answer_num].score}{@else}0{@/if}鍒�</div>{@/if}</div>{@/each}{@else}{@each i in range(question.custom_attr.min_answer_num, question.custom_attr.max_answer_num + 1)}<div class="score-items"><div class="score-item-inner">{@if question.custom_attr.score_display=="circle"}<div class="score-item {@if i==question.custom_attr.min_answer_num} active{@/if}"></div><div class="score-item-num {@if question.custom_attr.options_title_switch && question.custom_attr.options_title_switch == \'on\'}show_title{@/if}" data-title="{@if i == question.custom_attr.min_answer_num}&&{question.custom_attr.desc_left} {@else if i == question.custom_attr.max_answer_num}&&{question.custom_attr.desc_right} {@else} {@if question.custom_attr.options && question.custom_attr.options[i - question.custom_attr.min_answer_num] && question.custom_attr.options[i - question.custom_attr.min_answer_num].title}&&{question.custom_attr.options[i - question.custom_attr.min_answer_num].title}{@else}鑷畾涔夊唴瀹箋@/if}{@/if}">&&{i}</div>{@else}<div class="score-item  {@if question.custom_attr.options_title_switch && question.custom_attr.options_title_switch == \'on\'}show_title{@/if} {@if i==question.custom_attr.min_answer_num} active{@/if}" data-title="{@if i == question.custom_attr.min_answer_num}&&{question.custom_attr.desc_left} {@else if i == question.custom_attr.max_answer_num}&&{question.custom_attr.desc_right} {@else} {@if question.custom_attr.options && question.custom_attr.options[i - question.custom_attr.min_answer_num] && question.custom_attr.options[i - question.custom_attr.min_answer_num].title}&&{question.custom_attr.options[i - question.custom_attr.min_answer_num].title}{@else}鑷畾涔夊唴瀹箋@/if}{@/if}"></div>{@/if}</div>{@if question.p_type == 2}<div class="assess-score-title">{@if question.custom_attr.options && question.custom_attr.options[i - question.custom_attr.min_answer_num]}&&{question.custom_attr.options[i - question.custom_attr.min_answer_num].score}{@else}0{@/if}鍒�</div>{@/if}</div>{@/each}{@/if}</div><div class="q-scale-title-wrapper"><div class="q-scale-title q-scale-title-left">&&{question.custom_attr.desc_left}</div><div class="q-scale-title q-scale-title-right">&&{question.custom_attr.desc_right}</div></div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.x.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟帓搴忛锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_sort"></i><div class="option_title" edit-type="option" contenteditable="true"  placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.x.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.u.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝椤瑰～绌洪锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><div disabled = "disabled" class="blanksframe input_vr_wrap" {@if option.custom_attr.text_row == 2 || option.custom_attr.text_row == 3}row="3"{@else if option.custom_attr.text_row >= 4}row="5"{@/if}>{@if question.p_type == 2}{@if option.custom_attr.correct_answer}<span class="right_key">姝ｇ‘绛旀锛�&&{option.custom_attr.correct_answer}</span>{@/if}{@/if}<div class="input_vr_icon"></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.u.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓～绌洪」")},n.j.prototype.get_edit_template=function(){return juicer.register("horz_blank_underline_change_to_input",function(t){for(var e=t,i=e.match(/\_{3,}/g)||[],o=0;o<i.length;o++){var n=i[o],a='<span class="ipt-wrap"><input type="text" style="width: '+8*n.length+'px"><span class="input_vr_icon"></span></span>';e=e.replace(n,a)}return e}),'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟í鍚戝～绌洪锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul"><li class="option_item" id="" oid=""><div class="option_title_wrap"><div class="content_editable"><div class="pl10 horz_question_content &&{question.custom_attr.horz_blank_style}" edit-type="horz_blank_content" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{question.custom_attr.horz_blank_content|horz_blank_underline_change_to_input}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_help show_title" data-isaddicon="false" data-dir="right" data-title="姣忎釜濉┖绗︿负2涓眽瀛楀搴︼紝鍙繛缁緭鍏ワ紝鍏堕暱鐭喅瀹氱瓟棰樺～绌哄搴︼紝鍙敤閿洏鍒犻櫎閿洖閫€鍐呭"></a></div></div></li></ul></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.j.prototype.underline_change_to_input=function(){for(var t=$("#question_"+this.qid).find(".horz_question_content"),e=t.html(),i=e.match(/\_{3,}/g)||[],o=0;o<i.length;o++){var n=i[o],a='<span class="ipt-wrap"><input type="text" style="width: '+8*n.length+'px"><span class="input_vr_icon"></span></span>';e=e.replace(n,a)}t.html(e)},n.j.prototype.input_change_to_underline=function(){for(var t=$("#question_"+this.qid).find(".horz_question_content"),e=t.html(),i=new RegExp('<span class="ipt-wrap">(<input[^<>]+>)<span class="input_vr_icon"></span></span>',"g"),o=e.match(i)||[],n=0;n<o.length;n++){for(var a=t.find("input:eq("+n+")").width()/8,s="",_=0;_<a;_++)s+="_";e=e.replace(o[n],s)}t.html(e)},n.s.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_table"><div class="option_table_wrap"><table class="option_table" cellspacing="0" cellpadding="0"><tbody><tr><td><div class="td_wrap"></div></td>{@each question.option_list as option}<td class="option_item td_col" id="option_&{option._id.$oid}" oid="&{option._id.$oid}" {@if option.is_open}is_open="1" {@/if} align="center" name="col"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{option._id.$oid}"></a></div></div></td>{@/each}</tr>{@each question.matrixrow_list as row}<tr class=""><td class="option_item td_row" id="option_&{row._id.$oid}" oid="&{row._id.$oid}" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{row.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{row._id.$oid}"></a></div></div></td>{@each question.option_list as option}<td align="center"><i class="icon_wj icon_radio"></i>{@if option.is_open}<input type="text" name="" id="" class="open_input" readonly>{@/if}</td>{@/each}</tr>{@/each}</tbody></table></div><div class="q_matrix_option_vertical"><a class="btn_text_icon btn_add_single" operate-type="add_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鍗曚釜閫夐」"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞閫夐」"></i></a><a class="btn_text_icon btn_add_other" operate-type="add_other_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_other show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞銆屽叾浠栥€嶉」"></i></a></div></div><div class="q_option_operate q_option_operate_horizontal"><a class="btn_text_icon btn_add_single" operate-type="add_matrix_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鐭╅樀琛�"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞"></i></a><a class="btn_text btn_setting_col" operate-type="setting_col_width" oid="&{qmodel.qid}">璋冩暣鍒楀</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.s.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓煩闃佃鍜岄€夐」")},n.p.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_table"><div class="option_table_wrap"><table class="option_table" cellspacing="0" cellpadding="0"><tbody><tr><td><div class="td_wrap"></div></td>{@each question.option_list as option}<td class="option_item td_col" id="option_&{option._id.$oid}" oid="&{option._id.$oid}" {@if option.is_open}is_open="1" {@/if} align="center" name="col"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{option._id.$oid}"></a></div></div></td>{@/each}</tr>{@each question.matrixrow_list as row}<tr class=""><td class="option_item td_row" id="option_&{row._id.$oid}" oid="&{row._id.$oid}" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{row.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{row._id.$oid}"></a></div></div></td>{@each question.option_list as option}<td align="center"><i class="icon_wj icon_square"></i>{@if option.is_open}<input type="text" name="" id="" class="open_input" readonly>{@/if}</td>{@/each}</tr>{@/each}</tbody></table></div><div class="q_matrix_option_vertical"><a class="btn_text_icon btn_add_single" operate-type="add_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鍗曚釜閫夐」"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞閫夐」"></i></a><a class="btn_text_icon btn_add_other" operate-type="add_other_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_other show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞銆屽叾浠栥€嶉」"></i></a></div></div><div class="q_option_operate q_option_operate_horizontal"><a class="btn_text_icon btn_add_single" operate-type="add_matrix_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鐭╅樀琛�"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞"></i></a><a class="btn_text btn_setting_col" operate-type="setting_col_width" oid="&{qmodel.qid}">璋冩暣鍒楀</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.p.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓煩闃佃鍜岄€夐」")},n.o.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_table"><div class="option_table_wrap"><table class="option_table" cellspacing="0" cellpadding="0"><tbody><tr><td><div class="td_wrap"></div></td>{@each question.option_list as option}<td class="option_item td_col" id="option_&{option._id.$oid}" oid="&{option._id.$oid}" {@if option.is_open}is_open="1" {@/if} align="center" name="col"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{option._id.$oid}"></a></div></div></td>{@/each}</tr>{@each question.matrixrow_list as row}<tr class=""><td class="option_item td_row" id="option_&{row._id.$oid}" oid="&{row._id.$oid}" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{row.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{row._id.$oid}"></a></div></div></td>{@each question.option_list as option}<td align="center"><div class="matrix_blank input_vr_wrap"><textarea oid="&{option._id.$oid}" {@if option.custom_attr.text_row == 2 || option.custom_attr.text_row == 3}row="3"{@else if option.custom_attr.text_row >= 4}row="5"{@/if}></textarea><div class="input_vr_icon"></div></div></td>{@/each}</tr>{@/each}</tbody></table></div><div class="q_matrix_option_vertical"><a class="btn_text_icon btn_add_single" operate-type="add_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鍗曚釜閫夐」"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞閫夐」"></i></a></div></div><div class="q_option_operate q_option_operate_horizontal"><a class="btn_text_icon btn_add_single" operate-type="add_matrix_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鐭╅樀琛�"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞"></i></a><a class="btn_text btn_setting_col" operate-type="setting_col_width" oid="&{qmodel.qid}">璋冩暣鍒楀</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.o.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓煩闃佃鍜屽～绌洪」")},n.r.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_table"><div class="option_table_wrap"><table class="option_table" cellspacing="0" cellpadding="0" max_score=&{question.custom_attr.max_answer_num}><tbody><tr><td><div class="td_wrap"></div></td>{@each question.option_list as option}<td class="option_item td_col" id="option_&{option._id.$oid}" oid="&{option._id.$oid}" {@if option.is_open}is_open="1" {@/if}align="center" name="col"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{option._id.$oid}"></a></div></div></td>{@/each}</tr>{@each question.matrixrow_list as row}<tr class=""><td class="option_item td_row" id="option_&{row._id.$oid}" oid="&{row._id.$oid}" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{row.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{row._id.$oid}"></a></div></div></td>{@each question.option_list as option}<td align="center"><div class="matrix_score">{@each i in range(1, 11)}<span></span>{@/each}</div></td>{@/each}</tr>{@/each}</tbody></table></div><div class="q_matrix_option_vertical"><a class="btn_text_icon btn_add_single" operate-type="add_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鍗曚釜閫夐」"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_col" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞閫夐」"></i></a></div></div><div class="q_option_operate q_option_operate_horizontal"><a class="btn_text_icon btn_add_single" operate-type="add_matrix_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add show_title" data-isaddicon="false" data-dir="right" data-title="娣诲姞鐭╅樀琛�"></i></a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more show_title" data-isaddicon="false" data-dir="right" data-title="鎵归噺娣诲姞"></i></a><a class="btn_text btn_setting_col" operate-type="setting_col_width" oid="&{qmodel.qid}">璋冩暣鍒楀</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.r.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓墦鍒嗛」鍜屽垎鍊�")},n.h.prototype.get_edit_template=function(){return"split_line"===this.question.custom_attr.disp_type?'<div id="question_&{qmodel.qid}" class="module question question_split_line{@if question.one_page_one_question == \'1\'} split_line_or_paging_disabled{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" tabindex="0"><div class="split_line_wrap"><div class="dividing_line"></div></div><div class="q_operate split_line_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" data-title="闀挎寜鎷栧姩鍒嗗壊绾�"></a><a class="icon_wj btn_icon btn_split_line_del show_title" operate-type="del" data-title="鍒犻櫎鍒嗗壊绾�"></a></div></div>':'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="content_editable">\x3c!-- <i class="icon_wj_desc"></i> --\x3e<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫澶囨敞璇存槑" tabindex="0">{@if question.title == \'鎻忚堪璇存槑\'}澶囨敞璇存槑{@else}&&{question.title}{@/if}</div></div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.d.prototype.get_edit_template=function(){return"cascader"==this.question.custom_attr.disp_type?(console.log("source_qcascader"),'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_option_list"><div class="q_option_wrap cascader_list">{@each question.option_list as option,index}<div class="q_option_select_wrap cascader_wrap"><select class="cascader_item" name="cascader"data-cascader-select-index data-cascader-select-value data-cascader-selector="cascader-select-&{qmodel.qid}" data-cascader-start-index="0" data-cascader-end-index="&{question.option_list.length-1}" data-cascader-first-text="&{option.title}" data-cascader-index="&{index}"><option value="0">&&{option.title}</option>{@if index == 0 && question.custom_attr.option_data}{@each j in range(0, question.custom_attr.option_data.length)}<option value="&&{j+1}">&&{question.custom_attr.option_data[j].title}</option>{@/each}{@/if}</select></div>{@/each}</div></div><div class="q_option_operate"><a class="btn_text_icon" operate-type="edit_cascader_data" oid="&{qmodel.qid}"><i class="icon_wj icon_type_edit_detail"></i>缂栬緫閫夐」</a><a class="btn_text_icon" operate-type="edit_cascader_import" oid="&{qmodel.qid}"><i class="icon_wj icon_type_edit_import"></i>瀵煎叆閫夐」</a><span class="cascader_import_help"><span class="text"><span class="icon"></span>浣跨敤Excel妯℃澘鏂囦欢锛屽彲瀵圭骇鑱旈閫夐」杩涜鎵归噺缂栬緫<a target="_blank" href="/helpcenter/list/5232da3989c0971aa67264b0/h35c872657a320fc7253ebf326">鏌ョ湅鏇村</a></span></span></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'):'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0" drop-type="&{question.custom_attr.drop_type}"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝湴鍧€棰橈級" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list ml50 pr">{@if question.custom_attr.drop_type == "age"}<div class="blank_wrap blank_wrap_age"><input type="text" class="blanksframe r1" readonly><i class="icon_date"></i></div>{@else}<div class="select_transverse"><select id="&&{question.option_list[0]._id.$oid}"><option value="">璇烽€夋嫨鐪佷唤</option></select><select{@if question.option_list.length < 2} class="none" {@/if} id="{@if question.option_list[1]}&&{question.option_list[1]._id.$oid}{@/if}"><option value="">璇烽€夋嫨鍩庡競</option></select><select{@if question.option_list.length < 3} class="none" {@/if} id="{@if question.option_list[2]}&&{question.option_list[2]._id.$oid}{@/if}"><option value="">璇烽€夋嫨鍖�/鍘�</option></select><div class="textarea_wrap input_vr_wrap {@if question.option_list.length < 4}none{@/if}"><textarea placeholder="琛楅亾淇℃伅" id="{@if question.option_list[3]}&&{question.option_list[3]._id.$oid}{@/if}"></textarea><div class="input_vr_icon"></div></div></div>{@/if}</div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.e.prototype.get_edit_template=function(){return"date"===this.question.custom_attr.disp_type?'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟棩鏈熼锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><div class="blank_wrap blank_wrap_date"><input type="text" class="blanksframe r1" readonly><i class="icon_date"></i></div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>':"time"===this.question.custom_attr.disp_type?'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟椂闂撮锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list ml50"><select class="time hour" disabled="disabled"><option value="-1">灏忔椂</option>{@each i in range(1, 24)}<option value="&{i}">&{i}</option>{@/each}</select><span class="colon">:</span><select class="time minute" disabled="disabled"><option value="-1">鍒嗛挓</option>{@each i in range(1, 60)}<option value="&{i}">&{i}</option>{@/each}</select><br></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>':"upload_file"===this.question.custom_attr.disp_type?'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><div class="upFile"><i></i>{@if question.custom_attr.upload_num > 1}<span>閫夋嫨鏂囦欢锛堟渶澶氬彲涓婁紶&{question.custom_attr.upload_num}涓紝姣忎釜鏂囦欢30M浠ュ唴锛�</span>{@else}<span>閫夋嫨鏂囦欢锛�30M浠ュ唴锛�</span>{@/if}</div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort" operate-type="sort" oid="&{qmodel.qid}" title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic" operate-type="logic" oid="&{qmodel.qid}" title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone" operate-type="clone" oid="&{qmodel.qid}" title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del" operate-type="del" oid="&{qmodel.qid}" title="鍒犻櫎棰樼洰"></a></div></div>':this.question.custom_attr.disp_type===DISP_TYPE_GEOGRAPHICAL?'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><a class="map_a" qid="&{qmodel.qid}"><i></i>鐐瑰嚮鑾峰彇鍦扮悊浣嶇疆</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>':void 0},n.e.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.l.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_img_ul">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_radio"></i><div class="option_title content_editable" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div>{@if disp_type == "imagevote_single"}<div class="option_description_wrap" placeholder="閫夐」璇存槑锛堥€夊～锛�" edit-type="optiondescription">{@if option.custom_attr && option.custom_attr.description}&&{option.custom_attr.description|format_option_description}{@/if}</div>{@/if}</li>{@/each}<li class="option_add"><div class="option_add_con"><div class="option_add_txt"><span class="icon_wj icon_add_big"></span><span class="add_tip">鍗曟涓婁紶<br>鏈€澶�10寮犲浘鐗�</span></div><input type="file" name="files[]" multiple="multiple"></div><div class="option_add_con_ie"><form enctype="multipart/form-data" method="POST" action="" id="logo_uploader_form"><iframe frameborder="0" style="filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity:0;opacity:0;position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;" id="imgUpload" class="uploadfile" src="/edit/form/ajax/create_image_option/&{question.project_id}/?qid=&{qmodel.qid}&plugin=1"></iframe><div class="WJButton">涓婁紶</div></form></div></li></ul></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.l.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1寮犲浘鐗�")},n.k.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_img_ul">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_square"></i><div class="option_title content_editable" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div>{@if disp_type == "imagevote_multiple"}<div class="option_description_wrap" placeholder="閫夐」璇存槑锛堥€夊～锛�" edit-type="optiondescription">{@if option.custom_attr && option.custom_attr.description}&&{option.custom_attr.description|format_option_description}{@/if}</div>{@/if}</li>{@/each}<li class="option_add"><div class="option_add_con"><div class="option_add_txt"><span class="icon_wj icon_add_big"></span><span class="add_tip">鍗曟涓婁紶<br>鏈€澶�10寮犲浘鐗�</span></div><input type="file" name="files[]" multiple="multiple"></div><div class="option_add_con_ie"><form enctype="multipart/form-data" method="POST" action="" id="logo_uploader_form"><iframe frameborder="0" style="filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity:0;opacity:0;position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;" id="imgUpload" class="uploadfile" src="/edit/form/ajax/create_image_option/&{question.project_id}/?qid=&{qmodel.qid}&plugin=1"></iframe><div class="WJButton">涓婁紶</div></form></div></li></ul></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.k.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1寮犲浘鐗�")},n.w.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><div class="grade clearfix">{@each i in range(parseInt(question.custom_attr.min_answer_num), parseInt(question.custom_attr.max_answer_num) + 1)}<div class="nps_radius">&{i}</div>{@/each}</div><div class="nps_tip_text"><span class="fl">涓嶅彲鑳�</span><span class="fr">鏋佹湁鍙兘</span></div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.C.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable">{@if question.title == \'鎬у埆\'}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟€у埆棰橈級" tabindex="0">&&{question.title}</div>{@else}<div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div>{@/if}</div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul"{@if question.custom_attr.layout == \'column\'} data-column="&{question.custom_attr.column_count}"{@else if !(\'layout\' in question.custom_attr)} data-column="1"{@/if}>{@each question.related_question_list as related_question}{@each related_question.option_list as option}<li class="option_association disabled" data-related="true" data-related-question-id="&{related_question._id.$oid}"><div class="option_title_wrap"><i class="icon_wj icon_xxgl"></i><div class="option_title" id="&{option._id.$oid}">&&{option.title}<span class="text-relation"> [鍏宠仈鑷�&&{related_question.cid}]</span></div></div></li>{@/each}{@/each}{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}{@if question.p_type == 2}{@if question.title != \'鎬у埆\' && option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if question.title != \'鎬у埆\' && (option.custom_attr.score && option.custom_attr.score != 0)}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div><div class="option_operate">{@if disp_type == "singlevote"}<div class="icon_wj btn_icon show_title {@if option.custom_attr && option.custom_attr.description}optiondescription_cot{@else}btn_option_description{@/if}" data-title="{@if option.custom_attr && option.custom_attr.description}閫夐」璇存槑{@else}娣诲姞閫夐」璇存槑{@/if}" edit-type="optiondescription">{@if option.custom_attr}&&{option.custom_attr.description}{@/if}</div>{@/if}<a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.v.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true"  placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul"{@if question.custom_attr.layout == \'column\'} data-column="&{question.custom_attr.column_count}"{@else if !(\'layout\' in question.custom_attr)} data-column="1"{@/if}>{@each qmodel.question.related_question_list as related_question}{@each related_question.option_list as option}<li class="option_association disabled" data-related="true" data-related-question-id="&{related_question._id.$oid}"><div class="option_title_wrap"><i class="icon_wj icon_xxgl"></i><div class="option_title" id="&{option._id.$oid}">&&{option.title}<span class="text-relation"> [鍏宠仈鑷�&&{related_question.cid}]</span></div></div></li>{@/each}{@/each}{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true"  placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div><div class="option_operate">{@if disp_type == "multiplevote"}<div class="icon_wj btn_icon show_title {@if option.custom_attr && option.custom_attr.description}optiondescription_cot{@else}btn_option_description{@/if}" oid="&{qmodel.qid}" data-title="{@if option.custom_attr && option.custom_attr.description}閫夐」璇存槑{@else}娣诲姞閫夐」璇存槑{@/if}" edit-type="optiondescription">{@if option.custom_attr}&&{option.custom_attr.description}{@/if}</div>{@/if}<a class="icon_wj btn_icon btn_option_setting show_title" oid="&{qmodel.qid}" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" oid="&{qmodel.qid}" data-title="鍒犻櫎"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.n.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_img_ul">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_radio"></i><div class="option_title content_editable" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div>{@if disp_type == "imagevote_single"}<div class="option_description_wrap" placeholder="閫夐」璇存槑锛堥€夊～锛�" edit-type="optiondescription">{@if option.custom_attr && option.custom_attr.description}&&{option.custom_attr.description|format_option_description}{@/if}</div>{@/if}</li>{@/each}<li class="option_add"><div class="option_add_con"><div class="option_add_txt"><span class="icon_wj icon_add_big"></span><span class="add_tip">鍗曟涓婁紶<br>鏈€澶�10寮犲浘鐗�</span></div><input type="file" name="files[]" multiple="multiple"></div><div class="option_add_con_ie"><form enctype="multipart/form-data" method="POST" action="" id="logo_uploader_form"><iframe frameborder="0" style="filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity:0;opacity:0;position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;" id="imgUpload" class="uploadfile" src="/edit/form/ajax/create_image_option/&{question.project_id}/?qid=&{qmodel.qid}&plugin=1"></iframe><div class="WJButton">涓婁紶</div></form></div></li></ul></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.m.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝崟閫夐锛�" tabindex="0">&&{question.title}{@if question.p_type == 2}{@if question.question_max_score || question.question_max_score != 0}<span class="evaluation_score">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}{@/if}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_img_ul">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_square"></i><div class="option_title content_editable" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if question.p_type == 2}{@if option.custom_attr.is_correct}<span class="right_key">(姝ｇ‘绛旀)</span>{@else if option.custom_attr.score && option.custom_attr.score != 0}<span class="option_score">(鍒嗗€硷細&&{option.custom_attr.score}鍒�)</span>{@/if}{@/if}</div></div>{@if disp_type == "imagevote_multiple"}<div class="option_description_wrap" placeholder="閫夐」璇存槑锛堥€夊～锛�" edit-type="optiondescription">{@if option.custom_attr && option.custom_attr.description}&&{option.custom_attr.description|format_option_description}{@/if}</div>{@/if}</li>{@/each}<li class="option_add"><div class="option_add_con"><div class="option_add_txt"><span class="icon_wj icon_add_big"></span><span class="add_tip">鍗曟涓婁紶<br>鏈€澶�10寮犲浘鐗�</span></div><input type="file" name="files[]" multiple="multiple"></div><div class="option_add_con_ie"><form enctype="multipart/form-data" method="POST" action="" id="logo_uploader_form"><iframe frameborder="0" style="filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity:0;opacity:0;position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;" id="imgUpload" class="uploadfile" src="/edit/form/ajax/create_image_option/&{question.project_id}/?qid=&{qmodel.qid}&plugin=1"></iframe><div class="WJButton">涓婁紶</div></form></div></li></ul></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.y.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堟瘮閲嶉锛�" tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="proportion_sum {@if (question.custom_attr.limit_total == false)} none{@/if}">姣旈噸鎬诲拰锛�<span class="total_value">&&{question.custom_attr.total_value}</span></div><div class="q_option_list q_proportion_list"><ul class="q_option_ul" data-column="1">{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><div class="option_proportion"><div class="proportion_slider"><div class="ruler">{@each question.custom_attr.tick_data as tick}<div class="tick" style="{@if question.custom_attr.tick_data.length < 6}width: &{question.custom_attr.tick_width}%;{@/if}" ><div class="number">&&{tick}</div><div><i></i><i class="{@if question.custom_attr.max_answer_num - question.custom_attr.min_answer_num < 6 || tick == question.custom_attr.max_answer_num}none{@/if}"></i></div></div>{@/each}</div><div class="proportion_bar"><i></i></div></div><span class="min_value">&&{question.custom_attr.min_answer_num}</span></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.y.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.i.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question evaluation" oid="&{qmodel.qid}"question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堣瘎浠烽锛�"tabindex="0">&&{question.title}</div></div></div><div class="q_desc_wrap{@if !(\'desc\' in question.custom_attr)} none{@/if}"><div class="content_editable"><div class="q_desc" edit-type="desc" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰璇存槑" tabindex="0">&&{question.custom_attr.desc}</div></div></div><div class="q_option_list"><ul class="q_option_ul &&{question.custom_attr.score_display}" data-column="1"><li class="option_item" id="option_&{question.option_list[0]._id.$oid}"oid="&{question.option_list[0]._id.$oid}"><div class="score_wrap"><div num="&&{question.custom_attr.max_answer_num - question.custom_attr.min_answer_num + 1}">{@each i in range(question.custom_attr.min_answer_num - 1, question.custom_attr.max_answer_num)}<span {@if i==question.custom_attr.min_answer_num - 1} class="active" {@/if} data-index="&{i}"> <em></em><i></i></span>{@/each}</div></div></li><li class="option_item desc" id="option_&{question.option_list[0]._id.$oid}"oid="&{question.option_list[0]._id.$oid}">{@if question.option_list[1].custom_attr.label_data["1"].score_desc.trim()}<div class="score_desc">鈥�&&{question.option_list[1].custom_attr.label_data["1"].score_desc}鈥�</div>{@/if}<div class="label_list">{@each question.option_list[1].custom_attr.label_data["1"].label_list as label}{@if label.trim()}<label>&&{label}</label>{@/if}{@/each}<label class="write-evaluation{@if question.custom_attr.open_eval != \'on\'} none{@/if}">鍐欒瘎浠�<i></i></label><label class="edit-label" data-num="&{question.edit_num}">缂栬緫<i></i></label></div></li></ul></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}"data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}"data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}"data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}"data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.a.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question banked_cloze{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝畬褰㈠～绌洪锛�" tabindex="0">&&{question.title}{@if question.p_type == 2 && question.question_max_score}<span class="evaluation_score{@if !question.question_max_score} hide{@/if}">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}</div></div></div><div class="q_main_content"><div class="q_stem_content_list"><ul class="q_stem_content_ul ui-sortable">{@each question.custom_attr.stem_content_obj_list as stem_content, index}<li data-index="&{index}" class="stem_content_item"><div class="stem_content_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩棰樺共"></span><div class="content_editable"><div class="pl10 stem_content" edit-type="stem_content" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樺共" tabindex="0">{@each stem_content as obj}&&{obj.content}{@if obj.optionIndex !== null}{@if question.custom_attr.blank_style == \'underscore\'}<input class="banked_cloze_option underscore" oid="&{question.option_id_list[obj.optionIndex]}" disabled placeholder="&{obj.optionIndex + 1}" />{@else}<input class="banked_cloze_option bracket" oid="&{question.option_id_list[obj.optionIndex]}" disabled placeholder="銆� &{obj.optionIndex + 1} 銆�" />{@/if}{@/if}{@/each}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎" data-type="stem_content" data-index="&{index}"></a></div></div></li>{@/each}</ul></div><div class="q_stem_option_list"><ul class="q_stem_option_ul ui-sortable" {@if question.custom_attr.layout == \'column\'} data-column="&{question.custom_attr.column_count}"{@else if !(\'layout\' in question.custom_attr)} data-column="1"{@/if}>{@each question.extra_option_list as stem_option, index}<li class="stem_option_item" oid="&{stem_option._id.$oid}"><div class="stem_option_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><span class="stem_option_order">&{index|transformNumToLetter}.</span><div class="pl10 stem_option" edit-type="extra_option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{stem_option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎" data-type="extra_option" data-index="&{index}"></a></div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_stem" operate-type="add_stem" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞棰樺共</a><a class="btn_text_icon btn_add_single" operate-type="add_single_stem_option" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍗曚釜閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_stem_option" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.a.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.g.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question cloze{@if question.custom_attr.answer_score == \'off\'} hide_score{@/if}" oid="&{qmodel.qid}" question-type="&{question.question_type}" disp_type="&{disp_type}" cols_count="&{column_count}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О锛堝畬褰㈠～绌洪锛�" tabindex="0">&&{question.title}{@if question.p_type == 2 && question.question_max_score}<span class="evaluation_score{@if !question.question_max_score} hide{@/if}">(鏈€楂樺垎鍊硷細&&{question.question_max_score}鍒�)</span>{@/if}</div></div></div><div class="q_option_list"><ul class="q_option_ul"><li class="option_item"><div class="option_title_wrap"><div class="content_editable" qid="&{qmodel.qid}"><div class="pl10 cloze_question_content" edit-type="cloze_content" contenteditable="true" tabindex="0" placeholder="鐐瑰嚮娣诲姞棰樼洰鏂囨湰鍙婇€夐」">{@each i in range(0, question.custom_attr.cloze_content_list.length)}&&{question.custom_attr.cloze_content_list[i]}{@if i < question.option_id_list.length}<input class="cloze_lable" placeholder="&{i+1}" disabled oid="&{question.option_id_list[i]}" />{@/if}{@/each}</div></div></div></li></ul></div><div class="q_option_operate"><label class="edit_option"><i class="edit_option_icon"></i>缂栬緫閫夐」</label></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'},n.g.prototype.show_edit_error_msg=function(){verify_question_option.show(this.qid,"璇疯嚦灏戞坊鍔�1涓€夐」")},n.f.prototype.get_edit_template=function(){return'<div id="question_&{qmodel.qid}" class="module question classification" oid="&{qmodel.qid}" question-type="&{question.question_type}" tabindex="0"><div class="q_content_wrap"><div class="q_content"><div class="q_title_wrap"><div class="q_seq">&&{question.cid.replace("Q", "")}</div><div class="content_editable"><div class="q_title" edit-type="question" contenteditable="true" placeholder="鐐瑰嚮缂栬緫棰樼洰鍚嶇О(鍒嗙被棰�)" tabindex="0">&&{question.title}</div></div></div><div class="q_edit_wrap"><div class="q_option_list"><div class="q_option_wrap"><div class="wrap_title">閫夐」</div><ul class="q_option_ul">{@each question.related_question_list as related_question}{@each related_question.option_list as option}<li class="option_association disabled" data-related="true" data-related-question-id="&{related_question._id.$oid}"><div class="option_title_wrap"><i class="icon_wj icon_xxgl"></i><div class="option_title" id="&{option._id.$oid}">&&{option.title}<span class="text-relation"> [鍏宠仈鑷�&&{related_question.cid}]</span></div></div></li>{@/each}{@/each}{@each question.option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><div class="content_editable"><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><i class="classify_operate_icon{@if question.option_list.length == 1} none{@/if}"></i></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞閫夐」</a><a class="btn_text_icon btn_add_more" operate-type="add_more_row" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞閫夐」</a></div></div><div class="q_category_list"><div class="q_option_wrap"><div class="wrap_title">绫诲埆</div><ul class="q_extra_option_ul">{@each question.extra_option_list as option}<li class="option_item" id="extra_option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><div class="content_editable"><div class="option_title category_title" edit-type="extra_option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫绫诲埆" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><i class="classify_operate_icon{@if question.extra_option_list.length == 1} none{@/if}"></i></div><div class="drag_area"><div>鎷栧叆姝ゅ</div></div></li>{@/each}</ul></div><div class="q_option_operate"><a class="btn_text_icon btn_add_single" operate-type="add_category" oid="&{qmodel.qid}"><i class="icon_wj icon_add"></i>娣诲姞鍒嗙被</a><a class="btn_text_icon btn_add_more" operate-type="add_multi_category" oid="&{qmodel.qid}"><i class="icon_wj icon_add_more"></i>鎵归噺娣诲姞鍒嗙被</a></div></div></div></div></div><div class="q_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" oid="&{qmodel.qid}" data-title="闀挎寜鎷栧姩棰樼洰"></a><a class="icon_wj btn_icon btn_question_logic show_title" operate-type="logic" oid="&{qmodel.qid}" data-title="閫昏緫璁剧疆"></a><a class="icon_wj btn_icon btn_question_clone show_title" operate-type="clone" oid="&{qmodel.qid}" data-title="澶嶅埗棰樼洰"></a><a class="icon_wj btn_icon btn_question_del show_title" operate-type="del" oid="&{qmodel.qid}" data-title="鍒犻櫎棰樼洰"></a></div></div>'};var d={};d[QUESTION_TYPE_SINGLE]=n.B,d[QUESTION_TYPE_MULTIPLE]=n.t,d[QUESTION_TYPE_BLANK]=n.c,d[QUESTION_TYPE_SCORE]=n.A,d[QUESTION_TYPE_ORDER]=n.x,d[QUESTION_TYPE_MULTIPLE_BLANK]=n.u,d[QUESTION_TYPE_MATRIX_SINGLE]=n.s,d[QUESTION_TYPE_MATRIX_MULTIPLE]=n.p,d[QUESTION_TYPE_MATRIX_SCORE]=n.r,d[QUESTION_TYPE_MATRIX_BLANK]=n.o,d[QUESTION_TYPE_DESC]=n.h,d[QUESTION_TYPE_BLANK_DROPDOWN]=n.d,d[QUESTION_TYPE_CLASSIFICATION]=n.f;var r=function(t){var e=d[t.question_type];if(isNotEmpty(t.custom_attr.disp_type)){var i;if(t.question_type===QUESTION_TYPE_MULTIPLE_BLANK)return"horz_blank"==(i=t.custom_attr.disp_type)?new n.j(t):"banked_cloze"===i?new n.a(t):"cloze"===i?new n.g(t):new n.e(t);if(check_in(t.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE]))return"image_single"==(i=t.custom_attr.disp_type)?new n.l(t):"image_multiple"==i?new n.k(t):"singlevote"==i?new n.C(t):"multiplevote"==i?new n.v(t):"imagevote_single"==i?new n.n(t):"imagevote_multiple"==i?new n.m(t):new e(t);if(!check_in(t.question_type,[QUESTION_TYPE_SCORE]))return new e(t);if("nps_score"==(i=t.custom_attr.disp_type))return new n.w(t);if("matrix_scale"==i)return new n.q(t);if("proportion"==i)return new n.y(t);if(l(t))return new n.i(t);if("scale"==i)return new n.z(t)}return new e(t)},c={},p={},u={};c[QUESTION_TYPE_SINGLE]='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><div class="option_operate">{@if disp_type == "singlevote"}<div class="icon_wj btn_icon show_title {@if option.custom_attr && option.custom_attr.description}optiondescription_cot{@else}btn_option_description{@/if}" data-title="{@if option.custom_attr && option.custom_attr.description}閫夐」璇存槑{@else}娣诲姞閫夐」璇存槑{@/if}" edit-type="optiondescription">{@if option.custom_attr}&&{option.custom_attr.description}{@/if}</div>{@/if}<a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',c.dropdown='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_dropdown"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if option.is_open}<input type="text" name="" id="" class="open_input">{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',c.multiple_dropdown='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_dropdown"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if option.is_open}<input type="text" name="" id="" class="open_input">{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',c.judge='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if option.is_open}<input type="text" name="" id="" class="open_input">{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',c.sex='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"}{@/if}>&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',p[QUESTION_TYPE_SINGLE]='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',p.dropdown='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_dropdown"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',p.multiple_dropdown='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_dropdown"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',p.judge='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',p.sex='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',c[QUESTION_TYPE_MULTIPLE]='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',p[QUESTION_TYPE_MULTIPLE]='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',c.singlevote='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_description show_title" data-title="娣诲姞閫夐」璇存槑" edit-type="optiondescription"><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',p.singlevote='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',c.multiplevote='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if option.is_open}<input type="text" name="" id="" class="open_input">{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_description show_title" data-title="娣诲姞閫夐」璇存槑" edit-type="optiondescription"></a><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',p.multiplevote='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',c.image_single='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div></li>{@/each}',c.image_multiple='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div></li>{@/each}',p[QUESTION_TYPE_MULTIPLE_BLANK]='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><textarea class="blanksframe mt6 l10 r1"></textarea></li>',c[QUESTION_TYPE_MULTIPLE_BLANK]='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_setting show_title" data-title="璁剧疆"></a><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><textarea class="blanksframe mt6 l10 r1 r&{option.custom_attr.text_row}"></textarea></li>{@/each}',c.imagevote_single='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_radio"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_description_wrap" placeholder="閫夐」璇存槑锛堥€夊～锛�" edit-type="optiondescription"></div></li>{@/each}',c.imagevote_multiple='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_img_box"><img src="&&{option.custom_attr.images.thumbnail_src}" origin-url="&&{option.custom_attr.images.src}" bbox="&{option.custom_attr.images.bbox}" origin-width="&{option.custom_attr.images.orig_width}"><input type="file" name="files[]" multiple="multiple" style="display: none;"><div class="img_handle"><a class="btn_txt btn_img_edit">缂栬緫</a><a class="btn_txt btn_img_del">鍒犻櫎</a></div></div><div class="option_title_wrap"><i class="icon_wj icon_square"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_description_wrap" placeholder="閫夐」璇存槑锛堥€夊～锛�" edit-type="optiondescription"></div></li>{@/each}',c[QUESTION_TYPE_ORDER]='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_sort"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if option.is_open}<input type="text" name="" id="" class="open_input">{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>{@/each}',p[QUESTION_TYPE_ORDER]='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><i class="icon_wj icon_sort"></i><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div></li>',p[QUESTION_TYPE_SCORE]='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><div class="score_wrap"><div num="&&{data.num}">{@each i in range(0, data.num)}<span{@if i==0} class="active" {@/if}><em></em><i></i></span>{@/each}</div></div></li>',c[QUESTION_TYPE_MATRIX_SINGLE]='{@each row_list as row}<tr><td class="option_item td_row" id="option_&{row._id.$oid}" oid="&{row._id.$oid}" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{row.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{row._id.$oid}"></a></div></div></td>{@each option_list as option}<td align="center"><i class="icon_wj icon_radio"></i>{@if option.is_open}<input type="text" name="" id="" class="open_input" readonly>{@/if}</td>{@/each}</tr>{@/each}',p.matrix_scale='<li class="option_item" id="new" oid=""><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><div class="score_wrap"><div num="&&{data.num}">{@each i in range(0, data.num)}<span{@if i==0} class="active" {@/if}><em></em><i></i></span>{@/each}</div></div></li>',p[QUESTION_TYPE_MATRIX_SINGLE]='<tr><td class="option_item td_row" id="new" oid="" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="new"></a></div></div></td>{@each data.option_list as option}<td align="center"><i class="icon_wj icon_radio"></i>{@if option.is_open}<input type="text" name="" id="" class="open_input" readonly>{@/if}</td>{@/each}</tr>',c[QUESTION_TYPE_MATRIX_BLANK]='{@each row_list as row}<tr><td class="option_item td_row" id="option_&{row._id.$oid}" oid="&{row._id.$oid}" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{row.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{row._id.$oid}"></a></div></div></td>{@each option_list as option}<td align="center"><div class="matrix_blank input_vr_wrap"><textarea oid="&{option._id.$oid}" class="" &{option.custom_attr.text_row} {@if option.custom_attr.text_row == 2 || option.custom_attr.text_row == 3}row="3"{@else if option.custom_attr.text_row >= 4}row="5"{@/if}></textarea></div></td>{@/each}</tr>{@/each}',p[QUESTION_TYPE_MATRIX_BLANK]='<tr><td class="option_item td_row" id="new" oid="" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="new"></a></div></div></td>{@each data.option_list as option}<td align="center"><textarea oid="" class="matrix_blank" &{option.custom_attr.text_row} {@if option.custom_attr.text_row == 2 || option.custom_attr.text_row == 3}row="3"{@else if option.custom_attr.text_row >= 4}row="5"{@/if}></textarea></td>{@/each}</tr>',c[QUESTION_TYPE_MATRIX_SCORE]='{@each row_list as row}<tr><td class="option_item td_row" id="option_&{row._id.$oid}" oid="&{row._id.$oid}" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{row.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{row._id.$oid}"></a></div></div></td>{@each option_list as option}<td align="center"><div class="matrix_score">{@each i in range(1, 11)}<span></span>{@/each}</div></td>{@/each}</tr>{@/each}',p[QUESTION_TYPE_MATRIX_SCORE]='<tr><td class="option_item td_row" id="new" oid="" align="center" name="row"><div class="td_wrap"><div class="content_editable"><div class="option_title" edit-type="row" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="new"></a></div></div></td>{@each data.option_list as option}<td align="center"><div class="matrix_score">{@each i in range(1, 11)}<span></span>{@/each}</div></td>{@/each}</tr>',c[QUESTION_TYPE_SCORE]='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}{@if option.is_open}<input type="text" name="" id="" class="open_input">{@/if}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><div class="score_wrap"><div num="&&{option_extra.num}">{@each i in range(0, option_extra.num)}<span{@if i==0} class="active" {@/if}><em></em><i></i></span>{@/each}</div></div></li>{@/each}',c.matrix_scale='{@each option_list as option}<div class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrapper" name="scale"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{option._id.$oid}"></a></div></div><div class="score_wrap"><div num="&&{option_extra.num}">{@each i in range(option_extra.min - 1, option_extra.max)}{@if option_extra.score_display=="slider"}<span {@if i==option_extra.min}class="active {@if i==option_extra.max-1}last{@/if}"{@else if i==option_extra.min-1}class="first"{@else if i==option_extra.max-1}class="last"{@/if} ><em></em><i></i></span>{@else}<span{@if i==option_extra.min-1} class="active"{@/if} ><em></em><i></i></span>{@/if}{@/each}</div></div></div>{@/each}',p.col='<td class="option_item td_col" id="new" oid="" align="center" name="col"><div class="td_wrap" style="width:150px;"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"></div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="new"></a></div></div></td>',c.col='{@each option_list as option}<td class="option_item td_col" id="option_&{option._id.$oid}" oid="&{option._id.$oid}" {@if option.is_open}is_open="1" {@/if} align="center" name="col"><div class="td_wrap" style="width:150px;"><div class="content_editable"><div class="option_title" edit-type="col" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_dropdown" oid="&{option._id.$oid}"></a></div></div></td>{@/each}',c.evaluation='<li class="option_item" id="option_&{option_list[0]._id.$oid}" oid="&{option_list[0]._id.$oid}"><div class="score_wrap"><div num="&&{option_extra.num}">{@each i in range(0, option_extra.num)}<span {@if i == 0 || i <= option_extra.edit_num} class="active" {@/if} data-index="&{i}"><em></em><i></i></span>{@/each}</div></div></li><li class="option_item desc" id="option_&{option_list[0]._id.$oid}" oid="&{option_list[0]._id.$oid}">{@if option_extra.score_desc.trim()}<div class="score_desc">鈥�&&{option_extra.score_desc}鈥�</div>{@/if}<div class="label_list">{@each option_extra.label_list as label}{@if label.trim()}<label>&&{label}</label>{@/if}{@/each}<label class="write-evaluation{@if option_extra.open_eval != "on"} none{@/if}">鍐欒瘎浠�<i></i></label><label class="edit-label" data-num="&{option_extra.edit_num}">缂栬緫<i></i></label></div></li>',c.evaluation_pop='<div class="q_option_list"><ul class="q_option_ul &&{custom_attr.score_display}"><li class="option_item" id="option_&{option_list[0]._id.$oid}" oid="&{option_list[0]._id.$oid}"><div class="score_wrap"><div num="&&{custom_attr.max_answer_num - custom_attr.min_answer_num + 1}">{@each i in range(custom_attr.min_answer_num - 1, custom_attr.max_answer_num)}<span {@if i== 0 || i <= edit_num} class="active" {@/if} data-index="&{i}"> <em></em><i></i></span>{@/each}</div></div></li><li class="option_item desc" id="option_&{option_list[0]._id.$oid}" oid="&{option_list[0]._id.$oid}">{@if temp_data.label_data[edit_num + 1].score_desc.trim()}<div class="score_desc">鈥�&&{temp_data.label_data[edit_num + 1].score_desc}鈥�</div>{@/if}<div class="label_list">{@each temp_data.label_data[edit_num + 1].label_list as label}{@if label.trim()}<label>&&{label.trim()}</label>{@/if}{@/each}{@if custom_attr.open_eval == "on"}<label class="write-evaluation">鍐欒瘎浠�<i></i></label>{@/if}</div></li></ul></div>',c.proportion='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><div class="option_title pl10" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎"></a></div></div><div class="option_proportion"><div class="proportion_slider"><div class="ruler">{@each option_extra.tick_data as tick}<div class="tick" style="{@if option_extra.tick_data.length < 6}width: &{option_extra.tick_width}%;{@/if}"><div class="number">&&{tick}</div><div><i></i><i class="{@if option_extra.max_answer_num - option_extra.min_answer_num < 6 || tick == option_extra.max_answer_num}none{@/if}"></i></div></div>{@/each}</div><div class="proportion_bar"><i></i></div></div><span class="min_value">&&{option_extra.min_answer_num}</span></div></li>{@/each}',c.cloze='{@each i in range(0, cloze_content_list.length)}&&{cloze_content_list[i]}{@if i < option_id_list.length}<input class="cloze_lable" placeholder="&{i+1}" disabled oid="&{option_id_list[i]}" />{@/if}{@/each}',c.cloze_label='<input style="display: none" class="cloze_lable" placeholder="" disabled />',c.banked_cloze='{@each stem_content_obj_list as stem_content, index}<li data-index="&{index}" class="stem_content_item"><div class="stem_content_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩棰樺共"></span><div class="content_editable"><div class="pl10 stem_content" edit-type="stem_content" contenteditable="false" placeholder="鐐瑰嚮缂栬緫棰樺共" tabindex="0">{@each stem_content as obj}&&{obj.content}{@if obj.optionIndex !== null}{@if blank_style == "underscore"}<input class="banked_cloze_option underscore" oid="&{option_id_list[obj.optionIndex]}" disabled placeholder="&{obj.optionIndex + 1}" />{@else}<input class="banked_cloze_option bracket" oid="&{option_id_list[obj.optionIndex]}" disabled placeholder="銆� &{obj.optionIndex + 1} 銆�" />{@/if}{@/if}{@/each}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎" data-type="stem_content" data-index="&{index}"></a></div></div></li>{@/each}',c.stem_option='{@each stemOptions as stem_option, index}<li class="stem_option_item" oid="&{stem_option._id.$oid}"><div class="stem_option_wrap"><span class="icon_wj btn_icon btn_handle show_title" data-title="闀挎寜鎷栧姩閫夐」"></span><div class="content_editable"><span class="stem_option_order">&{index|transformNumToLetter}.</span><div class="pl10 stem_option" edit-type="extra_option" contenteditable="false" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0">&&{stem_option.title}</div></div><div class="option_operate"><a class="icon_wj btn_icon btn_option_del show_title" data-title="鍒犻櫎" data-type="extra_option" data-index="&{index}"></a></div></div></li>{@/each}',c[QUESTION_TYPE_CLASSIFICATION]='{@each option_list as option}<li class="option_item" id="option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><div class="content_editable"><div class="option_title" edit-type="option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><i class="classify_operate_icon"></i></div></li>{@/each}',c.extra_option='{@each extra_option_list as option}<li class="option_item" id="extra_option_&{option._id.$oid}" oid="&{option._id.$oid}"><div class="option_title_wrap"><div class="content_editable"><div class="option_title category_title" edit-type="extra_option" contenteditable="true" placeholder="鐐瑰嚮缂栬緫閫夐」" tabindex="0"{@if option.is_open} data-is-open="true"{@/if}>&&{option.title}</div></div><i class="classify_operate_icon"></i></div><div class="drag_area"><div>鎷栧叆姝ゅ</div></div></li>{@/each}',u.image_edit='<div oid="&{type}_&{option_id}" class="image_setting classification"><img src="&{img_address}" width="24" height="24"/> <input placeholder="&{img_name}" data-option="&{type}"  data-key="img_name" data-oid="&{option_id}" data-origin-name="&{img_name}" /></div>',u.answer_setting='{@each option_list as option_item, index}<div class="option_answer_setting">濉┖&{parseInt(index) + 1}<div class="answer_select w-select-sm w-select"><select name="answer_select" class="w-select-orgin" data-key="correct_answer" oid="&{option_item._id.$oid}"><option value="">璇烽€夋嫨绛旀</option>{@each extra_option_list as stem_option, extraIndex}<option value="&{stem_option._id.$oid}"{@if option_item.custom_attr.correct_answer === stem_option._id.$oid } selected{@/if}>&{extraIndex|transformNumToLetter}. &{stem_option.title}</option>{@/each}</select></div></div>{@/each}';var m={optionTemplate:c,emptyOptionTemplate:p,pageTemplate:'<div class="module question_page{@if one_page_one_question == "1"} split_line_or_paging_disabled{@else if pageNum==1} sort_disabled{@/if}" data-page-num="&{pageNum}">{@if pageNum!=1}<div class="page_add_btn hide"><i class="icon_wj icon_add_page"></i><span>娣诲姞鍒嗛〉</span></div>{@/if}<div class="page_bar"><div class="page_txt">椤电爜锛�<span class="page_num">&{pageNum}</span>/<span>&{totalPage}</span></div>{@if pageNum!=1}<div class="page_operate"><a class="icon_wj btn_icon btn_question_sort show_title" operate-type="sort" data-title="闀挎寜鎷栧姩鍒嗛〉"></a><a class="icon_wj btn_icon btn_page_del show_title" operate-type="del" data-title="鍒犻櫎鍒嗛〉"></a></div>{@/if}</div></div>',settingTemplate:u},v=i(26),f=i.n(v),h={init:function(t,e,i){this.dragObj=$(t).find(".type_item"),this.sortObj=$(e),this.previewContainer=$("#preview-container"),this.index=-1,this.questionSite=0,this.pageCount=0,this.paging_wz=0,this.eventEndTime=0,this.isHovering=!1,h.dragHandler(i)},dragHandler:function(t){var e=this;e.dragObj.hover(function(t){var i=this;if("off"!=globalData.globalSetting.question_preview&&!$(t.relatedTarget).hasClass("loadMack")){e.isHovering=!0;var o="https://cdn1.wenjuan.com/preview_"+$(this).attr("question-name")+"_v2.png";getImageInfo(o,3,function(t,n){var a=$(i).offset().top-$(window).scrollTop(),s=$(window).height()-n,_=Math.floor($(i).height()/2),l=e.previewContainer.find(".triangle");if(a>s){_=_+a-s+10;var d=n-parseInt(l.css("border-right-width"));_>d&&(_=d),a=s-10}l.css({top:_}),e.previewContainer.find(".preview-image").css({width:t,height:n,background:"url("+o+") no-repeat",backgroundSize:"100% 100%"}),e.isHovering&&e.previewContainer.css("top",a).show()})}},function(t){e.isHovering=!1,"on"==globalData.globalSetting.question_preview&&e.previewContainer.hide()}),e.dragObj.draggable({connectToSortable:e.sortObj,helper:"clone",appendTo:"body",start:function(t,e){var i=$(e.helper.prevObject.context),o=i.attr("question-name"),n=localStorage.getItem("new_question_dic"),a=JSON.parse(n);if(a[o]&&(a[o].showRedDot=!1),$(".question_type_dl label[question-name='"+o+"']").removeClass("showRedDot"),f.a.configs("new_question_dic",a),i.hasClass("split_line_or_paging_disabled")&&("page"==i.attr("question-type")||"split_line"==i.attr("disp-type")))return!1;if(2==p_type&&""!=project_check&&2!=i.attr("question-type")){'<div class="mask_content">闂叧妯″紡鍙敮鎸佸崟閫夐锛岃鍒犻櫎鍏跺畠棰樺瀷銆�</div>';var s=Object();return s.title="闂叧妯″紡鍙敮鎸佸崟閫夐",s.content='<a class="jsbox_close" title="鍏抽棴" href="javascript:void(0)"></a><div class="mask_content">闂叧妯″紡鍙敮鎸佸崟閫夐锛岃鍒犻櫎鍏跺畠棰樺瀷銆�</div>',s.onlyid="loginc_on",s.obj=function(){},s.obj_text="纭畾",s.close_text="鍙栨秷",s.conw="468",jsConfirm(s),$("#loginc_on .tcQz").addClass("mask_save"),$("#loginc_on .uniteC").addClass("mask_cancle"),!1}e.helper.addClass("question_dragging").css({height:"auto",width:"96px"}),Q.hide_matrix_setting_operate()},revert:"invalid"}),e.dragObj.click(function(){var i=(_=$(this)).attr("disp-type"),o=_.attr("question-name"),n=localStorage.getItem("new_question_dic"),a=JSON.parse(n);if(a[o]&&(a[o].showRedDot=!1),$(".question_type_dl label[question-name='"+o+"']").removeClass("showRedDot"),f.a.configs("new_question_dic",a),!(_=$(this)).hasClass("split_line_or_paging_disabled")||"page"!=_.attr("question-type")&&"split_line"!=_.attr("disp-type")){if(2==p_type&&""!=project_check&&2!=$(this).attr("question-type")){'<div class="mask_content">闂叧妯″紡鍙敮鎸佸崟閫夐锛岃鍒犻櫎鍏跺畠棰樺瀷銆�</div>';var s=Object();s.title="闂叧妯″紡鍙敮鎸佸崟閫夐",s.content='<a class="jsbox_close" title="鍏抽棴" href="javascript:void(0)"></a><div class="mask_content">闂叧妯″紡鍙敮鎸佸崟閫夐锛岃鍒犻櫎鍏跺畠棰樺瀷銆�</div>',s.onlyid="loginc_on",s.obj=function(){},s.obj_text="纭畾",s.close_text="鍙栨秷",s.conw="468",jsConfirm(s),$("#loginc_on .tcQz").addClass("mask_save"),$("#loginc_on .uniteC").addClass("mask_cancle")}else{var _=$(this);if((new Date).getTime()-e.eventEndTime<200)return;Q.saveLoading();i=_.attr("disp-type");var l=_.attr("question-type"),d=i||l,r=$(".question_focus"),c=$("#question_box .module");if(r[0]){var p=r.prevAll().hasClass("question_page"),u=c.index(r);if(p){var m=r.prevAll(".question_page").eq(0),v=c.index(m);e.questionFocusCurPge=m.data("page-num"),e.questionFocusIndex=u-v}else e.questionFocusIndex=u+1;e.questionFocusOid=r.attr("id")}else e.questionFocusOid=0,e.questionFocusCurPge=0,e.questionFocusIndex=0;e.getQustionSiteAndPageCount(),"page"==d&&Q.create_page(e.pageCount,e.questionSite,function(i){h.createPageSuccess(i,t,e)}),Q.create_question(d,e.questionSite,e.pageCount,function(i){h.createQuestionSuccess(i,t,e)})}"on"==globalData.globalSetting.question_preview&&(e.previewContainer.hide(),e.isHovering=!1)}}),e.sortObj.sortable({snap:!0,delay:200,opacity:.9,scrollSensitivity:160,tolerance:"pointer",items:".module:not(.sort_disabled)",handle:".btn_question_sort",cancel:".sort_disabled",placeholder:"sortable-placeholder",start:function(t,i){e.sortStartIndex=i.helper.index(),$("#edit_tool_bar").addClass("none"),Q.hide_matrix_setting_operate()},sort:function(t,e){},receive:function(t,e){2==p_type&&""!=project_check&&2!=e.item.attr("question-type")||"split_line_or_paging_disabled"==e.item.attr("split_line_or_paging_disabled")&&("page"==e.item.attr("question-type")||"split_line"==e.item.attr("disp-type"))||h.getDraggableQustionSiteAndPageCount()},stop:function(e,i){h.drag_checking(i,t)},revert:!0})},siteTotal:function(){var t=this,e=t.sortObj.find(">.module").length,i=t.sortObj.find(">.module:eq("+(e-1)+")");if(i.is(".paging")){var o=Paging_num(i);i.remove(),Q.delete_page(o)}var n=[];if(t.sortObj.find(">.module").each(function(e,i){if($(this).is(".paging")){var o=t.sortObj.find(">.module:eq("+(e+1)+")");o.is(".paging")&&n.push(o)}}),n.length>0){var a=Paging_num(n[0]);n[0].remove(),Q.delete_page(a)}Q.update_question_cid()},getDraggableQustionSiteAndPageCount:function(){var t=this;t.index=0,t.pageCount=0,t.questionSite=0,t.sortObj.children().each(function(e,i){var o=$(i);if(!o.hasClass("question_null_tip")){if(o.hasClass("ui-draggable"))return!1;t.index=e+1,o.hasClass("question_page")?(t.pageCount=parseInt(o.data("page-num"))-1,t.questionSite=0):t.questionSite++}})},getQustionSiteAndPageCount:function(){var t=this.sortObj.find(">.module").length,e=(this.sortObj.find(">.question").length,this.sortObj.find(".question_page").length);this.index=t;var i=this.questionFocusCurPge,o=this.questionFocusIndex;if(o)i?(this.questionSite=o,this.pageCount=i-1):(this.questionSite=o,this.pageCount=0);else if(0===e)this.questionSite=this.index+1,this.pageCount=0;else{this.pageCount=e-1;var n=this.sortObj.find(".question_page:last").index();this.questionSite=t-n-1}},siteLast:function(){var t=this.sortObj.find(">.module").length;if(this.sortObj.find(">.module:eq("+(t-1)+")").is(".paging")){var e=this.sortObj.find(">.module:eq("+(t-1)+")");this.sortObj.find(">.module:eq("+(t-1)+")").remove();var i=Paging_num(e);Q.delete_page(i),loadMack({off:"on",Limg:0,text:"涓や釜鍒嗛〉绗︿箣闂村繀椤绘湁鍐呭",set:2500})}},siteAdjacent:function(){var t=this,e=[];if(t.sortObj.find(">.module").each(function(i,o){if($(this).is(".paging")){var n=t.sortObj.find(">.module:eq("+(i+1)+")");n.is(".paging")&&e.push(n)}}),e.length>0){var i=Paging_num(e[0]);e[0].remove(),Q.delete_page(i),loadMack({off:"on",Limg:0,text:"涓や釜鍒嗛〉绗︿箣闂村繀椤绘湁鍐呭",set:2500})}},stopSortHandler:function(t,e){var i=this,o=t.item;if(i.sortStopIndex=t.item.index(),o.hasClass("question")){if(i.sortStartIndex==i.sortStopIndex)return void $(".loadCon,.loadMack").remove();var n=o.attr("oid");if(h.isCanSort(n,i.sortObj,i.sortStartIndex,i.sortStopIndex,o))return $(".loadCon,.loadMack").remove(),void loadMack({off:"on",Limg:0,text:"寮曠敤棰樼洰涓嶈兘绉昏嚦琚紩鐢ㄩ鐩箣鍓�",set:1500});Q.update_question_cid(),Q.save_question_order()}else if(o.hasClass("question_page")){if(i.sortStartIndex==i.sortStopIndex)return void $(".loadCon,.loadMack").remove();Q.update_page_num(),Q.save_question_order()}else{var a=o.attr("disp-type"),s=o.attr("question-type"),_=a||s;t.item.remove(),"page"==_?Q.create_page(i.pageCount,i.questionSite,function(t){h.createPageSuccess(t,e,i)}):Q.create_question(_,i.questionSite,i.pageCount,function(t){h.createQuestionSuccess(t,e,i)})}},drag_checking:function(t,e){var i=t.item,o=i.attr("oid"),n=this.sortStartIndex,a=t.item.index(),s=this.sortObj;2==project.p_type&&i.hasClass("question")?Q.operation_question_checking(o,"涓嶈兘杩涜鎷栨嫿鎿嶄綔锛�",function(o){o&&o.data&&1==o.data.can_change?h.stopSortHandler(t,e):a>n?s.find(".module:eq("+n+")").before(i[0]):a<n&&s.find(".module:eq("+n+")").after(i[0])}):h.stopSortHandler(t,e)},isCanSort:function(t,e,i,o,n){var a=!1;return void 0!==t&&Q.is_single_or_multiple(t)&&(o>i?e.find(">.module").each(function(s,_){if(s>=i&&s<o){var l=$(_).attr("oid");if(Q.is_single_or_multiple(l)&&RELATED_QUESTION_DICT[t]&&-1!=RELATED_QUESTION_DICT[t].indexOf(l))return e.find(".module:eq("+i+")").before(n[0]),a=!0,!1}}):o<i&&e.find(">.module").each(function(s,_){if(s>o&&s<=i){var l=$(_).attr("oid");if(Q.is_single_or_multiple(l)&&RELATED_QUESTION_DICT[l]&&-1!=RELATED_QUESTION_DICT[l].indexOf(t))return e.find(".module:eq("+i+")").after(n[0]),a=!0,!1}})),a},createQuestionSuccess:function(t,e,i){var o=t.page_id,n=t.question,a=n._id.$oid,s=i.sortObj.find(".module").length;Q.question_create_update(o,n,i.questionSite);var _=Q.get_question_html(n);if(Q.hide_add_question_tip(i.sortObj),0==i.index)$(_).prependTo(i.sortObj);else if(i.index==s){var l=i.questionFocusOid;l?$(_).insertAfter("#"+l):$(_).appendTo(i.sortObj)}else $(i.sortObj.find(".module:eq("+i.index+")")).before(_);e.initQuestionEvent(a),Q.update_question_cid(),$("html,body").animate({scrollTop:$("#question_"+a).offset().top-80},"slow"),$("#question_"+a).find(".q_title").length&&($("#question_"+a).find(".q_title").attr({contenteditable:!0}).focus(),document.execCommand("selectAll",!1,null)),$(".loadCon,.loadMack").remove(),i.eventEndTime=(new Date).getTime()},createPageSuccess:function(t,e,i){var o=i.sortObj.find(".module").length;Q.hide_add_question_tip(Q.$questionBox);var n=Q.$questionBox.find(".question_page").length,a=juicer(m.pageTemplate,{pageNum:i.pageCount,totalPage:n+1});if(0==i.index)$(a).prependTo(i.sortObj);else if(i.index==o){var s=i.questionFocusOid;s?$(a).insertAfter("#"+s):$(a).appendTo(i.sortObj)}else $(i.sortObj.find(".module:eq("+i.index+")")).before(a);if(0===n){var _=juicer(m.pageTemplate,{pageNum:1,totalPage:2});Q.$questionBox.prepend(_)}Q.update_page_num()}},q=h,g={initImageUpload:function(t,e,i,o){return this.m=0,this.totalImgNum=0,this.initUpload=function(i,n){var a=this;"update"==n&&(a.optionId=i.attr("oid"));var s=this.getUploadSetting(n,e);i.dmUploader({url:s.uploadUrl,dataType:"json",allowedTypes:"image/jpg|png|jpeg|bmp",extraData:s.extraData,maxFileSize:5242880,extFilter:"jpg;png;jpeg;bmp",onInit:function(){},onBeforeUpload:function(t){},onNewFile:function(t,i){loadMack({off:"on",Limg:1,text:"鍔犺浇涓�...",set:0}),a.totalImgNum++,$.danidemo.addFile("#demo-files",t,i),a.addImgUploadHtml(e,t,n)},onComplete:function(){},onUploadProgress:function(t,i){var o=i+"%";"create"==n?$("#"+e+"_"+t).find(".upload_loading .bar").width(o):$("#option_"+a.optionId).find(".upload_loading .bar").width(o)},onUploadSuccess:function(t,i){if("200"==i.status){var s=$("#question_"+e),_=Q.get_question(e),l="create"==n?s.find(".option_item#"+e+"_"+t):$("#option_"+a.optionId),d=i.option_struct,r=a.getOptionHtml(_,d);l.after(r).remove();var c=get_oid(d);if(_.hasOwnProperty("option_list"))if(a.optionId&&-1!=_.option_id_list.indexOf(a.optionId)){var p=_.option_id_list.indexOf(a.optionId);_.option_list.splice(p,1,d)}else _.option_list.push(d),_.option_id_list.push(c);else _.option_list=[d],_.option_id_list=[c];a.totalImgNum--,0==a.totalImgNum&&(o&&o(e),$(".loadCon,.loadMack").remove())}},onUploadError:function(t){var i=$("#"+e+"_"+t);i.find(".progress_bar").html('<span class="text_red">涓婁紶澶辫触</span>'),setTimeout(function(){i.remove()},3e3)},onFileTypeError:function(t){alert(t.name+" 璇ュ浘鐗囨牸寮忔湁璇�, 浠呭厑璁竕pg, png, jpeg, bmp鐨勬牸寮忔枃浠�")},onFileSizeError:function(t){alert(t.name+" 璇ュ浘鐗囧お澶�,鍗曞紶涓嶈兘瓒呰繃5M")},onFileExtError:function(t){$.danidemo.addLog("#demo-debug","error","File '"+t.name+"' has a Not Allowed Extension")},onFallbackMode:function(e){t.find(".option_add_con").hide(),t.find(".option_add_con_ie").show()}})},this.getUploadSetting=function(t,e){var i={};return"create"==t?(i.uploadUrl="/edit/form/ajax/create_image_option/"+get_oid(project)+"/",i.extraData={qid:e,_xsrf:$.cookie("_xsrf")||""}):"update"==t&&(i.uploadUrl="/edit/form/ajax/update_image_option/"+get_oid(project)+"/",i.extraData={option_id:this.optionId,_xsrf:$.cookie("_xsrf")||""}),i},this.addImgUploadHtml=function(t,e,i){var o=$("#question_"+t);if("create"==i){var n='<li class="option_item option_item_upload" id="'+t+"_"+e+'"><div class="upload_loading" name=""><div class="progress_bar"><span class="bar"></span></div><p class="progress_info">鍥剧墖涓婁紶涓�</p></div></li>';$(".option_add",o).before(n)}else n='<div class="upload_loading" name=""><div class="progress_bar"><span class="bar"></span></div><p class="progress_info">鍥剧墖鏇存崲涓�</p></div>',$("#option_"+this.optionId).addClass("option_item_upload").html(n)},this.getOptionHtml=function(t,e){var i=t.custom_attr.disp_type||t.question_type,o=m.optionTemplate[i];return juicer(o,{option_list:[e]})},this.initUpload(t,i)},initImageJcrop:function(t,e,i,o,n,a){return this.initJcrop=function(){this.coordinate={x:i[0],y:i[1],x2:i[2],y2:i[3]};var n=(new Date).getTime(),s=o;o>400&&(s=400),jsCropConfirm({title:"鍥剧墖瑁佸壀",content:'<div class="question_img_jcrop"><img class="img_jcrop" width="'+s+'" src="'+t+'" id="img_jcrop_'+n+'" alt="鍥剧墖鍔犺浇閿欒" /></div>',obj:this.saveCutOut,conw:440,obj_text:"淇濆瓨",Param:"img_jcrop_"+n,close_text:"鏇存崲",close_Param:e,close_obj:a,notClose:!0}),this.initJcropData("#img_jcrop_"+n)},this.initJcropData=function(t){return $(t).Jcrop({onSelect:this.showCoords,minSize:[75,75]},function(){this.animateTo(i),this.setOptions({aspectRatio:1})}),!1},this.showCoords=function(t){this.coordinate=t,t.x,t.y,t.x2,t.y2,this.ui.holder.parent().find(".img_jcrop").attr({bbox:"["+t.x+","+t.y+","+t.x2+","+t.y2+"]"})},this.saveCutOut=function(){var t=$("#"+this.Param).attr("bbox"),o=t?t.parseJSON():i;if(o.toString()===[75,75,150,150].toString()||o.toString()!=i.toString()){var a={option_id:e,bbox:toJSONString(o)},s=$("#option_"+e);s.find(".option_img_box,.option_title_wrap").hide(),s.addClass("option_item_upload").find(".option_img_box").before('<div class="upload_loading" name=""><div class="progress_bar"><span></span></div><p class="progress_info">鍥剧墖淇濆瓨涓�</p></div>'),loadMack({off:"on",Limg:1,text:"鍔犺浇涓�...",set:0}),ajaxPost("/edit/form/ajax/upload_cut_image/"+get_oid(project),a,function(t){$(".loadCon,.loadMack").remove(),n(t.thumb_url,e,t.bbox),SavePrompt(!1,"淇濆瓨鎴愬姛"),SavePrompt(!0,"淇濆瓨鎴愬姛")})}},this.changeImg=function(){$("#option_"+e+' input[type="file"]').trigger("click")},this.initJcrop()}},w=i(12);function b(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,o;return e=t,o=[{key:"showSelect",value:function(){Selector(".qcloze-select-pop")}},{key:"initEvent",value:function(e,i,o){this.data={},sessionStorage.colzeFirstInit="1",e.on({click:function(){for(var e=i||$("#setting_main_wrap").attr("qid"),o=QUESTION_DICT[e],n=0;n<o.option_list.length;n++){var a=o.option_list[n].custom_attr.cloze_option_content,s=$.trim(a).split(/[;锛沒/g);o.option_list[n].custom_attr.cloze_option_answer_list=s}var _=o.project_id;o.custom_attr.horz_blank_content=$('div[edit-type="cloze_content"]',$('div[qid="'.concat(e,'"]'))).html();var l=$("#q_cloze_blank_attr_popup").html(),d=juicer(l,o),r=new Popup({head:{inner:"閫夐」涓庡垎鍊�"},content:{inner:d,class:"blank-attr-popup popup-cloze"},btnLeft:{inner:"鍙栨秷",class:"btn-cancel btn-cancel-bottom",onClick:function(t){sessionStorage.colzeFirstInit="1",r.destroy(),r=null}},remind:"澶囨敞: 閫夐」鐢扁€滄枃瀛�+鍒嗗彿鈥濆舰寮忕粍鎴�,濡傗€渉i;鈥濓紝鏈€澶ф敮鎸�10涓€夐」锛涙枃瀛楁暟閲忔渶澶�200瀛�",isFixed:!1,wrapClass:"selects-wrapper cloze-wrapper",btnAlign:"right",showMask:!0,maskClickClose:!0,showCloseBtn:!0,noScroll:!1,btnRight:{inner:"纭畾",class:"popup_btn_item popup_btn_right",onClick:function(){1===t.checkInput()&&(sessionStorage.colzeFirstInit="1",r.destroy(),r=null)}},destroyOnClose:!0});r.show(),t.showSelect(),t.contentEvent(_,e,o),t.answerEvent(_,e),"same"!=o.custom_attr.cloze_score_rule&&(t.scoreEvent(_,e),t.scoreAdd()),t.hideOption()}},o)}},{key:"hideOption",value:function(){$(".setting-wrap").scroll(function(){$(".w-select-options-wrapper").hide()})}},{key:"answerEvent",value:function(e,i){var o,n,a;$('select[name="qclozeAnswer"]').on("blur",function(){o=$(this),n=o.val(),a=o.data("id"),t.showLabel(a,1),n&&t.queryParam(e,n,"".concat(a),"cloze_option_answer",function(){t.saveOption(i,n,a,"answer")},o,1)}).on("focus",function(){(o=$(this)).removeClass("orange-label"),a=o.data("id"),t.showLabel(a)})}},{key:"scoreEvent",value:function(e,i){var o,n,a;$(".w-input-sam").on("blur",function(){(o=$(this)).removeClass("focus_border"),n=o.val(),a=o.data("id"),t.showLabel(a,1),n&&(Q.checkClozeScore($(this),"",!1,"","",!1),t.saveOption(i,n,a,"score"),Q.updateClozeScore(i),t.queryParam(e,n,"".concat(a),"cloze_option_score",function(){},o))}).on("focus",function(){(o=$(this)).removeClass("orange-label"),a=o.data("id"),t.showLabel(a)}).on("input",function(){var t=$(this).val();0!=parseInt(t)&&$(this).parent().find(".w-icon-arrow-down").removeClass("w-icon-arrow-disabled"),100==parseInt(t)?($(this).parent().find(".w-icon-arrow-up").addClass("w-icon-arrow-disabled"),$(this).parent().find(".w-icon-arrow-down").removeClass("w-icon-arrow-disabled")):$(this).parent().find(".w-icon-arrow-up").removeClass("w-icon-arrow-disabled"),Q.checkClozeScore($(this),"",!0,"","",!1)})}},{key:"htmlEscape",value:function(t){return t.replace(/[<>"&']/g,function(t,e,i){switch(t){case"<":case"'":case">":case"&":case'"':return""}})}},{key:"contentEvent",value:function(e,i,o){for(var n,a,s,_=0;_<o.option_list.length;_++)$(".w-select-qloze-".concat(_)).on("blur",function(){if(r=$(this),a=r.val(),s=r.data("id"),t.showLabel(s,1),a){if("1"===sessionStorage.colzeFirstInit&&a===r.data("first"))return!1;sessionStorage.colzeFirstInit=0,a=t.htmlEscape(a);for(var o=$.trim(a).split(/[;锛沒/g),n=$.trim(a).match(/[;锛沒/g),_=0,l=0;l<o.length;l++)$.trim(o[l])||_++;if(n&&n.length>=10)return t.showTooltips(r,"鏈€澶氭敮鎸�10涓€夐」","maxover"),!1;if(_===o.length)return t.showTooltips(r,"璇疯缃€夐」鍐呭"),!1;var d='<option value="">璇烽€夋嫨</option>';for(l=0;l<o.length;l++)$.trim(o[l])&&(d+='<option value="'.concat(o[l],'">').concat(o[l],"</option>"));return(r=$('select[data-id="'.concat(s,'"]'))).empty().append(d),r.next().remove(),Selector(r.parent()),t.saveOption(i,a,s,"content"),t.queryParam(e,a,s,"cloze_option_content",function(){},r),!1}sessionStorage.colzeFirstInit=0;var r;d='<option value="">璇烽€夋嫨</option>';(r=$('select[data-id="'.concat(s,'"]'))).empty().append(d),r.next().remove(),Selector(r.parent())}).on("focus",function(e){$(".tooltips-over").remove(),(n=$(this)).removeClass("orange-label"),s=n.data("id"),t.showLabel(s)}).on("input",function(){var e=$(this),i=e.val(),o=$.trim(i).match(/[;锛沒/g);if(o&&o.length>=10){var n=$.trim(i).split(/[;锛沒/g);n=n.slice(0,10).join(";"),e.val(n),t.showTooltips(e,"鏈€澶氭敮鎸�10涓€夐」","maxover")}}).on("mouseover",function(e){var i=$(this),o=e.target.offsetWidth;e.target.scrollWidth>o&&t.showTooltips(i,i.val(),"over",4e3)}).on("mouseout",function(){$(".tooltips-over").remove()})}},{key:"showLabel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=$("input[oid=".concat(t,"]"),".qcloze-pop-content");0===e?i.addClass("active-label"):i.removeClass("active-label")}},{key:"saveOption",value:function(t,e,i,o){for(var n=Q.get_question(t),a=0;a<n.option_list.length;a++)i===n.option_list[a]._id.$oid&&("content"===o?n.option_list[a].custom_attr.cloze_option_content=e:"score"===o?n.option_list[a].custom_attr.cloze_option_score=e:n.option_list[a].custom_attr.cloze_option_answer=e)}},{key:"queryParam",value:function(e,i,o,n,a,s){var _=[e,o,n,i];if(0===(arguments.length>6&&void 0!==arguments[6]?arguments[6]:0)){if(!t.data[o]&&i)return s.removeClass("orange-label"),t.data[o]=i,t.firstInit=!1,t.ajaxApi(_,a),!1;if(i===t.data[o])return s.removeClass("orange-label"),!1;if(i)return s.removeClass("orange-label"),t.data[o]=i,t.ajaxApi(_,a),!1}else i&&(s.removeClass("orange-label"),t.ajaxApi(_,a))}},{key:"ajaxApi",value:function(t,e){var i={project_id:t[0],option_id:t[1],attr_key:t[2],attr_value:t[3]};Q.ajaxPost("/edit/ajax_option_set/",i,e)}},{key:"showTooltips",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"content",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;t.css({borderColor:"#FF6D56"});var n=0,a=t.data("id"),s=$("input[oid='".concat(a,"']"),".qcloze-pop-content");if(s.addClass("orange-label"),"over"==i){s.removeClass("orange-label"),t.css({borderColor:""}),clearTimeout(n),$(".tooltips-over").remove();var _=t.offset().top,l=t.offset().left+"px",d='<div class="tooltips-over" style=\'top:'.concat(_,";right:26px;left:").concat(l,';display:none;\'><div class="arrow arrow-border-over"></div><div class="arrow arrow-bg-over"></div><div style="overflow-wrap: break-word;">').concat(e,"</div></div>");$("body").append(d),_=_-$(".tooltips-over").height()-5,$(".tooltips-over").css({top:"".concat(_,"px")}).show()}else if("maxover"==i){_=t.offset().top,l=t.offset().left+"px",d='<div class="tooltips" style=\'top:'.concat(_,";right:26px;left:41%;display:none;'><div>").concat(e,'</div><div class="arrow arrow-border"></div><div class="arrow arrow-bg"></div> </div>');$("body").append(d),_=_-$(".tooltips-over").height()-35,$(".tooltips").css({top:"".concat(_,"px")}).show()}else t.next().find(".w-select-input").css({borderColor:"#FF6D56",color:"#FF6D56"});n=setTimeout(function(){s.removeClass("orange-label"),"answer"===i?t.next().find(".w-select-input").css({borderColor:"",color:""}):"over"===i||(t.css({borderColor:""}),$(".tooltips").remove())},o)}},{key:"scoreAdd",value:function(){$(".q_cloze_blank_attr_popup .w-icon").on("click",function(){var t=$(this),e=t.parents(".cloze_input"),i=t.siblings(".w-input").first();i.focus();var o=parseFloat(i.val()),n=e.find(".w-icon-arrow-up"),a=e.find(".w-icon-arrow-down"),s=0;if(t.hasClass("w-icon-arrow-up"))100===(s=o+.5)&&n.addClass("w-icon-arrow-disabled"),a.removeClass("w-icon-arrow-disabled");else{if(0===o)return!1;0===(s=o-.5)&&a.addClass("w-icon-arrow-disabled"),n.removeClass("w-icon-arrow-disabled")}i.addClass("focus_border"),i.val(s)})}},{key:"checkInput",value:function(){var e=1,i=$(".setting-wrap");return i.find(".qcloze-input").each(function(i,o){var n=$(this);n.val()||(e=0,t.showTooltips(n,"璇疯缃€夐」鍐呭"));for(var a=$.trim(n.val()).split(/[;锛沒/g),s=0,_=0;_<a.length;_++)$.trim(a[_])||s++;s===a.length&&(e=0,t.showTooltips(n,"璇疯缃€夐」鍐呭"));var l=$.trim(n.val()).match(/[;锛沒/g);l&&l.length>=10&&(e=0,t.showTooltips(n,"鏈€澶氭敮鎸�10涓€夐」","maxover",600))}),i.find(".w-input-sam").each(function(){var i=$(this);i.val()||(e=0,t.showTooltips(i,"璇疯缃垎鍊�","score"))}),i.find('select[name="qclozeAnswer"]').each(function(i,o){var n=$(this);n.val()||(e=0,t.showTooltips(n,"璇疯缃瓟妗�","answer"))}),e}}],(i=null)&&b(e.prototype,i),o&&b(e,o),t}(),x=i(11);window.qoute_title=null;var T={};function j(t,e,i){errTooltip.show(t.currentTarget,{inner:i,direction:"top",customOffset:{direction:["top","left"],value:[3,10]}}),$(errTooltip.noder).addClass("err_tips"),e.parents(".custom_input").addClass("focus_border"),setTimeout(function(){errTooltip.hidden(),e.parents(".custom_input").removeClass("focus_border")},1500)}window.errTooltip=new GuideText({maxWidth:260,classes:"err_tips"}),T.initQuestionEditableEvent=function(t,e){navigator.userAgent.indexOf("Firefox")>-1?t.find('.option_title[contenteditable="true"]').attr("contenteditable",!1):t.find('div[contenteditable="true"]').attr("contenteditable",!1),t.on({click:function(t){var e=$(this);e.attr("contenteditable",!0),Q.setFocus(e)}},'div[contenteditable="false"]'),t.on({focus:function(t){var i=$(this);window.edit_obj=i;var o=i.attr("edit-type"),n=i.parents(".content_editable"),a=i.parents(".question");if($(".editable_focus").removeClass("editable_focus"),n.addClass("editable_focus"),a.hasClass("question_focus")||a.addClass("question_focus").siblings(".question_focus").removeClass("question_focus"),"option"==o||"extra_option"==o)i.parents(".option_item").addClass("option_focus");else if("row"==o||"col"==o){var s=i.parents(".option_item").attr("oid");$("#edit_tool_bar").attr("row_qid",s)}else if("question"==o){var _=$("#setting_main_wrap"),l=a.find(".q_seq").text();Q.is_show_question_or_option_setting(e,"","question")&&Q.show_question_setting(_,e,l)}qoute_title=i.html(),"extra_option"===o&&i.hasClass("stem_option")?$("#edit_tool_bar").addClass("none"):Q.show_toolbar(i,e,o,qoute_title),i.children(".evaluation_score,.option_score,.right_key").addClass("hide"),Q.input_on_focus(i,e),Q.horizontal_blank_handler("focus",i)},blur:function(i){Q.isShowColumnHandler(this,e),Q.horizontal_blank_handler("blur",$(this)),Q.save_question_content_editable_handler(t,e,$(this),T),$(this).children(".evaluation_score,.option_score,.right_key").removeClass("hide")},paste:function(t){t.preventDefault(),Q.pasteFun(t)},input:function(t){Q.setUploadImgStatus(e,$(this).html())}},'div[contenteditable="true"]'),t.on({click:function(){$(this).parents(".cloze_lable").remove(),Q.deleteCloze(e)}},".cloze_question_content[contenteditable=true] .icon_cloze_delete"),t.on({keydown:function(t){13===t.keyCode&&(t.preventDefault(),Q.insertHtmlBeforeCursor("<br>"))},keyup:function(t){var i=$(this),o=Q.get_question(e).option_id_list;if(i.hasClass("cloze_question_content")){var n=Q.getClozeOptions(e);o.length!==n.length&&Q.deleteCloze(e)}else{var a=Q.getBankedClozeOption(e);if(o.length!==a.length){var s=i.parents("li").data("index");Q.deleteBankedClozeOption(e,function(){$("#question_".concat(e," .stem_content_item[data-index=").concat(s,"] .stem_content")).click()})}}}},".cloze_question_content[contenteditable=true], .stem_content[contenteditable=true]")},T.initQestionOperateEvent=function(t,e){t.on({click:function(t){var i=$(this),o=i.attr("operate-type"),n=i.parents("#question_"+e).attr("question-type");switch(o){case"del":2==p_type&&70!=n?Q.operation_question_checking(e,"涓嶈兘鍒犻櫎姝ら锛�",function(t){t&&t.data&&1==t.data.can_change&&Q.question_operate_del(e)}):Q.question_operate_del(e);break;case"logic":2==p_type?""!=project_check?public_pop_logic():Q.question_setting_checking("閫昏緫璁剧疆",function(t){t&&t.data&&1==t.data.can_setting&&Q.logic_setting(e)}):Q.logic_setting(e);break;case"clone":Q.question_operate_clone(e,T);break;case"add_row":Q.add_single_option(e);break;case"add_other_row":Q.add_single_option(e,!0);break;case"add_more_row":Q.add_many_options(i,e,"row");break;case"add_matrix_row":Q.add_single_row(e);break;case"add_col":Q.add_single_option(e);break;case"add_more_col":Q.add_many_options(i,e,"col");break;case"edit_cascader_data":Q.edit_cascader_data(e,T);break;case"edit_cascader_import":Q.edit_cascader_import(e,T);break;case"add_stem":Q.createStem(e);break;case"add_single_stem_option":Q.createSingleStemOption(e);break;case"add_more_stem_option":Q.add_many_options(i,e,"extra_option");break;case"add_category":Q.addSingleCategory(e);break;case"add_multi_category":Q.addMultiCategory(i,e,"extra_option")}}},".q_operate .btn_icon,.q_option_operate .btn_text_icon,.q_matrix_option_vertical .btn_text_icon")},T.initOptionOperateEvent=function(t,e){t.on({click:function(t){var e=$(this),i=e.parents(".option_item"),o=e.parents(".question"),n=o.attr("oid"),a=i.attr("oid"),s=$("#setting_main_wrap"),_=o.find(".q_seq").text(),l=i.index()+1;"horz_blank"==o.attr("disp_type")?(Q.show_blank_attr_popup(n),Q.is_show_question_or_option_setting(n,"","question")&&Q.show_question_setting(s,n,_)):Q.is_show_question_or_option_setting(n,a,"option")&&Q.show_option_setting(s,n,_,a,l)}},".option_operate .btn_option_setting"),t.on({click:function(t){t.stopPropagation();var e=$(this),i=e.parents(".question"),o=i.attr("oid"),n=e.data("type"),a=e.data("index");switch(n){case"stem_content":$("#edit_tool_bar").addClass("none"),Q.deleteStem(o,a);break;case"extra_option":$("#edit_tool_bar").addClass("none");var s=e.parents(".stem_option_item").attr("oid");Q.deleteExtraOption(o,s,function(){Q.updateStemOption(o)});break;default:var _=e.parents(".option_item"),l=_.attr("oid");if(/^new_\d+$/.test(l)&&"new"==_.attr("id"))_.remove(),$("#edit_tool_bar").addClass("none");else{var d=Q.get_question(o);if(d.question_type==QUESTION_TYPE_SCORE&&"proportion"==d.custom_attr.disp_type){var r=Q.checkChangeOptionNum(o,d.option_list.length-1);if(!r.isSuccess)return void($(".toast_box").length<=0&&Toast({message:r.errMsg,maxWidth:500}))}$.when(Q.delete_option(o,l,!0)).done(function(){var t=Q.get_question(o);t.question_type!==QUESTION_TYPE_SCORE||t.custom_attr.disp_type||1!==t.option_list.length||i.find(".q_option_ul  li.option_item:first-child>.option_title_wrap").addClass("none"),Q.check_update_option_select(o),Q.update_question_html(o,T),2==project.p_type&&(Q.question_answer_score_template(o),Q.calculation_project_total_score()),$("#question_"+o).trigger("click")})}}}},".option_operate .btn_option_del"),t.on({change:function(t){var i=$(this),o=i.val(),n=i.find("option:selected").text(),a=Number.parseInt(i.attr("data-cascader-index")||0),s=Number.parseInt(i.attr("data-cascader-end-index")||4),l=i.attr("data-cascader-selector"),d=i.attr("data-cascader-first-text");n=(o="0"===o?"":o)?n:"",i.attr("data-cascader-select-index",o).attr("data-cascader-select-value",n);var r,c,p=0,u="",m=null,v=[],f=null,h="",q="",g=!0;if(a<s){p=a+1,u="[data-cascader-selector="+l+"]",v=!!o&&o.split("-");var w=Q.get_question(e),b={children:_.cloneDeep(w.custom_attr.option_data||[])};for(f=v?Q.accessTreeDataByIndex(v,b,!0):{};p<=s;){if(d=(m=$(u+"[data-cascader-index="+p+"]")).attr("data-cascader-first-text"),m&&m.find("option:not([value=0])").remove(),(!f.children||f.children.length<=0)&&(g=!1),m.find("option[value=0]").text(g||!o?d:"--"),p==a+1&&f&&f.children){h="";for(var y=0,x=f.children.length;y<x;y++)q=f.index.join("-")+"-"+(y+1),h+=(r=q,c=f.children[y].title,"<option value="+r+">"+c+"</option>");m.append(h)}p++}}}},".cascader_item"),t.on({click:function(){var t=$(this),i=t.parents("li").attr("oid"),o=t.parents("ul"),n=i==o.find("li:first-child").attr("oid")?"disabled_move":"",a=i==o.find("li:last-child").attr("oid")?"disabled_move":"",s="";t.closest(".question.classification").find(".classify_operate_icon").removeClass("focused_operate"),t.addClass("focused_operate"),$(".option_operation_wrap").remove(),setTimeout(function(){s=t.closest(".q_category_list").length>0?'<div name="extra_option" class="option_operation_wrap" optionId="'.concat(i,'" style="top: ').concat(t.offset().top+18,"px; left: ").concat(t.offset().left,'px;"><ul class="option_list"><li type="move_up" class="').concat(n,'">涓婄Щ鍒嗙被</li><li type="move_down" class="').concat(a,'">涓嬬Щ鍒嗙被</li><li type="delete">鍒犻櫎</li></ul></div>'):'<div name="option" class="option_operation_wrap" optionId="'.concat(i,'" style="top: ').concat(t.offset().top+18,"px; left: ").concat(t.offset().left,'px;"><ul class="option_list"><li type="move_up" class="').concat(n,'">涓婄Щ閫夐」</li><li type="move_down" class="').concat(a,'">涓嬬Щ閫夐」</li><li type="delete">鍒犻櫎</li></ul></div>'),$("body").append(s),$(".option_operation_wrap[optionId="+i+"] li").click(function(){var t=$(this).parents(".option_operation_wrap").attr("name"),o=$(this).attr("type");Q.classificationOptionOperate(e,i,t,o)})})}},".classify_operate_icon")},T.initSettingMainEvent=function(){var t=$("#setting_main_wrap");t.on("click",function(t){t.stopPropagation();var e=$(t.target);Q.hide_matrix_setting_operate(e),$("#edit_tool_bar").addClass("none"),$(".editable_focus").removeClass("editable_focus")}),t.on({click:function(e){var i=t.attr("qid"),o=$("#question_"+i).find(".q_seq").text(),n=$("#setting_main_wrap");Q.show_blank_attr_popup(i),Q.is_show_question_or_option_setting(i,"","question")&&Q.show_question_setting(n,i,o)}},".btn_option_setting"),t.on({click:function(e){var i=t.attr("qid");2==p_type?""!=project_check?public_pop_logic():Q.question_setting_checking("閫昏緫璁剧疆",function(t){t&&t.data&&1==t.data.can_setting&&Q.logic_setting(i)}):Q.logic_setting(i)}},".btn_setting_logic"),t.on({click:function(e){var i=t.attr("qid");2==p_type?Q.question_setting_checking("閫夐」鍏宠仈",function(t){t&&t.data&&1==t.data.can_setting&&Q.option_setting(i)}):Q.option_setting(i)}},".btn_setting_related"),t.on({click:function(){var e=$(this),i=e.attr("data-key"),o=e.attr("data-value"),n=t.attr("qid"),a=t.attr("option-id"),s=Q.get_check_label_status(n,i,o),_=Q.format_data_to_obj(n,i,s),d=$("#question_"+n);switch(e.toggleClass("checked"),e.attr({"data-value":"none"==s?"":s}),"true"===e.attr("collapse")&&e.closest(".collapse_box").toggleClass("expand"),i){case"allow_null":if(a)Q.save_option_setting(a,i,s);else{if(l(y=Q.get_question(n))&&"none"==s)e.closest(".setting_item").find('.btn_switch[data-key="one_label_limit"]').removeClass("checked");Q.save_question_setting(_)}break;case"is_open":Q.show_or_remove_open_input(n,a,s),Q.save_option_setting(a,i,s);break;case"desc":d.find(".q_desc_wrap").toggleClass("none"),"none"==s&&(d.find(".q_desc_wrap .q_desc").html(""),Q.save_question_setting(_));break;case"op_random":if("none"==s)e.closest(".setting_item").find('.btn_switch[data-key="last_op_fixed"]').removeClass("checked");Q.save_question_setting(_);break;case"sms_auth":var r=(y=$("#question_"+n)).find(".q_option_list .verification_code");"none"==s?r.hide():r.show(),Q.save_question_setting(_);break;case"answer_score":o="off"==o?"on":"none",_=Q.format_data_to_obj(n,i,o);Q.save_question_setting(_,function(){e.hasClass("checked")?$("#question_"+n).removeClass("hide_score"):$("#question_"+n).addClass("hide_score"),2==project.p_type&&Q.calculation_project_total_score()});break;case"voice_input":o="on"==o?"off":"on",_={proj_id:project_id,voice_input:o},Q.save_project_setting(_,function(){Toast.hidden(),$(".survey_main").toggleClass("use_input_vr"),project.custom_attr.voice_input=o});break;case"limit_total":o="true"!=o;var c=$("#question_"+n).find(".proportion_sum"),p=(y=Q.get_question(n)).custom_attr,u=parseInt(p.min_answer_num),m=parseInt(p.max_answer_num);if(o)if(u*y.option_list.length<=m){var v=Q.format_data_to_obj(n,i,JSON.stringify({limit_total:o,total_value:m}));Q.save_question_setting(v,function(){e.attr("data-value",o),c.find(".total_value").text(m),c.show(),$("#question_setting").find(".total_value_item").show().find("input").val(m)})}else e.removeClass("checked").attr("data-value",!1),$(".toast_box").length<=0&&Toast({message:"鍚勯」鏈€灏忓€间箣鍜屽ぇ浜庢渶澶у€硷紝鏆備笉鍙紑鍚�",maxWidth:500});else{v=Q.format_data_to_obj(n,i,JSON.stringify({limit_total:o,min_answer_num:0,max_answer_num:100}));Q.save_question_setting(v,function(){c.hide();var t=$("#question_setting");t.find(".total_value_item").hide(),e.attr("data-value",o),t.find("input.min_answer_num").val(0),t.find("input.max_answer_num").val(100),Q.updateProportionSlider(n)})}break;case"limit_max_min":var f="on"==o?"off":"on",h=(d=$("#question_setting"),(y=Q.get_question(n)).custom_attr.limit_total),q=y.custom_attr.total_value,g=h?q:100;v=Q.format_data_to_obj(n,i,JSON.stringify({limit_max_min:f,min_answer_num:0,max_answer_num:g}));Q.save_question_setting(v,function(){e.closest(".setting_proportion").toggleClass("limit_max_min");var t=$("#question_setting");t.find("input.min_answer_num").val(0),t.find("input.max_answer_num").val(g),Q.updateProportionSlider(n)});break;case"open_eval":Q.save_question_setting(_,function(){"on"==o?d.find(".write-evaluation").hide():d.find(".write-evaluation").show()});break;case"one_label_limit":var w=!1,b=[];if("on"!=o){n=t.attr("qid");var y,x=(y=QUESTION_DICT[n]).option_list[1].custom_attr.label_data;for(var j in x)console.log(x[j].label_list),x[j].label_list&&0!=x[j].label_list.length&&x[j].label_list[0]||(w=!0,b.push(j))}if(w)e.removeClass("checked"),e.attr("data-value",o),Toast.hidden(),Toast({message:"鏃犳硶璁剧疆锛屽垎鍊�"+b.join("銆�")+"灏氭湭娣诲姞鏍囩",maxWidth:350});else{o="on"==o?"none":"on";_=Q.format_data_to_obj(n,i,o);Q.save_question_setting(_)}break;case"options_title_switch":o="off"==o||""==o?"on":"off",_=Q.format_data_to_obj(n,i,o);Q.save_question_setting(_,function(){Q.update_question_html(n,T),$("#question_"+n).addClass("question_focus"),e.hasClass("checked")?(e.closest(".option-titles-setting").addClass("checked"),$("#setting_main_wrap .option-titles-wrapper").show()):(e.closest(".option-titles-setting").removeClass("checked"),$("#setting_main_wrap .option-titles-wrapper").hide())});break;default:a?Q.save_option_setting(a,i,s):Q.save_question_setting(_)}}},".btn_switch"),t.on({change:function(){var e=$(this),i=e.attr("data-key"),o=e.val(),n=(t.attr("qid"),t.attr("option-id"));switch(i){case"":break;default:Q.save_option_setting(n,i,o)}},click:function(t){t.stopPropagation()}},"#option_setting .select_selection"),t.on({blur:function(e){e.stopPropagation();var i=$(this),o=i.attr("data-key"),n=i.val(),a=(t.attr("qid"),t.attr("option-id"));if(/^[1-9]\d*$/.test(n))switch(o){case"char_count":Q.save_option_setting(a,o,n)}else Q.save_option_setting(a,o,"none")}},"#option_setting input.q_input[type=number], #option_setting input.q_input[type=text]"),t.on({change:function(){var e=$(this),i=e.parent(),o=i.attr("data-key"),n=i.attr("data-value"),a=t.attr("qid");e.prop("checked")?i.addClass("checked"):i.removeClass("checked");var s=Q.get_check_label_status(a,o,n),_=Q.format_data_to_obj(a,o,s);switch("none"==s?i.attr({"data-value":""}):i.attr({"data-value":s}),o){case"desc":t.find(".q_desc_wrap").toggleClass("none"),"none"==s&&(t.find(".q_desc_wrap .q_desc").html(""),Q.save_question_setting(_));break;case"sms_auth":t.find(".verification_code").toggleClass("none"),Q.save_question_setting(_);break;default:Q.save_question_setting(_)}}},".label_checkbox>input[type=checkbox]"),t.on({click:function(){var e=$(this),i=e.attr("data-key"),o=e.attr("data-value"),n=e.attr("data-row"),a=t.attr("qid"),s=Q.get_question(a),_=Q.format_data_to_obj(a,i,o),l=$("#question_"+a),d=Q.question_default_text_dic,r=s.question_type,c=s.custom_attr.disp_type?s.custom_attr.disp_type:"";if("answer"!=i){if("disabled_video"==e.attr("status"))return;if(e.hasClass("checked"))return}switch(e.addClass("checked").siblings().removeClass("checked"),i){case"change_qtype":t.find(".setting_select_range,.single_select,.multiple_select").toggleClass("hide"),Q.save_question_setting(_,function(){if(-1!=o.indexOf("multiple")&&Q.check_update_option_select(a),r!=QUESTION_TYPE_SINGLE&&r!=QUESTION_TYPE_MULTIPLE||c&&"dropdown"!=c&&"multiple_dropdown"!=c)Q.updateQuestionHtml(s,a,i,o,T);else{var t=d[Q.get_question_only_type(r,c)].title;if(s.title==t){r=r==QUESTION_TYPE_SINGLE?QUESTION_TYPE_MULTIPLE:QUESTION_TYPE_SINGLE,"dropdown"==c?c="multiple_dropdown":"multiple_dropdown"==c&&(c="dropdown");var e=d[Q.get_question_only_type(r,c)].title;Q.initialTitleSwitching(e,a,function(){Q.updateQuestionHtml(s,a,i,o,T)})}else Q.updateQuestionHtml(s,a,i,o,T)}});break;case"option_display":if(-1!=o.indexOf(",")){var p=o.split(",");o={layout:p[0],column_count:p[1]},("banked_cloze"===s.custom_attr.disp_type?l.find(".q_stem_option_ul"):l.find(".q_option_ul")).attr({"data-column":o.column_count}),o=JSON.stringify(o)}_=Q.format_data_to_obj(a,i,o),Q.save_question_setting(_);break;case"blank_multiple_to_single":case"blank_single_to_multiple":l.find(".q_option_list .blanksframe").attr("row",n),Q.save_question_setting(_);break;case"blank_multiple_text":var u=t.attr("option-id");l.find(".q_option_list li[oid="+u+"] .blanksframe").attr("row",n),Q.save_option_setting(u,i,o);break;case"text_row":u=t.attr("option-id");l.find("textarea[oid="+u+"]").attr("row",n),Q.save_option_setting(u,i,o);break;case"horz_blank_style":Q.save_question_setting(_,function(){Q.update_question_html(a,T),$("#question_"+a).addClass("question_focus")});break;case"blank_style":Q.save_question_setting(_,function(){Q.updateBankedClozeQuestion(a),Q.renderBankedCloze(a)});break;case"answer":Q.save_evaluation_question_setting(a,i,o,T,e);break;default:Q.save_question_setting(_)}}},".btn_layout"),t.on({change:function(){var e=$(this),i=e.attr("data-key"),o=e.val(),n=(e.parent(),t.attr("qid")),a=Q.format_data_to_obj(n,i,o);if("max_answer_num"==i||"min_answer_num"==i){var s="max_answer_num"==i?"min_answer_num":"max_answer_num";Q.update_option_select(n,s,o)}else if("answer"==i)return Q.save_evaluation_question_setting(n,i,o,T),!1;switch(o=0!=parseInt(o)?o:"none",i){case"answer_match":case"calculation":var _=Q.get_question(n);Q.save_question_setting(a,function(){if(_.custom_attr&&"banked_cloze"===_.custom_attr.disp_type){var t="select_correct"===o?"姣忛」鍒嗗€�":"姝ら鍒嗗€�";$("#question_setting .score_setting_title").text(t),Q.updateBankedClozeScore(n)}else Q.question_answer_score_template(n,i,o),Q.update_question_html(n,T),2==project.p_type&&Q.calculation_project_total_score(),$("#question_"+n).addClass("question_focus")});break;case"correct_answer":var l=e.attr("oid");a=Q.format_data_to_obj(n,i,o,l),Q.save_question_setting(a);break;case"upload_num":Q.save_question_setting(a,function(){Q.update_question_html(n,T),$("#question_"+n).addClass("question_focus")});break;default:Q.save_question_setting(a)}}},"#question_setting .select_selection, #question_setting .banked_cloze_setting select.w-select-orgin"),t.on({change:function(){var e=$(this),i=e.attr("data-key"),o=e.val(),n=t.attr("qid"),a=Q.format_data_to_obj(n,i,o);switch(t.find(".only_item [data-key=data_unique], .data_unique [data-key=data_unique]").removeClass("checked").attr("data-value","none"),o){case"mobile":t.find(".min_item, .max_item,.message_item, .data_unique").hide(),t.find(".message_item, .only_item").show();break;default:t.find(".min_item, .max_item,.message_item, .data_unique").show(),t.find(".message_item, .only_item").hide()}Q.save_question_setting(a)}},".fill_in_limit .content_item select"),t.on({blur:function(e){e.stopPropagation();var i=$(this),o=i.attr("data-key"),n=i.val(),a=t.attr("qid");i.attr("oid"),Q.get_question(a);if(n!=i.attr("data-value"))if(/^[1-9]\d*$/.test(n)){if((i.parents(".setting_item").hasClass("min_item")||i.parents(".setting_item").hasClass("max_item"))&&!Q.checkInputValue(i))return i.val(i.attr("data-value")),void i.closest(".setting_item").find(".error_tip").hide();i.attr({"data-value":n});var s=Q.format_data_to_obj(a,o,n);Q.save_question_setting(s)}else{i.attr({"data-value":n});s=Q.format_data_to_obj(a,o,"none");Q.save_question_setting(s)}}},"#question_setting input.q_input[type=number], #question_setting input.q_input[type=text] ");var e=_.debounce(function(t){t.stopPropagation(),Q.checkInputValue($(this))},300);t.on({blur:function(e){e.stopPropagation();var i=$(this),o=i.attr("data-key"),n=i.val(),a=t.attr("qid"),s=i.attr("oid"),_=Q.format_data_to_obj(a,o,n,s);Q.get_question(a);if(i.hasClass("answer_total_score")&&""!=n||n!=i.attr("data-value"))switch(o){case"answer":(l=/^(\-)?\d+(\.5)?$/).test(n)&&Q.save_evaluation_question_setting(a,o,n,T,i);break;case"total_score":if(!(l=/^(\-)?\d+(\.5)?$/).test(n))return void i.val("");Q.save_question_score(a,o,n,T,i);break;case"answer_analysis":Q.save_question_setting(_);break;case"options_score":var l=/^(\-)?\d+(\.5)?$/,d=parseInt(i.attr("data-index"));if(!l.test(n))return void i.val("");(r={})[d]=parseInt(n)||0,_=Q.format_data_to_obj(a,o,JSON.stringify(r)),Q.saveQuestionSettingHandle(_,a,o,n,T);break;case"options_title":d=i.attr("data-value");var r={};n.trim().length>25&&(j(e,i,"浠呭彲杈撳叆25涓瓧"),n=n.substring(0,25)),r[d]=n||"鑷畾涔夊唴瀹�",console.log("dfdfsfaeere"),_=Q.format_data_to_obj(a,o,JSON.stringify(r)),Q.saveScaleQuestionSettingHandle(_,a,o,n,T);break;case"score":if(!(l=/^(\-)?\d+(\.5)?$/).test(n))return void i.val("");Q.saveQuestionSettingHandle(_,a,o,n,T);break;case"correct_answer":n=n.replace(/\s/g,"").replace(/锛�/g,";"),_=Q.format_data_to_obj(a,o,n,s),Q.saveQuestionSettingHandle(_,a,o,n,T);break;default:Q.saveQuestionSettingHandle(_,a,o,n,T)}}},"#question_setting input.evaluation_input[type=text],#question_setting .answer_analysis_cot"),t.on({focus:function(t){$(this).select()}},"#question_setting input.evaluation_input[type=text]"),t.on({keydown:e,keyup:function(e){e.stopPropagation();var i=$(this),o=i.attr("data-key"),n=i.val();t.attr("qid");switch(o){case"total_score":case"keywords_score":case"answer":i.val(Q.regular_expression_matching(n));break;case"score":i.hasClass("blank_score")?i.val(Q.regular_expression_matching(n)):i.val(Q.regular_expression_matching(n,!0));break;case"cloze_same_score":Q.checkClozeScore(i,e);break;case"answer_analysis":case"correct_answer":Q.answer_analysis_limit(n,i)}}},".fill_in_limit .min_item input , .fill_in_limit .max_item,#question_setting .answer_analysis_cot,#question_setting input.evaluation_input[type=text], #question_setting input.cloze_score"),t.on({click:function(t){t.stopPropagation(),$(this).find("ul").toggleClass("none")}},"#question_setting .show_style"),t.on({click:function(e){e.stopPropagation();var i=$(this),o=t.attr("qid"),n=Q.get_question(o).custom_attr.disp_type,a=i.attr("class");"scale"==n&&(a=i.attr("data-type"));var s=i.parent(),_=(o=$("#setting_main_wrap").attr("qid"),$("#question_"+o)),l=Q.format_data_to_obj(o,"score_display",a);s.addClass("none"),"scale"==n&&(a+=" scale_question"),t.find(".show_style span:eq(0)").attr("class",a),"scale"!=n&&(_.find(".q_option_ul").attr("class","q_option_ul "+a),_.find(".prompt_view").attr("class","prompt_view "+a)),"matrix_scale"==n?"slider"==a?(_.find(".option_item .score_wrap>div>span:last-child").attr("class","last"),_.find(".option_item .active").attr("class","first"),_.find(".option_item .first").next("span").attr("class","active")):(_.find(".option_item .first").attr("class","active"),_.find(".option_item .active").next("span").attr("class",""),_.find(".option_item .last").attr("class","")):"slider"==a?(_.find(".related_question_option score_wrap>div>span:last-child").attr("class","last"),_.find(".related_question_option active").attr("class","first")):(_.find(".related_question_option.slider first").attr("class","active"),_.find(".related_question_option.slider active").attr("class","")),_.find(".related_question_option").attr("class","related_question_option "+a),"scale"!=n?Q.save_question_setting(l):Q.save_question_setting(l,function(){Q.update_question_html(o,T),_.find(".q_option_ul").attr("class","q_option_ul "+a)})}},"#question_setting .show_style ul li"),t.on({change:function(){var e=$(this),i=e.attr("data-key"),o=e.val(),n=t.attr("qid"),a=Q.format_data_to_obj(n,i,o);$("#question_"+n+" .q_option_table .option_table").attr("max_score",o),Q.save_question_setting(a)}},"#question_setting .setting_matrix_score .score"),t.on({change:function(){var e=$(this),i=e.attr("data-key"),o=e.val(),n=t.attr("qid"),a=Q.get_question(n).custom_attr.min_answer_num||0;e.hasClass("extremum_tag")?1==o?(e.closest(".matrix_scale_wrap").addClass("expand"),$('.matrix_scale_wrap .scale_input input[data-type="desc_left"], .matrix_scale_wrap .scale_input input[data-type="desc_right"]').val(""),o='1:["", ""]'):e.closest(".matrix_scale_wrap").removeClass("expand"):o=Number(o)+Number(a)-1;var s=Q.format_data_to_obj(n,i,o);e.hasClass("scale")?Q.saveScaleQuestionSettingHandle(s,n,i,o,T):Q.saveQuestionSettingHandle(s,n,i,o,T)}},"#question_setting .matrix_scale"),t.on({change:function(t){t.stopPropagation()},blur:function(e){var i,o=$(e.target).closest(".scale_start_wrapper").find(".scale_start"),n=o.attr("data-key"),a=o.val(),s=t.attr("qid"),_=(o.attr("data-can-save"),Q.get_question(s));if(_&&_.custom_attr){var l=_.custom_attr.min_answer_num||0;if(""!=a&&a!=l&&"-"!=a){i=Number(a);var d=Q.format_data_to_obj(s,n,i);o.closest(".setting_item").hasClass("scale")?Q.saveScaleQuestionSettingHandle(d,s,n,a,T):Q.saveQuestionSettingHandle(d,s,n,a,T)}else o.val(l)}},mousedown:function(e){if($(e.target).hasClass("w-icon")){e.preventDefault();var i=$(e.target),o=i.closest(".scale_start_wrapper").find(".scale_start"),n=(o.attr("data-key"),parseInt(o.val())),a=(t.attr("qid"),0);if(i.hasClass("w-icon-arrow-up")?a=1:i.hasClass("w-icon-arrow-down")&&(a=-1),n+a>=-9&&n+a<=89){o.val(n+a),o.attr("data-can-save","yes"),o.focus();s=n+a;Q.changeInputArrow(s,-9,89)}else j(e,o,"浠呴檺-9锝�89鍐呯殑鏁存暟")}else{var s=$(e.target).val();Q.changeInputArrow(s,-9,89)}},paste:function(t){$(t.target).addClass("paste-mark")},input:function(e){var i=$(e.target),o=(i.attr("data-key"),i.val()),n=(t.attr("qid"),Number(o));if(i.hasClass("paste-mark")&&(isNaN(o)||!isNaN(o)&&n<-9||n>89))return i.val(""),j(e,i,"浠呴檺-9锝�89鍐呯殑鏁存暟"),void i.removeClass("paste-mark");if("-"!=o)if(isNaN(n)||o.indexOf(".")>=0||o.indexOf(" ")>=0)a=(a=o.slice(0,o.length-1)).replace(/[^\d-]/g,""),i.val(a),Q.changeInputArrow(a,-9,89),j(e,i,"浠呴檺-9锝�89鍐呯殑鏁存暟");else if(n>=-9&&n<=89){if(""===o||0===o)return void Q.changeInputArrow(o,-9,89,0);i.val(n),Q.changeInputArrow(n,-9,89)}else{var a;a=(a=o.slice(0,o.length-1)).replace(/[^\d-]/g,""),i.val(a),Q.changeInputArrow(a,-9,89),j(e,i,"浠呴檺-9锝�89鍐呯殑鏁存暟")}}},"#question_setting .scale_start_setting .scale_start_wrapper"),t.on({focus:function(){$(this).parents(".scale_input").addClass("show_error_tip")},blur:function(){var e=$(this),i=e.attr("data-key"),o=e.attr("data-type"),n=e.val(),a=t.attr("qid"),s=Q.get_question(a);if(s&&s.custom_attr){var _=s.custom_attr.desc_right||"",l=s.custom_attr.desc_left||"";switch(e.parents(".scale_input").removeClass("show_error_tip"),o){case"desc_left":if(n==l)return;n='1:["'+n+'","'+_+'"]';break;case"desc_right":if(n==_)return;n='1:["'+l+'","'+n+'"]'}var d=Q.format_data_to_obj(a,i,n);Q.save_question_setting(d,function(){Q.update_question_html(a,T),Q.question_options_title_template(a,i,n),$("#question_"+a).addClass("question_focus")})}}},"#question_setting .scale_input input"),t.on({click:function(){if(!$(this).hasClass("on")){var e=$(this),i=e.attr("data-value"),o=t.attr("qid"),n=$("#question_"+o),a=n.find(".select_transverse select:eq(0)"),s=n.find(".select_transverse select:eq(1)"),_=n.find(".select_transverse select:eq(2)"),l=n.find(".select_transverse textarea"),d={project_id:get_oid(project),question_id:o,question_info:{},options_list:[]};switch(e.addClass("on").siblings().removeClass("on"),i){case"four":l.parent().show(),$("#input_vr_setting").show(),_.removeClass("none"),s.removeClass("none"),a.removeClass("none"),d.question_info={"custom_attr.drop_type":"address"},d.options_list=[{title:"鐪佷唤",id:a.attr("id")},{title:"鍩庡競",id:s.attr("id")},{title:"鍖�/鍘�",id:_.attr("id")},{title:"琛楅亾",id:l.attr("id")}];break;case"three":l.parent().hide(),$("#input_vr_setting").hide(),_.removeClass("none"),s.removeClass("none"),a.removeClass("none"),d.question_info={"custom_attr.drop_type":"city"},d.options_list=[{title:"鐪佷唤",id:a.attr("id")},{title:"鍩庡競",id:s.attr("id")},{title:"鍖�/鍘�",id:_.attr("id")}];break;case"two":l.parent().hide(),$("#input_vr_setting").hide(),_.addClass("none"),s.removeClass("none"),a.removeClass("none"),d.question_info={"custom_attr.drop_type":"city"},d.options_list=[{title:"鐪佷唤",id:a.attr("id")},{title:"鍩庡競",id:s.attr("id")}];break;case"one":l.parent().hide(),$("#input_vr_setting").hide(),_.addClass("none"),s.addClass("none"),a.removeClass("none"),d.question_info={"custom_attr.drop_type":"city"},d.options_list=[{title:"鐪佷唤",id:a.attr("id")}]}Q.save_address_option_setting(d,function(t){console.log(t);for(var e=t.data.question.option_id_list,i=0;i<3;i++)e.push("");a.attr("id",e[0]),s.attr("id",e[1]),_.attr("id",e[2]),l.attr("id",e[3])})}}},"#question_setting .detail_degree div"),t.on({change:function(){var e=$(this),i=e.attr("data-key"),o=e.val(),n=t.attr("qid"),a=Q.format_data_to_obj(n,i,o);$("#question_"+n);if("max_answer_num"==i||"min_answer_num"==i){var s="max_answer_num"==i?"min_answer_num":"max_answer_num";Q.update_score_limit(n,s,o)}Q.save_question_setting(a)}},"#question_setting .setting_score .score"),t.on({blur:function(){var e=$(this),i=e.attr("data-key"),o=e.val(),n=t.attr("qid"),a=Q.format_data_to_obj(n,i,o),s=$("#question_"+n);switch(i){case"desc_left":s.find(".q_option_list .prompt_view .left").text(o);break;case"desc_middle":s.find(".q_option_list .prompt_view .middle").text(o);break;case"desc_right":s.find(".q_option_list .prompt_view .right").text(o)}Q.save_question_setting(a)}},"#question_setting .prompt input"),t.on({mouseover:function(e){var i=$(this),o=t.attr("qid");Q.updateArrowStatus(o,i)},blur:function(e){var i=$(this).find("input"),o=i.attr("data-key"),n=parseInt(i.val()),a=t.attr("qid"),s=Q.format_data_to_obj(a,o,n),_=Q.get_question(a),l="on"==_.custom_attr.limit_max_min,d="",r=$("#question_"+a),c={};switch(o){case"total_value":c=Q.checkTotalValue(a,n),d=_.custom_attr.total_value;break;case"max_answer_num":c=Q.checkMaxNum(a,n),d=_.custom_attr.max_answer_num;break;case"min_answer_num":c=Q.checkMinNum(a,n),d=_.custom_attr.min_answer_num}if(c.isSuccess)switch(o){case"total_value":var p={total_value:n};l||(p={total_value:n,min_answer_num:0,max_answer_num:n});var u=Q.format_data_to_obj(a,o,JSON.stringify(p));Q.save_question_setting(u,function(){if(r.find(".total_value").text(n),!l){var t=$("#question_setting");t.find("input.min_answer_num").val(0),t.find("input.max_answer_num").val(n),Q.updateProportionSlider(a)}});break;case"max_answer_num":Q.save_question_setting(s,function(){Q.updateProportionSlider(a)});break;case"min_answer_num":Q.save_question_setting(s,function(){r.find(".min_value").text(n),Q.updateProportionSlider(a)})}else errTooltip.show(e.currentTarget,{inner:c.errMsg,direction:"top"}),i.focus(),setTimeout(function(){errTooltip.hidden(),i.val(d)},2e3);i.removeClass("focus_border")}},".setting_proportion .custom_input"),t.on({input:function(){1==this.value.length?$(this).hasClass("min_answer_num")?this.value=this.value.replace(/[^0-9]/g,""):this.value=this.value.replace(/[^1-9]/g,""):/^0/g.test(this.value)?$(this).hasClass("min_answer_num")?this.value="0":this.value="":this.value=this.value.replace(/\D/g,"")}},"#question_setting .setting_proportion input"),t.on({click:function(e){var i=$(this),o=t.attr("qid"),n=i.parents(".custom_input"),a=n.find("input"),s=a.first(),_=parseInt(s.val()),l=i.hasClass("w-icon-arrow-up")?_+1:_-1;a.addClass("focus_border"),s.val(l),Q.updateArrowStatus(o,n)}},"#question_setting .setting_proportion .w-icon-arrow-up, #question_setting .setting_proportion .w-icon-arrow-down"),t.on({change:function(){var e=$(this),i=t.attr("qid"),o=e.data("key"),n=e.val(),a=Q.format_data_to_obj(i,o,n);Q.save_question_setting(a,function(){"category_min_num"==o?Q.updateCategoryMaxSelect(i,$(".block_category select[name='max_select']"),n):Q.updateCategoryMinSelect(i,$(".block_category select[name='min_select']"),n)})}},"#question_setting .block_category select[name='min_select'], #question_setting .block_category select[name='max_select']"),t.on({compositionstart:function(){$(this).attr("data-isChinese",!0)},compositionend:function(t){var e=$(this);e.attr("data-isChinese",!1),Q.checkLimitLength(t.currentTarget,e,50)},input:function(t){var e=$(this);"true"!==e.attr("data-isChinese")&&Q.checkLimitLength(t.currentTarget,e,50)},blur:function(){var t=$(this),e=t.data("oid"),i=t.data("key"),o=t.data("option"),n=t.val();if(""===n.trim()){var a=t.data("origin-name");t.val(a)}else"extra_option"===o?Q.save_extra_option_setting(e,i,n):Q.save_option_setting(e,i,n)}},"#question_setting .classification.image_setting input"),t.on({click:function(){var e=$(this),i=e.data("type"),o=t.attr("qid"),n=Q.get_question(o),a="cutover_eval_template",l=s[i],d=s[n.custom_attr.base_on],r={question_title:l.title,question_setting:{max_answer_num:l.maxAnwser,base_on:i,score_display:l.iconType},label_data:l.labelData};_.isEqual(n.option_list[1].custom_attr.label_data,d.labelData)&&_.isEqual(n.title,d.title)||1==getCookie("notReminderTemplateChange")?(Q.change_template(o,a,JSON.stringify(r),l),e.addClass("selected").siblings().removeClass("selected")):Q.template_change_reminder(function(){Q.change_template(o,a,JSON.stringify(r),l),e.addClass("selected").siblings().removeClass("selected")})}},"#question_setting .evaluation_template span"),t.on({change:function(){var e=$(this),i=t.attr("qid"),o=QUESTION_DICT[i].option_list,n=e.data("key"),a=e.val(),s=Q.format_data_to_obj(i,n,a);Q.save_question_setting(s,function(){$("#question_"+i).find(".q_option_ul").html(""),Q.render_option(i,o)})}},"#question_setting .evaluation_score_select select"),t.on({change:function(){var e=$(this),i=t.attr("qid"),o=Q.get_question(i).custom_attr.cloze_score_rule,n=e.data("key"),a=e.val();if(o!==a){var s=Q.format_data_to_obj(i,n,a);Q.save_question_setting(s,function(){var t=$("#question_setting .cloze_input"),e=$("#question_setting .btn_setting_cloze_score");"same"===a?(t.removeClass("none"),e.addClass("none"),Q.updateClozeScore(i),Q.calculation_project_total_score()):(t.addClass("none"),e.removeClass("none"))})}}},'#question_setting select[name="cloze-score-rule"]'),t.on({click:function(t){var e=$(this),i=e.parents(".cloze_input"),o=e.siblings(".cloze_score").first(),n=parseFloat(o.val()),a=i.find(".w-icon-arrow-up"),s=i.find(".w-icon-arrow-down"),_=0;e.hasClass("w-icon-arrow-up")?((_=n+.5)>=100&&a.addClass("w-icon-arrow-disabled"),s.removeClass("w-icon-arrow-disabled")):((_=n-.5)<=0&&s.addClass("w-icon-arrow-disabled"),a.removeClass("w-icon-arrow-disabled")),o.addClass("focus_border"),o.val(_)}},"#question_setting .cloze_input i.w-icon"),t.on({input:function(t){var e=$(this),i=e.parents(".cloze_input"),o=parseFloat(e.val()),n=i.find(".w-icon-arrow-up"),a=i.find(".w-icon-arrow-down");o<100?n.removeClass("w-icon-arrow-disabled"):100===o&&n.addClass("w-icon-arrow-disabled"),o>0?a.removeClass("w-icon-arrow-disabled"):0===o&&a.addClass("w-icon-arrow-disabled")}},"#question_setting .cloze_input .cloze_score"),t.on({blur:function(e){var i=$(this).find("input.cloze_score"),o=i.data("key"),n=t.attr("qid"),a=Q.get_question(n);if(i.removeClass("focus_border"),i.val()!==a.custom_attr.cloze_same_score+""){Q.checkClozeScore(i,e,!1,a.custom_attr.cloze_same_score);var s=Q.format_data_to_obj(n,o,i.val());Q.save_question_setting(s,function(t){2===project.p_type&&(Q.updateMaxScore(n),Q.calculation_project_total_score())})}}},"#question_setting .cloze_input"),y.initEvent(t,"",".btn_setting_cloze,.btn_setting_cloze_score"),t.on({click:function(){var t=$(this),e=t.parents(".classification_img_list");t.parents(".collapse").addClass("none"),e.find(".expand").removeClass("none"),e.find(".list_wrap").addClass("none")}},"#question_setting .classification_img_list .collapse_icon"),t.on({click:function(){var t=$(this),e=t.parents(".classification_img_list");t.parents(".expand").addClass("none"),e.find(".collapse").removeClass("none"),e.find(".list_wrap").removeClass("none")}},"#question_setting .classification_img_list .expand_icon");var i={selector:t,targetSelector:".banked_cloze_input",min:0,max:1e3,step:.5,isFloat:!0,canEmpty:!0,relatedSelector:"",relation:"",errMsg:"璇疯緭鍏ュ皬浜庣瓑浜�1000鐨勬暟瀛�",errMsg1:"",saveParamKeys:["qid","key"],saveFn:Q.saveTotalScore,validFunc:Q.checkTotalScore};Q.bindNumberInputEvent(i)},T.initProjectEditableEvent=function(t){t.on({focus:function(t){var e=$(this);$(".question_focus").removeClass("question_focus"),$(".editable_focus").removeClass("editable_focus"),e.parents(".content_editable").addClass("editable_focus"),Q.show_toolbar(e),Q.input_on_focus(e)},blur:function(){Q.save_project_content_editable_handler($(this))},paste:function(t){t.preventDefault(),Q.pasteFun(t)}},'.survey_prefix_wrap div[contenteditable="true"],.survey_suffix_wrap div[contenteditable="true"]'),t.on({change:function(){var t=$(this),e=t.parents(".survey_suffix_wrap").find(".suffix_content");"complete"==t.val()?(2==p_type&&e.attr("contenteditable",!1),e.html(project.end_desc).attr({"edit-type":"end_desc"})):"screenout"==t.val()&&(e.attr("contenteditable",!0),e.html(project.custom_attr.screenout_desc||"").attr({"edit-type":"screenout_desc"})),Q.showEndDescPlaceHolder(e)}},".survey_suffix_wrap select[name=end_desc_type]"),t.on({click:function(){var e=$(this),i=project.questionpage_id_list.length,o=0,n=1,a=e.hasClass("page_add_btn_last");if(a){n=t.find(".question_page:last").data("page-num")||1;var s=Math.max(t.find(".question_page:last").index(),0);o=t.find(".module").length-s}else{var _=e.closest(".question_page");n=parseInt(_.data("page-num"))}var l=n-1;Q.create_page(l,o,function(t){if(Q.hide_add_question_tip(Q.$questionBox),1===n){var o=juicer(m.pageTemplate,{pageNum:1,totalPage:i+1});Q.$questionBox.append(o)}if(a){var s=juicer(m.pageTemplate,{pageNum:n+1,totalPage:i+1});Q.$questionBox.append(s)}else{s=juicer(m.pageTemplate,{pageNum:n,totalPage:i+1});e.closest(".question_page").before(s),Q.update_page_num(n)}Q.update_page_num()})}},".page_add_btn"),t.on({click:function(){var t=$(this).closest(".question_page"),e=parseInt(t.data("page-num"))-2;Q.delete_page(e,function(e){t.remove(),1===project.questionpage_list.length&&($('.question_page[data-page-num="1"]').remove(),Q.show_or_hide_add_question_tip(Q.$questionBox)),Q.update_page_num()})}},".btn_page_del");var e=throttle(Q.setting_one_page_one_question,3e3,function(){Toast.hidden(),Toast("璇峰嬁棰戠箒鎿嶄綔")});t.on("click",".btn_switch",e)},T.initWindowEvent=function(){var t=$("body>div:first-child").height(),e=$(".question_type_wrap");e.css({height:$(window).height()-t+"px"}),$(window).resize(function(){var i=$(window).height()-t;e.css({height:i+"px"})}),$(window).focus(function(){Q.checkEditStatus()})},T.initQuestionExtraEvent=function(t,e){var i=Q.get_question(e),o=i.question_type,n=i.custom_attr.disp_type;if((o!=QUESTION_TYPE_SINGLE||"image_single"!=n&&"imagevote_single"!=n)&&(o!=QUESTION_TYPE_MULTIPLE||"image_multiple"!=n&&"imagevote_multiple"!=n)||(g.initImageUpload(t.find(".option_add"),e,"create",function(){Q.update_option_select(e,"max_answer_num"),Q.update_option_select(e,"min_answer_num"),Q.question_answer_score_template(e),verify_question_option.hide(e)}),t.on({click:function(t){var e=$(this),i=e.parents(".option_item"),o=e.parents(".question").attr("oid"),n=i.attr("oid");$.when(Q.delete_option(o,n,!0)).done(function(){Q.check_update_option_select(o),Q.question_answer_score_template(o)})}},".option_item .btn_img_del"),t.on({click:function(t){var i=$(this).parents(".option_item"),o=i.attr("oid"),n=i.find(".option_img_box>img"),a=n.attr("origin-url"),s=n.attr("bbox"),_=n.attr("origin-width");null!=s&&""!=s||(s="[75,75,150,150]"),s=s.parseJSON(),g.initImageJcrop(a,o,s,_,function(t,e,i){var o=$("#option_"+e);o.find(".option_img_box>img").attr({bbox:i,src:t}),o.find(".upload_loading").remove(),o.removeClass("option_item_upload").find(".option_img_box,.option_title_wrap").show()},function(t){var i=$("#option_"+t);g.initImageUpload(i,e,"update"),i.find('input[type="file"]').trigger("click")})}},".option_item .btn_img_edit")),check_in(i.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_MULTIPLE_BLANK,QUESTION_TYPE_SCORE,QUESTION_TYPE_ORDER])&&!check_in(i.custom_attr.disp_type,["horz_blank","cloze"])){var a=t.find(".q_option_ul"),s=".btn_handle,.content_editable",_=".option_item";i.custom_attr&&check_in(i.custom_attr.disp_type,["image_single","image_multiple","imagevote_single","imagevote_multiple"])?(a=t.find(".q_option_img_ul"),s=".option_img_box>img"):"banked_cloze"===n&&(a=t.find(".q_stem_content_ul, .q_stem_option_ul"),_=".stem_content_item, .stem_option_item"),a.sortable({snap:!0,delay:200,opacity:.9,scrollSensitivity:160,tolerance:"pointer",items:_,cancel:'div[contenteditable="true"]',handle:s,placeholder:"option-sortable-placeholder",containment:"#question_"+e,revert:!0}),a.on("sortstart",function(t,e){this.sortStartIndex=e.item.index(),e.item.removeClass("option_hover option_focus"),e.item.blur(),e.placeholder.height(e.item.outerHeight())}),a.on("sortstop",function(t,i){if(this.sortEndIndex=i.item.index(),this.sortEndIndex!==this.sortStartIndex)if("banked_cloze"===n)i.item.hasClass("stem_content_item")?Q.saveBankedClozeSort(e):Q.saveStemOptionSort(e);else{var o=Q.get_question(e).option_id_list.concat([]),a=o.splice(this.sortStartIndex,1)[0];o.splice(this.sortEndIndex,0,a),Q.save_option_sort(e,o)}})}check_in(i.question_type,[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE,QUESTION_TYPE_MATRIX_BLANK,QUESTION_TYPE_MATRIX_SCORE])&&(t.on({click:function(o){var n=$(this);Q.show_matrix_setting_operate(e,i,t,n)}},".option_operate .btn_dropdown"),t.on({click:function(t){new jsbox({onlyid:"matrix_setting_popup",title:"鐭╅樀棰樺垪瀹借皟鏁�",conw:960,conh:520,FixedTop:170,iframe:!0,url:"/edit/question_preview/"+e+"/",range:!1,mack:!0}).show()}},".q_option_operate .btn_setting_col")),"matrix_scale"==i.custom_attr.disp_type&&t.on({click:function(o){var n=$(this);Q.show_matrix_setting_operate(e,i,t,n,!0)}},".option_operate .btn_dropdown"),i.question_type!=QUESTION_TYPE_BLANK_DROPDOWN||"address"!=i.custom_attr.drop_type&&"city"!=i.custom_attr.drop_type||Q.init_address_select(e),l(i)&&(t.on({mouseover:function(){var t,e,i,o=$(this);e=(t=o).parents(".score_wrap").find("span"),i=parseInt(t.attr("data-index")),e.each(function(t,e){t<=i?$(e).addClass("hover-active"):$(e).removeClass("hover-active")})},mouseleave:function(){var t=$(this);t.parents(".score_wrap").find("span").each(function(t,e){0!=t&&$(e).removeClass("hover-active")})},click:function(t){var i=$(this),o=Q.get_question(e),n=o.option_list;o.edit_num=parseInt(i.attr("data-index")),i.parents(".q_option_ul").html(""),Q.render_option(e,n)}},".score_wrap span"),t.on({click:function(){var t=Q.get_question(e);Q.create_evaluation_model(t);var i=$("#q_evaluation_edit_popup").html(),o=juicer(i,t),n=new Popup({head:{inner:"缂栬緫閫夐」"},content:{inner:o,class:"evaluation-edit-popup"},width:"744px",height:"614px",btnAlign:"right",maskClickClose:!1,showCloseBtn:!0,noScroll:!1,showMask:!0,onClose:function(){n.destroy(),n=null},btnLeft:{inner:"鍙栨秷",class:"btn-cancel",onClick:function(t){n.destroy(),n=null}},btnRight:{inner:"淇濆瓨",class:"btn-save",onClick:function(e){var i=[],o=[],a={};for(var s in t.temp_data.label_data){var _=t.temp_data.label_data[s],l=[];_.label_list.forEach(function(t,e){var i=t.trim();i&&l.push(i)});var d=l.length;if(0==d)i.push(s);else Array.from(new Set(l)).length!=d&&o.push(s);a[s]={score_desc:_.score_desc.trim(),label_list:l}}o.length>0?(Toast.hidden(),Toast({message:"鍒嗗€�".concat(o.join("銆�"),"涓湁閲嶅鏍囩锛岃淇敼"),maxWidth:500})):i.length>0&&"on"==t.custom_attr.one_label_limit?Q.evaluation_edit_confirm(i,function(){Q.save_label_change(t._id.$oid,a),n.destroy(),n=null},function(){n.destroy(),n=null}):(Q.save_label_change(t._id.$oid,a),n.destroy(),n=null)}}}),a=$(".edit-container[data-index="+t.edit_num+"] .score-desc-edit"),s=a.val();a.val("").focus().val(s),Q.evaluation_popup_bind_event(t),n.show()}},".label_list .edit-label")),QUESTION_TYPE_MULTIPLE_BLANK===i.question_type&&"cloze"==i.custom_attr.disp_type&&y.initEvent(t,e,".q_option_operate label"),i.question_type===QUESTION_TYPE_CLASSIFICATION&&t.find(".q_option_wrap").scroll(function(){var t=$(this),e=t.find(".focused_operate");e.length>0&&($(".option_operation_wrap").remove(),e.removeClass("focused_operate")),t.find(".editable_focus").length>0&&(t.find('div[contenteditable="true"]').blur(),$("#edit_tool_bar").addClass("none"))})},T.initBodyEvent=function(){$("body").on("click",".question",function(t){t.stopPropagation();var e=$(this),i=e.attr("oid"),o=e.find(".q_seq").text(),n=$("#setting_main_wrap"),a=document.activeElement,s=$(t.target);if(!e.hasClass("question_split_line")){if(Q.hide_matrix_setting_operate(s),Q.hideOperationWrap(s),e.hasClass("question_focus")||e.addClass("question_focus").siblings().removeClass("question_focus"),s.hasClass("btn_option_setting")){var _=s.closest(".option_item");$(".option_hover").not(_).removeClass("option_hover")}else Q.is_show_question_or_option_setting(i,"","question")&&Q.show_question_setting(n,i,o),$(".option_hover").removeClass("option_hover");s.closest(".content_editable").length||$(a).closest(".content_editable").length||(0==$(".option_focus").length&&$("#edit_tool_bar").addClass("none"),$(".editable_focus").removeClass("editable_focus"))}}),$("body").on("click",function(t){var e=document.querySelector(".main"),i=document.querySelector(".header_wrap"),o=document.activeElement,n=$(t.target);Q.hide_matrix_setting_operate(n),Q.hideOperationWrap(n),$(o).closest(".content_editable").length||!e.contains(t.target)&&!i.contains(t.target)&&e!=t.target&&i!=t.target||($(".question_focus .editable_focus").removeClass("editable_focus"),$(".question_focus").removeClass("question_focus"),$(".option_hover").removeClass("option_hover"),$(".prefix_content,.content_editable").removeClass("editable_focus"),$("#edit_tool_bar").addClass("none"),Q.hide_setting_animate(),$(t.target).closest(".content_editable").length||$("#edit_tool_bar").addClass("none"))}),$("body").on({click:function(t){t.stopPropagation();var e=$(this).parents(".new_poplayer").attr("qid");$(".jsBubble_s .jsTip_close").click(),$("#question_"+e).click()}},".jsBubble_s .tipCon_t .new_poplayer .tool_bar span.cancel"),$("body").on({click:function(t){t.stopPropagation();var e=$(this),i=e.attr("type"),o=e.parents(".new_poplayer").attr("qid");$("#question_"+o).attr("disp_type");if($(".new_poplayer[qid="+o+"] textarea").is(".color_gray"))return $(".jsBubble_s .jsTip_close").click(),void $("#question_"+o).click();Q.add_batch_option(o,i)}},".jsBubble_s .tipCon_t .new_poplayer .tool_bar .save"),$("body").on({click:function(t){t.stopPropagation();var e,i=$(this),o=i.parent("#edit_tool_bar").attr("edit-type"),n=project._id.$oid;"option"==o||"extra_option"==o?e=i.parent("#edit_tool_bar").attr("oid"):"row"==o?e=i.parent("#edit_tool_bar").attr("row_qid"):"col"==o?(e=i.parent("#edit_tool_bar").attr("row_qid"),o="option"):"question"==o&&(e=i.parent("#edit_tool_bar").attr("oid")),2==p_type?Q.question_setting_checking("寮曠敤璁剧疆",function(t){t&&t.data&&1==t.data.can_setting&&Q.quote_setting(e,o,n)}):Q.quote_setting(e,o,n)}},"#edit_tool_bar .right"),$("body").on({click:function(t){t.stopPropagation();var e=edit_obj.find(".video-show-iframe").length>0?edit_obj.find(".video-show-iframe").prop("outerHTML"):"",i=new Popup({head:{inner:'<div><span class="add-video-title" >娣诲姞瑙嗛</span><i id = "add-video" data-color-type="original" class="add-video-icon" data-title="鐩墠浠呮敮鎸佷互涓嬪钩鍙帮細鑵捐瑙嗛銆佷紭閰疯棰�"></i></div>'},content:{inner:'<div class="add-video-content"><div class="add-video-row"><div class="video-name">瑙嗛閫氱敤浠ｇ爜</div><div class="video-icon"><i data-title="鑵捐瑙嗛" data-href= "https://v.qq.com" data-direction="top" data-color-type="black" class="icon-tx"></i><i data-direction="top" data-color-type="black" data-title="浼橀叿瑙嗛" data-href ="https://youku.com" class="icon-yk"></i></div></div><div><span class="w-input-icon-group w-input-icon-suffix input-style"><input class="w-input" maxlength = "1000" type="text" id="video-input" placeholder = "璇疯緭鍏ユ墍瑕佹坊鍔犺棰戠殑閫氱敤浠ｇ爜"><i class="w-icon w-icon-close" id="video-close"></i></span></div><div class="video-help" data-href="https://www.wenjuan.com/helpcenter/list/53916b15f7405b30051f15b8/h35cc11d9ea320fc1deee819d3">濡備綍娣诲姞瑙嗛</div></div>'},width:"560px",height:"314px",btnAlign:"right",showMask:!0,showCloseBtn:!0,onClose:function(){i.destroy(),i=null},btnLeft:{inner:"鍙栨秷",class:"btn-cancel",onClick:function(t){i.destroy(),i=null}},btnRight:{inner:"纭畾",class:"btn-save",onClick:function(t){var e=$("#video-input").val();Q.validateVideoUrl(e)&&(Q.saveVideo(e,T),i.destroy(),i=null)}}}),o=$("#video-input");o.val(e);var n=$("#video-close");o.val().length>0?n.show():n.hide(),o.focus(),i.show()}},"#edit_tool_bar .left .add-video"),$("body").on({keyup:function(t){var e=$("#video-close");$(this).val().length>0?e.show():e.hide()},focus:function(){var t=$("#video-close");$(this).val().length>0?t.show():t.hide()}},"#video-input"),$("body").on({click:function(t){$("#video-input").val(""),$(this).hide()}},"#video-close"),$("body").on({click:function(t){window.open($(this).attr("data-href"))}},".icon-tx,.icon-yk,.video-help"),$("body").on("mouseenter","#add-video,.icon-tx,.icon-yk, .scale_lable_wrapper.show_scale_lable",function(t){var e=t||window.event,i=$(this).attr("data-title"),o=$(this).attr("data-direction")||"right",n=$(this).attr("data-color-type")||"original";$(this).attr("data_not_show_guide")||Q.shareTypeTip.show(e.currentTarget,{inner:i,direction:o,colorType:n})}).on("mouseleave","#add-video,.icon-tx,.icon-yk, .scale_lable_wrapper.show_scale_lable",function(t){t||window.event;Q.shareTypeTip.hidden()}),$("body").on({click:function(t){t.stopPropagation(),Q.del_row(this)}},"#global_logic_set_popup .jsboxContent .reduce"),$("body").on({click:function(t){t.stopPropagation(),Q.get_new_row(),$("#add_jump_btn").hide()}},"#global_logic_set_popup .jsboxContent .add,.btn_add"),$("body").on({click:function(t){t.stopPropagation(),Q.get_new_rows(),$("#add_display_btn").hide()}},"#global_logic_set_popup .jsboxContent .add_btn,.btn_display_add"),$("body").on({click:function(t){var e=$(this),i=e.parents(".jsboxContent").attr("oid"),o=project._id.$oid;if(""==(n=e.text())){if(e.hasClass("left_arrow")){var n=$(".jump_paging_active").text();n--}else if(e.hasClass("right_arrow")){n=$(".jump_paging_active").text();n++}}else n=e.text();Q.jump_arrow_hide(),Q.jump_page(i,o,n)}},".opt_page"),$("body").on({click:function(t){var e=$(this),i=e.parents(".jsboxContent").attr("oid"),o=e.text(),n=project._id.$oid;if(""==o){if(e.hasClass("left_arrow")){o=$(".display_paging_active").text();o--}else if(e.hasClass("right_arrow")){o=$(".display_paging_active").text();o++}}else o=e.text();Q.display_arrow_hide(),Q.display_page(i,n,o)}},".display_page"),$("body").on("keyup",'input[data-key="char_count"], input[data-key="char_count_min"]',function(){Q.validationNum($(this))}),$("body").on({click:function(t){"false"==$(".suffix_content").attr("contenteditable")&&($end_pop.css({display:"block"}),score_obj=Q.calculation_project_total_score(),1==end_switch_params.setting_type?answer_option():end_switch_params.setting_type=0,init_end_language_ajax(score_obj))}},"#end_pop_icon","#end_pop_icon_button"),$("body").on({click:function(){var t=$(this),e="on"==t.attr("data-value")?"off":"on",i={data:JSON.stringify({question_preview:e})};"off"==e&&$("#preview-container").hide(),Q.ajaxPost("/edit/ajax/global_setting/",i,function(){globalData.globalSetting.question_preview=e,t.toggleClass("checked"),t.attr("data-value",e)})}},"#preview_img_btn .btn_switch"),$("body").on("mouseenter","#options-title-tooltip",function(t){var e=t||window.event,i=$(this).attr("data-title"),o=$(this).attr("data-direction")||"right",n=$(this).attr("data-color-type")||"original";$(this).attr("data_not_show_guide")||Q.optionsTitlesTip.show(e.currentTarget,{inner:i,direction:o,colorType:n})}).on("mouseleave","#options-title-tooltip",function(t){t||window.event;Q.optionsTitlesTip.hidden()})},T.initQuestionEvent=function(t){var e=$("#question_"+t);T.initQuestionEditableEvent(e,t),T.initQestionOperateEvent(e,t),T.initOptionOperateEvent(e,t),T.initQuestionExtraEvent(e,t)},T.initQlibEvent=function(){Q.qlib_init_checked_question(),$(".question_type_wrap .question-lib-box").one({click:function(t){Q.show_qlib_popup($(this).attr("data-id"))}},".qlib-search, .category-list p"),$("body").on("keyup",".qlib-search-ipt input",function(t){"13"==t.keyCode&&Q.update_qlib_list({keywords:$(".popup_wrap .qlib-search-ipt input").val().trim()})}),$("body").on("click",".qlib-search-btn",function(){Q.update_qlib_list({keywords:$(".popup_wrap .qlib-search-ipt input").val().trim()})}),$("body").on("click",".option-wrap .btn",function(t){t.stopPropagation(),$(this).parents(".question-item").toggleClass("show-option")}),$("body").on("click",".qlib-list-wrap .question-item",function(){var t=$(this);if(window.globalData.qlib_checked_question_list.length>=10&&!t.hasClass("checked"))Toast("涓€娆″彧鑳芥坊鍔�10棰�");else{var e=t.attr("data-id");if(t.toggleClass("checked"),t.hasClass("checked"))window.globalData.qlib_checked_question_list.push({qid:e,is_search:t.hasClass("is_search")}),window.globalData.qlib_checked_qid_list.push(e);else{var i=window.globalData.qlib_checked_qid_list.indexOf(e);window.globalData.qlib_checked_question_list.splice(i,1),window.globalData.qlib_checked_qid_list.splice(i,1)}$(".add-qlib-question-to-project").text("娣诲姞 "+window.globalData.qlib_checked_qid_list.length+" 棰� 鑷抽」鐩�")}})},T.initMainEvent=function(t){if(1==idyC.getUrlQuery("create")){var e=$(".survey_title .title_content");e.html();e.parent().addClass("editable_focus"),Q.show_toolbar(e),Q.setFocus(e)}Q.showEndDescPlaceHolder($(".suffix_content")),T.initProjectEditableEvent(t),T.initWindowEvent(),T.initBodyEvent(),T.initSettingMainEvent(),juicer.register("format_option_description",Q.format_option_description),juicer.register("transformNumToLetter",x.c),f.a.configs("new_question_dic"),T.initQlibEvent()};var C=T,S=i(17),k=i(5),I=function(){this.obj=""};window.textEdit=new I,I.prototype.addImg=function(t){if(""==!t.error_msg)return loadMack({off:"on",Limg:0,text:t.error_msg,set:2500}),!1;var e='<img src="'+t.img_url+'" class="img-box" style="max-height:350px">',i=$(edit_obj).hasClass("option_title")&&$(edit_obj).parents(".question.classification").length>0;i&&(e='<img src="'+t.img_url+'h/50" class="img-box" style="max-height:50px">');var o=$(e).appendTo(edit_obj);N(),i||new E(o)};var E=function(t){return this.main=function(t){this.obj=$(t),this.event()},this.status=!0,this.status_menu=!0,this.event=function(){var t=this;this.obj.mouseover(function(){t.status_menu=!1,t.Menu&&t.DelMenu(),t.addMenu()}),this.obj.mouseout(function(){setTimeout(function(){t.DelMenu()},50)})},this.addMenu=function(){var t=this;this.Menu=$('<div class="ImgEditSize"><ul><li class="Enl" title="鏀惧ぇ"></li><li class="Ori" title="鍘熷浘"></li><li class="Nar" title="缂╁皬"></li><li class="Del" title="鍒犻櫎"></li></ul></div>'),$("body").append(t.Menu),this.Menu.css({position:"absolute",top:t.obj.offset().top+5+"px",left:t.obj.offset().left+5+"px"}),this.Menu.hover(function(){t.status=!1},function(){t.status=!0,t.status_menu=!0,setTimeout(function(){t.status_menu&&t.DelMenu()},200)}),this.Menu.find(".Enl").click(function(){N();var e=t.obj.width(),i=t.obj.height(),o=e/i;if(e>=750)return!1;t.getImgWH(e+20*o,i+20)}),this.Menu.find(".Ori").click(function(){N();t.imgSize(t.obj.attr("src"))}),this.Menu.find(".Nar").click(function(){N();var e=t.obj.width(),i=t.obj.height(),o=e/i;if(e<=100)return!1;t.getImgWH(e-20*o,i-20)}),this.Menu.find(".Del").click(function(){t.obj.remove(),N(),t.status=!0,t.DelMenu()}),this.Menu.click(function(){return!1})},this.getImgWH=function(t,e){this.obj.width(t),this.obj.height(e),this.obj.css("maxHeight","unset")},this.DelMenu=function(){this.status&&this.Menu&&this.Menu.remove()},this.imgSize=function(t){var e=this,i=new Image;i.onload=function(){e.getImgWH(i.width,i.height)},i.src=t},this.main(t)};function O(){return!1}function N(t){if(edit_obj.hasClass("horz_question_content"))edit_obj.click();else if(edit_obj.hasClass("title_content")||edit_obj.hasClass("prefix_content")||edit_obj.hasClass("suffix_content"))Q.save_project_content_editable_handler(edit_obj);else{var e=edit_obj.parents(".module"),i=e.attr("oid");Q.save_question_content_editable_handler(e,i,edit_obj,C)}}$("body").on("mousedown",".senior_edit,.option_operate .btn_option_description,.option_operate .optiondescription_cot,.option_description_wrap",function(t){var e=$(this);setTimeout(function(){if(e.hasClass("btn_option_description")||e.hasClass("optiondescription_cot")){var t='<div class="popup_header_cot">閫夐」璇存槑鈥斺€�'+e.parents(".option_operate ").siblings(".content_editable").children(".option_title").text()+"</div>";edit_obj=e,$("#edit_tool_bar").addClass("none")}else if(e.hasClass("option_description_wrap")){t='<div class="popup_header_cot">閫夐」璇存槑鈥斺€�'+e.siblings(".option_title_wrap").children(".option_title").text()+"</div>";edit_obj=e,$("#edit_tool_bar").addClass("none")}else t="楂樼骇缂栬緫鍣�",$("#edit_tool_bar").removeClass("none");edit_obj.parents(".module").addClass("question_focus").siblings().removeClass("question_focus"),edit_obj.parent().addClass("editable_focus");var i=new Popup({head:{inner:t},content:{inner:'<div style="min-height:200px;"><textarea name="editor1" id="editor1"></textarea></div>'},width:"660px",height:"388px",btnLeft:"鍙栨秷",btnRight:"淇濆瓨",btnAlign:"right",showMask:!0,onClose:function(){console.log("onClose"),$(window).off("mousewheel",O),i.destroy(),i=null},onLeftClick:function(){console.log("onLeftClick"),$(window).off("mousewheel",O),i.destroy(),i=null},onRightClick:function(){console.log("onRightClick");var t=CKEDITOR.instances.editor1.getData();$(edit_obj).attr("splitVideo")&&""!=$(edit_obj).attr("splitVideo")&&(t=t.replace("[瑙嗛]",$(edit_obj).attr("splitVideo")),$(edit_obj).attr("splitVideo","")),edit_obj.html(t),$(window).off("mousewheel",O),i.destroy(),i=null,N()}});if(e.hasClass("option_description_wrap")){var o=edit_obj.parents(".module").attr("oid"),n=edit_obj.parents(".option_item ").attr("oid"),a=Q.get_option(o,n),s=a.custom_attr?a.custom_attr.description:"";$("#"+i.id).find("textarea").val(s)}else{var _="";if(edit_obj.find(".video-show-iframe").length>0){var l=edit_obj.find("iframe").prop("outerHTML");_=edit_obj.html().replace(l,"[瑙嗛]"),$(edit_obj).attr("splitVideo",l)}else _=edit_obj.html();$("#"+i.id).find("textarea").val(_)}CKEDITOR.replace("editor1"),i.show(),$(window).on("mousewheel",O)},17)}),$("body").on("click","#senior_edit_box",function(t){t.stopPropagation()}),$("body").on("mousedown",".insert-blank",function(t){var e=edit_obj.attr("edit-type"),i=edit_obj.parents(".question").attr("oid");i&&("stem_content"===e?(window.isInsertBankedCloze=!0,Q.insertBankedCloze(i)):(Q.horz_insert_underline("___"),setTimeout(function(){edit_obj.click()},20)))}),$("body").on("mousedown",".insert-cloze",function(t){window.isInsertCloze=!0;var e=edit_obj.parents(".question").attr("oid");Q.insertClozeBlank(e)}),window.eventEndTime=0,window.ajaxPostNum=0,window.jsBubble=new JsBubble;var P={};function U(t,e){return e?(t.custom_attr.option_data=e,t):t.custom_attr.option_data||[]}function L(t,e){return e?(t.option_list=e,t):t.option_list||[]}function A(){return!1}P.$questionBox=$("#question_box"),P.shareTypeTip=new GuideText({maxWidth:240}),P.optionsTitlesTip=new GuideText({maxWidth:288}),P.get_init_template=function(t){return INIT_TEMPLATE_MAP[t]},P.changeInputArrow=function(t,e,i,o){o&&t===o||(""===t?($(".w-icon-arrow-up").addClass("w-icon-arrow-disabled"),$(".w-icon-arrow-down").addClass("w-icon-arrow-disabled")):t==e?($(".w-icon-arrow-down").addClass("w-icon-arrow-disabled"),$(".w-icon-arrow-up").removeClass("w-icon-arrow-disabled")):t==i?($(".w-icon-arrow-up").addClass("w-icon-arrow-disabled"),$(".w-icon-arrow-down").removeClass("w-icon-arrow-disabled")):$(".w-icon-arrow-disabled").removeClass("w-icon-arrow-disabled"))},P.get_question_html=function(t){var e={p_type:project.p_type,one_page_one_question:project.custom_attr.one_page_one_question};return $.extend(t,e),P.get_qmodel(t).gen_edit_template()},P.get_questionpage=function(t){return QUESTIONPAGE_DICT[t]},P.get_question=function(t){var e=QUESTION_DICT[t];return e?(e.extra_data&&e.extra_data.sms_quota||(e.extra_data={},e.extra_data.sms_quota=project.extra_data.sms_quota),project.p_type&&(e.custom_attr.p_type=project.p_type),e.related_question_list&&(e.related_question_list=P.format_related_question_list(e.related_question_list)),e):null},P.get_option=function(t,e){var i=P.get_question(t);if(!isNotEmpty(i))return null;if(e.constructor==Array){for(var o=[],n=0;n<i.option_list.length;n++){var a=i.option_list[n];check_in(get_oid(a),e)&&o.push(a)}return o}for(n=0;n<i.option_list.length;n++){a=i.option_list[n];if(get_oid(a)==e)return a}for(n=0;n<i.related_question_list.length;n++)for(var s=0;s<i.related_question_list[n].option_list.length;s++){a=i.related_question_list[n].option_list[s];if(get_oid(a)==e)return a}return null},P.get_extra_option=function(t,e){var i=P.get_question(t);if(!isNotEmpty(i)||!isNotEmpty(e))return null;if(i.question_type===QUESTION_TYPE_CLASSIFICATION||"banked_cloze"===i.custom_attr.disp_type)for(var o=0;o<i.extra_option_list.length;o++){var n=i.extra_option_list[o];if(get_oid(n)==e)return n}return null},P.get_matrixrow=function(t,e){var i=P.get_question(t);if(!isNotEmpty(i)||!isNotEmpty(i.matrixrow_list))return null;if(e.constructor!=String){var o=[];for(n=0;n<i.matrixrow_list.length;n++){a=i.matrixrow_list[n];check_in(get_oid(a),e)&&o.push(a)}return o}for(var n=0;n<i.matrixrow_list.length;n++){var a=i.matrixrow_list[n];if(get_oid(a)==e)return a}return null},P.get_option_list=function(t){return question_option_map[t]},P.get_qmodel=function(t){var e=null;if(e=t.constructor==String?P.get_question(t):t,isNotEmpty(e)){if(isNotEmpty(QMODEL_DICT[get_oid(e)]))return QMODEL_DICT[get_oid(e)];var i=r(e);return QMODEL_DICT[get_oid(e)]=i,i}return null},P.get_old_title=function(t,e,i){return"project"==t?project.title:"screenout_desc"==t?project.custom_attr.screenout_desc:"begin_desc"==t||"end_desc"==t?project[t]:"question"==t?P.get_question(e).title:"option"==t||"col"==t?i?P.get_option(e,i).title:QUESTION_DICT[e].custom_attr.horz_blank_content:"row"==t?P.get_matrixrow(e,i).title:"extra_option"==t?P.get_extra_option(e,i).title:void 0},P.get_option_setting=function(t,e){var i=P.get_question(t),o=i.option_id_list.indexOf(e),n=document.getElementById("option_setting_template").innerHTML,a={option:i.option_list[o],question_type:i.question_type};return juicer(n,a)},P.get_page_count=function(t){var e=QUESTION_DICT[t].questionpage_id;return project.questionpage_id_list.indexOf(e)},P.get_option_html=function(t,e){var i="",o=P.get_question(t),n=o.custom_attr.disp_type||o.question_type;return check_in(n,["vertical","transverse","column"])&&(n=o.question_type),i=m.optionTemplate[n],e&&(i=m.optionTemplate.col),i},P.get_new_option_html=function(t,e){var i=P.get_question(t),o=i.custom_attr.disp_type||i.question_type,n=$("#question_"+t);check_in(o,["vertical","transverse","column"])&&(o=i.question_type);var a=m.emptyOptionTemplate[o],s={};if(i.question_type!=QUESTION_TYPE_SCORE||i.custom_attr.disp_type){if(P.is_matrix_question(i)){s.option_list=i.option_list;var _=n.find("table tr").eq(0).children().length-1-s.option_list.length;if(i.question_type==QUESTION_TYPE_MATRIX_BLANK)for(var l=0;l<_;l++)s.option_list.push({custom_attr:{text_row:"1"},_id:{$oid:""}});else for(l=0;l<_;l++)s.option_list.push(l)}}else s.num=i.custom_attr.max_answer_num-i.custom_attr.min_answer_num+1;return juicer(a,{data:s})},P.get_col_html_by_question_type=function(t){var e="";return t===QUESTION_TYPE_MATRIX_SINGLE&&(e='<i class="icon_wj icon_radio"></i>{@if option.is_open}<input type="text" name="" id="" class="open_input" readonly>{@/if}'),t===QUESTION_TYPE_MATRIX_MULTIPLE&&(e='<i class="icon_wj icon_square"></i>{@if option.is_open}<input type="text" name="" id="" class="open_input" readonly>{@/if}'),t===QUESTION_TYPE_MATRIX_BLANK&&(e='<div class="matrix_blank input_vr_wrap"><textarea oid="&{option._id.$oid}" class="" &{option.custom_attr.text_row} {@if option.custom_attr.text_row == 2 || option.custom_attr.text_row == 3}row="3"{@else if option.custom_attr.text_row >= 4}row="5"{@/if}></textarea><div class="input_vr_icon"></div></div>'),t===QUESTION_TYPE_MATRIX_SCORE&&(e='<div class="matrix_score">{@each i in range(1, 11)}<span></span>{@/each}</div>'),'{@each option_list as option}<td align="center">'+e+"</td>{@/each}"},P.get_matrix_option_operation=function(t){return{col:{move_left:"宸︾Щ閫夐」",move_right:"鍙崇Щ閫夐」",setting:"閫夐」璁剧疆",delete:"鍒犻櫎"},col_score:{move_left:"宸︾Щ閫夐」",move_right:"鍙崇Щ閫夐」",delete:"鍒犻櫎"},row:{move_up:"涓婄Щ閫夐」",move_down:"涓嬬Щ閫夐」",delete:"鍒犻櫎"},new:{new_delete:"鍒犻櫎"},scale:{move_up:"涓婄Щ閫夐」",move_down:"涓嬬Щ閫夐」",delete:"鍒犻櫎"}}[t]},P.format_related_question_list=function(t){for(var e=0;e<t.length;e++)for(var i=t[e].option_list,o=0;o<i.length;o++){var n=i[o].title;i[o].title=formatOptionTitleRemoveImg(n)}return t},P.add_question_html=function(t,e){var i=P.$questionBox.find(".module:eq("+t+")"),o=$(e).insertAfter(i);$("html,body").animate({scrollTop:o.offset().top-100},"slow")},P.show_or_hide_add_question_tip=function(t){0===t.find(".module").length?P.show_add_question_tip(t):P.hide_add_question_tip(t)},P.show_add_question_tip=function(t){t.addClass("question_null").prepend('<div class="question_null_tip"><i class="icon_wj icon_click"></i>鐐瑰嚮棰樺瀷 鎴�<i class="icon_wj icon_move"></i>鎶婇鍨嬫嫋鍏ユ鍖哄煙</div>')},P.show_matrix_setting_operate=function(t,e,i,o,n){var a=o.closest(".option_item").attr("oid"),s=(o.parent(),$("#question_option_operate"));if(s.length>0){var _=s.attr("oid");if(s.remove(),_===a)return}i.addClass("question_focus").siblings().removeClass("question_focus");var l=o.closest("td").length>0?o.closest("td"):o.closest(".option_title_wrapper"),d=l.attr("name"),r="new"===l.attr("id")?"new":d,c=o.offset().left,p=o.offset().top+30,u=[];check_in(e.question_type,[QUESTION_TYPE_MATRIX_SCORE])&&"col"==r&&(r="col_score");var m=P.get_matrix_option_operation(r);for(var v in m)u.push('<a type="'+v+'">'+m[v]+"</a>");$("body").append('<div name="'+d+'" id="question_option_operate" oid="'+a+'" style="position: absolute; left: '+c+"px; top: "+p+'px;">'+u.join("")+"</div>"),$('#question_option_operate[oid="'+a+'"]').on("click","a",function(e){e.stopPropagation();var i=$(this),o=i.attr("type"),a=i.parent().attr("oid");if(i.parent().remove(),/^new_\d+$/.test(a)&&"new_delete"===o)if("col"===d){var s=$('.td_col[oid="'+a+'"]'),_=s.closest(".option_table"),l=$("td",s.parent()).index(s)+1;_.find("tr").each(function(t,e){$(this).find("td:nth-child("+l+")").remove()})}else"row"===d&&$('.td_row[oid="'+a+'"]').parent().remove();else P.matrix_option_operate(t,a,d,o,n)})},P.hide_matrix_setting_operate=function(t){$(".show_style ul").addClass("none"),t&&t.hasClass("btn_dropdown")||$("#question_option_operate").remove()},P.hide_add_question_tip=function(t){t.hasClass("question_null")&&t.removeClass("question_null").find(".question_null_tip").remove()},P.is_matrix_question=function(t){return check_in(t.question_type,[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE,QUESTION_TYPE_MATRIX_SCORE,QUESTION_TYPE_MATRIX_BLANK])},P.checkInputValue=function(t){var e=t.parent(),i=t.parents(".fill_in_limit"),o=i.find(".max_item input").val(),n=i.find(".min_item input").val(),a=(t.closest(".setting_item"),e.siblings(".error_tip"));return isNaN(parseInt(o))||isNaN(parseInt(n))?(a.hide(),!0):parseInt(n)<=parseInt(o)?(a.hide(),!0):parseInt(n)>parseInt(o)?(a.show(),!1):void 0},P.format_question_data_for_setting=function(t){var e=P.get_question(t),i=e.question_type,o=e.custom_attr.disp_type||"",n=$("#question_"+t).find(".q_seq").html(),a=check_in(i,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MATRIX_SINGLE]),s=check_in(i,[QUESTION_TYPE_SINGLE])&&!check_in(o,["judge","image_single","dropdown","sex"]),_=check_in(i,[QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_MATRIX_MULTIPLE]),d=a&&"dropdown"==o||_&&"multiple_dropdown"==o,r=i==QUESTION_TYPE_DESC,c=check_in(i,[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE]),p=i==QUESTION_TYPE_BLANK_DROPDOWN&&"cascader"==o,u=!r,m=check_in(i,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE])&&!d,v=check_in(i,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE]),f=m&&check_in(o,["vertical","transverse","column","sex","age","education","occupation",""]),h=!check_in(i,[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE,QUESTION_TYPE_MATRIX_BLANK,QUESTION_TYPE_MATRIX_SCORE,QUESTION_TYPE_BLANK,QUESTION_TYPE_BLANK_DROPDOWN,QUESTION_TYPE_DESC])&&!check_in(o,["upload_file","date","time","nps_score",DISP_TYPE_GEOGRAPHICAL,"evaluation","cloze","banked_cloze"]),q=(a||_)&&!check_in(o,["image_single","image_multiple","imagevote_single","imagevote_multiple"]),g=i==QUESTION_TYPE_ORDER,w=!check_in(i,[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE,QUESTION_TYPE_MATRIX_BLANK,QUESTION_TYPE_DESC,QUESTION_TYPE_BLANK])&&!check_in(o,["upload_file","nps_score","date","time","geographical_multiple_blank","cascader","horz_blank","matrix_scale","cloze","scale","banked_cloze"])&&"age"!==e.custom_attr.drop_type,b=check_in(i,[QUESTION_TYPE_MATRIX_BLANK,QUESTION_TYPE_MATRIX_SCORE,QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE]),y=check_in(i,[QUESTION_TYPE_MATRIX_BLANK,QUESTION_TYPE_MULTIPLE_BLANK]),x=i==QUESTION_TYPE_MATRIX_SCORE,T=check_in(i,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE])&&check_in(o,["imagevote_single","singlevote","imagevote_multiple","multiplevote"]),j=check_in(i,[QUESTION_TYPE_MULTIPLE_BLANK])&&check_in(o,["geographical_multiple_blank"]),C=i==QUESTION_TYPE_BLANK_DROPDOWN,S=i==QUESTION_TYPE_BLANK_DROPDOWN&&C&&check_in(o,["address"]),k=check_in(i,[QUESTION_TYPE_BLANK]),I=check_in(i,[QUESTION_TYPE_BLANK])&&!check_in(o,["short_answer"]),E=check_in(i,[QUESTION_TYPE_BLANK])&&check_in(o,["short_answer"]),O=i==QUESTION_TYPE_MULTIPLE_BLANK,N=check_in(i,[QUESTION_TYPE_BLANK,QUESTION_TYPE_MULTIPLE_BLANK])&&!check_in(o,["banked_cloze"]),U=check_in(i,[QUESTION_TYPE_MULTIPLE_BLANK,QUESTION_TYPE_BLANK])&&!check_in(o,["date","time","geographical_multiple_blank","upload_file"]),L=(f||d)&&1!=n,A=check_in(i,[QUESTION_TYPE_SCORE])&&!check_in(o,["nps_score","proportion","matrix_scale","evaluation","scale"]),Q=check_in(i,[QUESTION_TYPE_SCORE])&&"proportion"==o,M=check_in(i,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE]),z=(M||N)&&!check_in(o,["sex","date","time","mobile","name","email","geographical_multiple_blank","address","upload_file","cloze"]),D=check_in(i,[QUESTION_TYPE_MULTIPLE_BLANK])&&check_in(o,["upload_file"]),R=check_in(i,[QUESTION_TYPE_SCORE])&&check_in(o,["matrix_scale"]),B=R&&1!=n,Y=O&&(!o||check_in(o,["horz_blank"]))||k||S||check_in(i,[QUESTION_TYPE_MATRIX_BLANK]),F=check_in(i,[QUESTION_TYPE_MULTIPLE_BLANK])&&check_in(o,["horz_blank"]),H=i===QUESTION_TYPE_MULTIPLE_BLANK&&"cloze"===o,J=i===QUESTION_TYPE_CLASSIFICATION,X=i!==QUESTION_TYPE_CLASSIFICATION,G=J&&e.classification_img_list&&(e.classification_img_list.option_img_list&&e.classification_img_list.option_img_list.length>0||e.classification_img_list.extra_option_img_list&&e.classification_img_list.extra_option_img_list.length>0),K={isShowAllowNull:u,isShowQuestionType:v,isSingleQuestion:a,isMultipleQuestion:_,isShowOptionLayout:f,isShowOptionRandom:h,isShowOptionRelated:L,isShowSelectRange:_,isMatrixSelectQuestion:c,isShowOptionInput:q,isShowOptionOrder:g,isShowOptionSettings:w,isShowQuestionMatrix:b,isShowOptionMaxScore:x,isShowEvote:T,isAllowCorrectionPosition:j,isShowOptionProvincial:C,isShowOptionInputSize:y,isBlankQuestion:k,isBlanksQuestion:N,isOnlyBlankQuestion:I,isShortBlankQuestion:E,isScoreQuestion:A,isProportionQuestion:Q,isMoreBlankQuestion:O,isDescQuestion:r,isSingleMultiple:M,isSelectBlankQuestion:z,isBlankAndMoreBlankQuestion:U,isOnlySingleQuestion:s,isCascaderQuestion:p,isUploadFileQuestion:D,isContainBlank:Y,isAddressQuestion:S,isMatrixScale:R,isHorzBlank:F,isMatrixScaleShowOptionRelated:B,isBankedCloze:"banked_cloze"===o,isEvaluation:l(e),isCloze:H,isClassification:J,isFixLastOption:X,isShowImageEdit:G,isScaleQuestion:check_in(i,[QUESTION_TYPE_SCORE])&&check_in(o,["scale"]),isMatrixScaleOrScale:check_in(i,[QUESTION_TYPE_SCORE])&&check_in(o,["matrix_scale","scale"])};return console.log(K),K},P.is_show_question_or_option_setting=function(t,e,i){var o=$("#setting_main_wrap"),n=o.attr("qid"),a=o.attr("option-id");return("option"!==i||n!=t||a!=e)&&!("question"===i&&n==t&&!a)},P.show_option_setting=function(t,e,i,o,n){$(".option_hover").removeClass("option_hover"),$("#option_"+o).addClass("option_hover");var a=document.getElementById("option_setting_template").innerHTML,s={option:P.get_option(e,o),question_cid:i,option_cid:n,project:project};$.extend(s,P.format_question_data_for_setting(e));var _=juicer(a,s);P.show_setting_animate(t,_,{qid:e,"option-id":o})},P.update_question_object=function(t,e,i){if($("#question_"+t).find(".option_item .video-show-iframe").length>0?i.custom_attr.status="disabled":i.custom_attr.status="open","matrix_scale"==e||"scale"==e){var o={level_value:Number(i.custom_attr.max_answer_num||0)-Number(i.custom_attr.min_answer_num||0)+1};$.extend(i.custom_attr,o)}},P.show_question_setting=function(t,e,i){var o=document.getElementById("question_setting_template").innerHTML,n=P.get_question(e),a=n.custom_attr.disp_type,s=_.cloneDeep(n);P.delete_tag(s),P.update_question_object(e,a,s);var l={question:s,question_cid:i,project:project};$.extend(l,P.format_question_data_for_setting(e));var d=juicer(o,l);P.show_setting_animate(t,d,{qid:e,"option-id":""},a)},P.show_setting_animate=function(t,e,i,o){var n=t.attr("qid"),a=i?i.qid:"",s=P.get_question(a);n&&a!=n&&t.is(":visible")?t.velocity("stop").velocity({right:"-260px"},{duration:300,complete:function(n){e&&t.html(e).attr(i),$(n).velocity({right:"0px",opacity:1},{duration:300,complete:function(){"matrix_scale"==o||"scale"==o?Selector(".matrix_scale_wrap .w-select-2"):s.question_type==QUESTION_TYPE_CLASSIFICATION?Selector(".block_category .w-select-sm"):"evaluation"==o?Selector(".evaluation_score_select"):"banked_cloze"===o?Selector(".banked_cloze_setting .w-select"):"cloze"===o&&Selector(".cloze-score-rule")}})}}):!t.is(":visible")||t.css("right")<0?(e&&t.html(e).attr(i),t.css({opacity:0,display:"block"}).velocity("stop").velocity({right:"0px",opacity:1},{complete:function(){"matrix_scale"==o||"scale"==o?Selector(".matrix_scale_wrap .w-select-2"):s.question_type==QUESTION_TYPE_CLASSIFICATION?Selector(".block_category .w-select-sm"):"evaluation"==o?Selector(".evaluation_score_select"):"banked_cloze"===o?Selector(".banked_cloze_setting .w-select"):"cloze"===o&&Selector(".cloze-score-rule")}})):t.find(">div").velocity("stop").velocity({opacity:.5},{duration:200,complete:function(n){e&&t.html(e).attr(i),t.find(">div").css({opacity:.5}).velocity({opacity:1},{duration:200,complete:function(){"matrix_scale"==o||"scale"==o?Selector(".matrix_scale_wrap .w-select-2"):s.question_type==QUESTION_TYPE_CLASSIFICATION?Selector(".block_category .w-select-sm"):"evaluation"==o?Selector(".evaluation_score_select"):"banked_cloze"===o?Selector(".banked_cloze_setting .w-select"):"cloze"===o&&Selector(".cloze-score-rule")}})}})},P.hide_setting_animate=function(t){(t=t||$("#setting_main_wrap")).velocity("stop").velocity({right:"-260px",opacity:0},{complete:function(t){$(t).css({display:"none"}).attr({qid:"","option-id":""})}})},P.show_or_remove_open_input=function(t,e,i){var o=$("#question_"+t),n=$("#option_"+e),a=P.get_question(t);if(check_in(a.question_type,[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE])){var s=o.find(".option_table"),_=$("td",n.parent()).index(n)+1;"none"==i?s.find("tr:gt(0)").each(function(t,e){$(this).find("td:nth-child("+_+")").find(".open_input").remove()}):s.find("tr:gt(0)").each(function(t,e){$(this).find("td:nth-child("+_+")").append('<input type="text" name="" id="" class="open_input" readonly>')})}else n.find(".option_title").attr({"data-is-open":"none"==i?"false":"true"}),"none"==i?$("#input_vr_setting_option").hide():$("#input_vr_setting_option").show()},P.deferredFun=function(){var t=arguments,e=$.Deferred();return setTimeout(function(){var i=t[0](t[1],t[2],t[3],t[4],t[5],t[6]);e.resolve(i)},50),e.promise()},P.is_single_or_multiple=function(t){var e=QUESTION_DICT[t];if(e){var i=e?e.question_type:"",o=e.custom_attr.disp_type;return"matrix_scale"==o||!!check_in(i,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE])&&(!o||!!check_in(o,["vertical","transverse","column","dropdown","multiple_dropdown"]))}return!1},P.update_question_html=function(t,e){var i=P.get_question(t),o=P.get_question_html(i);$("#question_"+t).after(o).remove(),e.initQuestionEvent(t)},P.set_jumpconstraint_status=function(t){var e=get_question(t),i=!1;if(e){var o=e.jumpconstraint_id_list2.length,n=e.displayconstraint_id_list2.length;e.custom_attr.has_quota&&(i=!0);var a="";i?'<div class="quota_sign cq_qt_ts"><a target="_blank" href="/project/quota_setting/'+project._id.$oid+'"><i class="quota-icon-active"></i></a></div>':a='<span class="logic_num">'+(o+n)+"</span>",$(".module[oid="+t+"] .q_operate .btn_question_logic").append(a),0==o&&0==n?$(".module[oid="+t+"] .logic_num").remove():($(".module[oid="+t+"] .logic_num").show(),$(".module[oid="+t+"] .q_operate .btn_question_logic").css("display","inline-block"))}},P.init_matrix_td_width=function(t){var e=$("#question_"+t),i=$("table tr:eq(0) td",e),o=100/i.length,n=$("table",e).width();i.each(function(t,e){var i=$(this).find(".td_wrap"),a=parseFloat(i.css("paddingLeft"))+parseFloat(i.css("paddingRight"))+1;i.css("width",parseInt(o/100*n-a)+"px")})},P.set_matrix_td_width=function(t,e){var i=0,o=$("#question_"+t+" .option_table");o.find("tbody:eq(0) tr").each(function(t){var o=$(this);o.children("td").each(function(n){var a=parseFloat(o.css("paddingLeft"))+parseFloat(o.css("paddingRight"))+1;null==e[n]&&(e[n]=e[n-1]);var s=$(this).find(".td_wrap"),_=parseFloat(s.css("paddingLeft"))+parseFloat(s.css("paddingRight"))-10;s.css("width",parseInt(e[n])-_+"px"),0===t&&(i+=e[n]+a)})}),o.width(i)},P.matrix_option_operate=function(t,e,i,o,n){if(console.log("tttttype",o),check_in(o,["move_left","move_right","move_up","move_down"])){var a=check_in(o,["move_left","move_up"])?"up":"down";P.is_option_can_move(t,e,a,n)&&("row"==i?P.move_matrixrow(t,e,a,function(){P.update_matrix_option_sort(e,o)}):P.move_option(t,e,a,function(){P.update_matrix_option_sort(e,o)}))}else if("setting"===o){var s=$("#question_"+t),_=$("#option_"+e),l=(t=s.attr("oid"),_.attr("oid")),d=$("#setting_main_wrap"),r=s.find(".q_seq").text(),c=_.index();P.is_show_question_or_option_setting(t,l,"option")&&P.show_option_setting(d,t,r,l,c)}else if("delete"===o)if($("#question_option_operate").remove(),"row"===i)$.when(P.delete_matrixrow(t,e)).done(function(){$("#option_"+e).parent().remove()});else{var p=$("#question_"+t).find(".option_table"),u=$("#option_"+e),m=u.parent();if($("#question_"+t).find(".option_table").length<=0)m=p=$("#question_"+t).find(".q_option_ul");var v=$("td",m).index(u);$.when(P.delete_option(t,e,!0)).done(function(){P.get_question(t);P.check_update_option_select(t),$("tr",p).each(function(t,e){t>0&&$(this).find("td:eq("+v+")").remove()})})}},P.update_matrix_option_sort=function(t,e){var i=$("#option_"+t),o=i.parent(),n=o.parent(),a=$("td",o).index(i),s=$("tr",n).index(o);"move_left"===e?$("tr",n).each(function(t,e){var i=$(this).find("td:eq("+a+")");$(this).find("td:eq("+(a-1)+")").before(i)}):"move_right"===e?$("tr",n).each(function(t,e){var i=$(this).find("td:eq("+a+")");$(this).find("td:eq("+(a+1)+")").after(i)}):"move_up"===e?(n.find("tr:eq("+(s-1)+")").before(o),i.prev(".option_item").before(i)):"move_down"===e&&(n.find("tr:eq("+(s+1)+")").after(o),i.next(".option_item").after(i))},P.is_option_can_move=function(t,e,i,o){var n=$("#option_"+e),a=n.parent(),s=a.parent(),_=$("td",a).index(n),l=$("tr",s).index(a);if(o){var d=1;return a.find(".related_question_display").length>0&&(d=2),a.children(".option_item").eq(d).html()==n.html()&&"up"===i?(loadMack({off:"on",Limg:0,text:"宸茬粡鏄涓€涓€夐」",set:800}),!1):a.children(".option_item:last-child").html()!=n.html()||"down"!==i||(loadMack({off:"on",Limg:0,text:"宸茬粡鏄渶鍚庝竴涓€夐」",set:800}),!1)}return"up"!==i||1!==_&&1!==l?"down"!==i||_!=$("td",a).length-1&&l!==$("tr",s).length-1||(loadMack({off:"on",Limg:0,text:"宸茬粡鏄渶鍚庝竴涓€夐」",set:800}),!1):(loadMack({off:"on",Limg:0,text:"宸茬粡鏄涓€涓€夐」",set:800}),!1)},P.checkEditStatus=function(t){$.ajax({type:"GET",url:"/edit/ajax/check_status_for_edit/?pid="+get_oid(project),dataType:"JSON",success:function(t){t.user_online?console.log("user is online"):(console.warn("user is offline"),jsAlert({content:'<p style="text-align:left;">鐧诲綍瓒呮椂, 璇烽噸鏂扮櫥褰�</p>',obj:function(){window.location.href="/login/"}})),t.can_edit?console.log("this project can be edited"):jsAlert({content:'<p style="text-align:left;">浣犵殑闂嵎宸插湪鍏朵粬椤甸潰鍙戝竷鎴愬姛锛屽闇€淇敼锛岃鐐瑰嚮缂栬緫鎸夐挳銆�</p>',obj:function(){window.location.href="/mysurvey/"}})}})},P.question_setting_checking=function(t,e){$.ajax({url:"/edit/question_setting/logic/check/",type:"get",data:{project_id:get_oid(project)},success:function(i){if(i.status=1==i.status_code&&0==i.data.can_setting){var o="璇ラ」鐩凡寮€鍚殢鏈烘娊棰樿缃紝鏆備笉鏀寔鍚屾椂寮€鍚�"+t+"鍔熻兘锛�";"disrupt"==i.data.check_type&&(o="璇ラ」鐩凡寮€鍚墦涔遍鐩『搴忚缃紝鏆備笉鏀寔鍚屾椂寮€鍚�"+t+"鍔熻兘锛�"),P.abnormal_tips_pop(o)}e&&e(i)}})},P.operation_question_checking=function(t,e,i){$.ajax({url:"/edit/question_setting/check/",type:"get",data:{question_id:t},success:function(t){if(t.status=1==t.status_code&&0==t.data.can_change){var o="宸插弬涓庨殢鏈烘娊棰橈紝"+e;"disrupt"==t.data.check_type&&(o="宸插弬涓庢墦涔遍鐩『搴忥紝"+e),P.abnormal_tips_pop(o)}i&&i(t)}})},P.abnormal_tips_pop=function(t){var e=new Popup({head:{inner:"<i></i>鏃犳硶璁剧疆",class:"abnormal_tips"},content:{inner:t},btnRight:"鎴戠煡閬撲簡",isFixed:!1,btnAlign:"right",showMask:!0,maskClickClose:!0,showCloseBtn:!0,noScroll:!1,popupType:"confirm",onClose:function(){e.destroy()},onRightClick:function(){e.destroy()}});e.show()},P.question_operate_del=function(t){var e=P.get_page_count(t);if(P.is_single_or_multiple(t)&&RELATED_QUESTION_DICT[t]&&RELATED_QUESTION_DICT[t].length>0)loadMack({off:"on",Limg:0,text:"褰撳墠棰樼洰閫夐」宸插叧鑱斿叾浠栭鐩紝涓嶈兘鍒犻櫎",set:1500});else{var i={page_count:e,oid:t};jsConfirm({title:"鍒犻櫎棰樼洰纭",obj:P.delete_question,Param:i,conw:400})}},P.logic_setting=function(t){document.body.onmousewheel=function(t){return t=t||window.event,!1};var e=P.get_question(t),i=$(".module[oid="+t+"]"),o='<div class="logic_set_tab"><a class="tab_tit header_jump tab_active">璺宠浆閫昏緫</a><a href="https://www.wenjuan.com/helpcenter/list/5232da3989c0971aa67264b0/h35b558469a320fc74a5e4ae24" target="_blank" class="help_btn"><div class="icon help t3 show_title" data-title="绗﹀悎鏈鏌愰」鏉′欢,鍒欒烦杞嚦鏌愰亾棰�</br>鐐瑰嚮鏌ョ湅甯姪"></div></a><a class="tab_tit header_display">鏄剧ず閫昏緫</a><a href="https://www.wenjuan.com/helpcenter/list/5232da3989c0971aa67264b0/h35b7cd130a320fc7d120bfa30" target="_blank" class="help_btn"><div class="icon help t3 show_title" data-title="绗﹀悎鏌愰」鏉′欢锛屽垯鏄剧ず鏈</br>鐐瑰嚮鏌ョ湅甯姪"></div>';"Q1"==e.cid&&(o='<div class="logic_set_tab"><a class="tab_tit header_jump tab_active">璺宠浆閫昏緫</a><a href="https://www.wenjuan.com/helpcenter/list/5232da3989c0971aa67264b0/h35b558469a320fc74a5e4ae24" target="_blank" class="help_btn"><div class="icon help t3 show_title" data-title="绗﹀悎鏈鏌愰」鏉′欢,鍒欒烦杞嚦鏌愰亾棰�</br>鐐瑰嚮鏌ョ湅甯姪"></div></a>'),$.ajax({url:"/edit/ajax_logic/question/get_jumplogic_list/"+get_oid(project)+"/?qid="+i.attr("oid")+"&pid="+get_oid(project)+"&ts="+(new Date).getTime(),type:"get",success:function(e){$.ajax({url:"/edit/ajax_logic/question/get_displaylogic_list/"+get_oid(project)+"/?qid="+i.attr("oid")+"&pid="+get_oid(project)+"&ts="+(new Date).getTime(),type:"get",success:function(i){var n={data1:e,data2:i},a=juicer($("#option_tz_template").html(),n);new jsbox({onlyid:"maptss",title:o,conw:850,content:a,FixedTop:170,loads:!0,range:!1,mack:!0}).show();if($("#jump_table .jumpconstraint").length>1||1==$("#jump_table .jumpconstraint").length?$(".tab_jump").find(".btn-wrapper").hide():$(".tab_jump").find(".btn-wrapper").show(),$(".header_jump").click(function(){$(this).addClass("tab_active"),$(".header_display").removeClass("tab_active"),$(".tab_jump").removeClass("tab_hidden"),$(".tab_display").addClass("tab_hidden"),$(".tccCon_t tr.jumpconstraint").show()}),$(".header_display").click(function(){$(this).addClass("tab_active"),$(".header_jump").removeClass("tab_active"),$(".tab_display").removeClass("tab_hidden"),$(".tab_jump").addClass("tab_hidden"),$(".tccCon_t tr.jumpconstraint").hide()}),jump_page_cot>2){a=juicer($("#jump_page_template").html(),{jump_page_cot:jump_page_cot,page:page});$("#jump_list_form .alignr").before(a),$(".jsboxContent").attr("oid",t),P.jump_arrow_hide()}if(display_page_cot>2){a=juicer($("#display_page_template").html(),{display_page_cot:display_page_cot,page:page});$("#display_list_form .alignr").before(a),$(".jsboxContent").attr("oid",t),P.display_arrow_hide()}0==display_count?$(".display_header .xs_num").text(display_count+1):$(".display_header .xs_num").text(display_count),0==jump_count?$(".jump_header .tz_num").text(jump_count+1):$(".jump_header .tz_num").text(jump_count)}})}})},P.jump_page=function(t,e,i){var o=(new Date).getTime();$.ajax({url:"/edit/ajax_logic/question/get_jumplogic_list/"+e+"/",type:"get",data:{qid:t,ts:o,page:i},success:function(t){$(".tab_jump").html(t);var e=juicer($("#jump_page_template").html(),{jump_page_cot:jump_page_cot,page:page});$(".display_header .xs_num").text(display_count),$(".jump_header .tz_num").text(jump_count),$("#jump_list_form .alignr").before(e),P.jump_arrow_hide()}})},P.display_page=function(t,e,i){var o=(new Date).getTime();$.ajax({url:"/edit/ajax_logic/question/get_displaylogic_list/"+e+"/",type:"get",data:{qid:t,ts:o,page:i},success:function(t){$(".tab_display").html(t);var e=juicer($("#display_page_template").html(),{display_page_cot:display_page_cot,page:page});$("#display_list_form .alignr").before(e),$(".display_header .xs_num").text(display_count),$(".jump_header .tz_num").text(jump_count),P.display_arrow_hide()}})},P.jump_arrow_hide=function(){$("#jump_list_form .jump_paging_active").text()==$(".paging .opt_page").length-2?$("#jump_list_form .right_arrow").addClass("arrow_hidden"):$("#jump_list_form .right_arrow").removeClass("arrow_hidden"),1==$("#jump_list_form .jump_paging_active").text()?$("#jump_list_form .left_arrow").addClass("arrow_hidden"):$("#jump_list_form .left_arrow").removeClass("arrow_hidden")},P.display_arrow_hide=function(){$("#display_list_form .display_paging_active").text()==$(".paging .display_page").length-2?$("#display_list_form .right_arrow").addClass("arrow_hidden"):$("#display_list_form .right_arrow").removeClass("arrow_hidden"),1==$("#display_list_form .display_paging_active").text()?$("#display_list_form .left_arrow").addClass("arrow_hidden"):$("#display_list_form .left_arrow").removeClass("arrow_hidden")},P.option_setting=function(t){document.body.onmousewheel=function(t){return t=t||window.event,!1};var e,i,o,n,a=get_oid(project);e=600,i="閫夐」鍏宠仈",o="/edit/ajax/q_relation_list/"+a+"/?question_id="+t+"&v="+(new Date).getTime(),new jsbox({onlyid:n||"maptss",title:i,conw:e,FixedTop:170,loads:!0,url:o,range:!1,mack:!0}).show()},P.quote_setting=function(t,e,i){document.body.onmousewheel=function(t){return t=t||window.event,!1},function(t,e,i,o){i||(i=500);new jsbox({onlyid:"maptss",title:t,conw:i,url:e,loads:!0,range:!0,mack:!0}).show()}("寮曠敤璁剧疆","/edit/ajax/autoreplace_set/"+i+"/?oid="+t+"&pid="+i+"&type="+e+"&ts="+(new Date).getTime(),"600")},P.question_operate_clone=function(t,e){if(!((new Date).getTime()-eventEndTime<200)){var i=$("#question_"+t),o=$("#question_box .question").index(i);P.copy_question(t,o,function(t){var n=t.new_q_struct.questionpage_id,a=t.new_q_struct,s=a._id.$oid;a.extra_data={},a.extra_data.sms_quota=t.extra_data.sms_quota,P.question_create_update(n,a,o+1);var _=P.get_question_html(a);P.hide_add_question_tip($("#question_box")),i.after($(_)),e.initQuestionEvent(s),P.update_question_cid(),i.removeClass("question_focus"),2==project.p_type&&P.calculation_project_total_score(),$("html,body").animate({scrollTop:$("#question_"+s).offset().top-50},"slow"),$("#question_"+s).click(),$(".loadCon,.loadMack").remove(),eventEndTime=(new Date).getTime()})}},P.init_question=function(t,e){var i=parseInt($(".prefix_content").width()),o=parseInt(i/1.78);$(".prefix_content").find(".video-show-iframe").css({width:i+"px",height:o+"px"});for(var n=0;n<project.questionpage_id_list.length;n++){var a=project.questionpage_id_list[n],s=P.get_questionpage(a);if(project.questionpage_id_list.length>1){var _={pageNum:n+1,totalPage:project.questionpage_id_list.length,one_page_one_question:project.custom_attr.one_page_one_question},l=juicer(m.pageTemplate,_);t.append(l)}for(var d=0;d<s.question_id_list.length;d++){var r=s.question_id_list[d],c=P.get_question(r),p=null;try{c.custom_attr.hide||(p=P.get_question_html(c))}catch(t){console.warn("qmodel_"+c.question_type+" has an error: "+t.toString());continue}t.append(p),P.getIframeBox(c,r),e.initQuestionEvent(r),isNotEmpty(c.jumpconstraint_id_list2)||isNotEmpty(c.displayconstraint_id_list2),P.set_jumpconstraint_status(get_oid(c)),P.is_matrix_question(c)&&(P.init_matrix_td_width(get_oid(c)),"col_width"in c.custom_attr&&P.set_matrix_td_width(get_oid(c),c.custom_attr.col_width.parseJSON())),init_related_question_dict(c)}}P.show_or_hide_add_question_tip(t),P.init_question_cid(),2==project.p_type&&P.calculation_project_total_score()},P.get_format_data=function(t){var e=parseFloat(t);if(!isNaN(e))return e=Math.round(10*e)/10},P.calculation_project_total_score=function(){for(var t=0,e=0,i=0,o=0,n=0;n<project.questionpage_id_list.length;n++)for(var a=project.questionpage_id_list[n],s=P.get_questionpage(a),_=0;_<s.question_id_list.length;_++){var l=s.question_id_list[_],d=P.get_question(l);d&&(i=d.question_min_score?parseFloat(d.question_min_score):"0",o+=parseFloat(i),t=d.question_max_score?parseFloat(d.question_max_score):"0",e+=parseFloat(t))}o=P.get_format_data(o),(e=P.get_format_data(e))&&0!=e?($(".survey_main_wrap .evaluation_total_score").removeClass("hide"),$(".survey_main_wrap .evaluation_total_score .total_score").text(e)):$(".survey_main_wrap .evaluation_total_score").addClass("hide");var r={score_scope:o+"~"+e};return window.project_check?syncPost("/assess/proj_score_scope/"+project_id,r,function(){}):ajaxPost("/assess/proj_score_scope/"+project_id,r,function(){}),{totalMaxScore:e,totalMinScore:o}},P.get_substr_value=function(t){var e=new RegExp('<span class="(evaluation_score|option_score|right_key)( hide)?">\\((鏈€楂樺垎鍊硷細\\d+(.5)?鍒唡鍒嗗€硷細(-)?\\d+(.5)?鍒唡姝ｇ‘绛旀)\\)</span>',"g");return t=t.replace(e,"")},P.save_project_content_editable_handler=function(t){var e=t.html(),i=t.attr("edit-type"),o=get_oid(project);e=P.get_substr_value(e);var n=P.get_old_title(i);if(""!=t.text().trim()||check_in(i,["begin_desc","end_desc","screenout_desc"])){if(e!=n){if(P.save_title(e,i,o),"screenout_desc"==i)project.custom_attr.screenout_desc=e;else if("project"==i){project.title=e;var a=t.text().replace(/\s/g,"");$(".header-edit-title").html(a),$(".header_wrap .wj_title").html(a)}else project[i]=e;P.showEndDescPlaceHolder(t)}}else t.html(n)},P.save_question_content_editable_handler=function(t,e,i,o){var n=i.html(),a=i.closest(".option_item"),s=i.attr("edit-type"),_=P.format_data_to_obj(e,"desc",n),l="option"==s||"extra_option"==s||"row"==s||"col"==s||"optiondescription"==s?a.attr("oid"):e;if(i.attr("contenteditable",!1),n=P.get_substr_value(n),"desc"!=s){if("option"==s||"extra_option"==s){if("banked_cloze"===P.get_question(e).custom_attr.disp_type){var d=i.closest(".stem_option_item");l=d.attr("oid"),d.find(".content_editable").removeClass("editable_focus"),d.find(".stem_option").attr("contenteditable",!1)}else a.removeClass("option_focus"),a.parents(".q_option_ul").length>0&&a.find(".option_title").attr("contenteditable",!1)}else{if("horz_blank_content"==s)return a.find(".content_editable").removeClass("editable_focus"),void P.save_horz_blank(e,n);if("stem_content"===s)return i.closest(".stem_content_item").find(".stem_content").attr("contenteditable",!1),void(window.isInsertBankedCloze||P.saveStemContent(e));if("cloze_content"===s)return a.find(".content_editable").removeClass("editable_focus"),void(window.isInsertCloze||P.saveClozeContent(e))}if("new"==a.attr("id")){if(""==n)return;var r=new Array(n),c=P.get_option_list_formatted(e,r);"option"==s?P.create_option(e,c,function(t){a.remove(),P.create_option_callback(e,t)}):"row"==s?P.create_matrixrow(e,c,function(t){a.closest("tr").remove(),P.create_option_callback(e,t,s)}):"col"==s&&P.create_option(e,c,function(t){var i=$("#question_"+e).find(".option_table"),o=i.find("tr:first td").length;i.find("tr").each(function(t,e){$(this).find("td:nth-child("+o+")").remove()}),P.create_option_callback(e,t,s)})}else if("optiondescription"==s){var p=i.text().trim();delete_html_tag(n)&&(p||-1!=n.indexOf("<img"))||(n=""),P.save_title(n,s,l,o)}else{var u=P.get_old_title(s,e,l);""==n?i.html(u):n!=u&&(s="col"==s?"option":s,P.save_title(n,s,l,o))}}else""==n?t.find('.q_more_setting .label_checkbox[data-key="desc"]>input[type=checkbox]').trigger("click"):P.save_question_setting(_)},P.regular_expression_matching=function(t,e){return e?0!=(t=t.replace(/[^\d.-]/g,"")).lastIndexOf("-")&&-1!=t.lastIndexOf("-")&&(t=t.slice(0,t.length-1)):t=t.replace(/[^\d.]/g,""),t=(t=(t=(t=t.replace(/^\./g,"")).replace(".","$#$").replace(/\./g,"").replace("$#$",".")).replace(/\.[0-46-9]/g,".")).replace(/\.5[0-9]/g,".5")},P.answer_analysis_limit=function(t,e){if(e.hasClass("limit_num")){if(t.length>200)return e.val(t.substring(0,200)),void e.siblings(".error_tips").removeClass("hide")}else{var i=e.data("max-input-num"),o=i&&parseInt(i)?parseInt(i):500;if(t.length>o)return e.val(t.substring(0,o)),void e.siblings(".error_tips").removeClass("hide")}e.siblings(".error_tips").addClass("hide")},P.save_title=function(t,e,i,o,n){var a={type:e,content:t,oid:i};P.ajaxPost("/edit/ajax/save_content/"+get_oid(project),a,function(a){if("option"==e||"extra_option"==e){var s=!1;if((l="extra_option"==e?P.get_extra_option(a.qid,i):P.get_option(a.qid,i)).title!=t&&(s=!0),l.title=t,s&&update_question_relation_option(a.qid),(_=get_question(a.qid)).question_type===QUESTION_TYPE_CLASSIFICATION)P.setUploadImgStatus(a.qid,t),P.updateImgList(a.qid,i,t,e,a.img_name);else if("banked_cloze"===_.custom_attr.disp_type&&"extra_option"===e){var _=get_question(a.qid);return void P.updateAnswerSetting(a.qid)}}else if("row"==e){P.get_matrixrow(a.qid,i).title=t}else if("question"==e){(_=P.get_question(i)).title=t}else if("optiondescription"==e){var l;(l=P.get_option(a.qid,i)).custom_attr.description=a.content,P.update_question_html(a.qid,o),$("#question_box .question[oid = "+a.qid+"]").addClass("question_focus")}a.qid&&P.question_answer_score_template(a.qid),n&&n()})},P.get_check_label_status=function(t,e,i){return"change_qtype"==e?i:"on"==i?"none":"on"},P.format_data_to_obj=function(t,e,i,o){var n={project_id:get_oid(project),question_id:t,attr_key:e,attr_value:i};return o&&(n.option_id=o),n},P.saveQuestionSettingHandle=function(t,e,i,o,n){P.save_question_setting(t,function(){P.update_question_html(e,n),$("#question_"+e).addClass("question_focus"),2==project.p_type&&(P.question_answer_score_template(e,i,o),P.calculation_project_total_score())})},P.saveScaleQuestionSettingHandle=function(t,e,i,o,n){P.save_question_setting(t,function(){if(P.update_question_html(e,n),$("#question_"+e).addClass("question_focus"),2==project.p_type&&(P.question_answer_score_template(e,i,o),P.calculation_project_total_score()),P.question_options_title_template(e,i,o),"scale_tag"==i){var t=P.get_question(e).custom_attr.options_title_switch;console.log("optionsTitleSwitch",t);var a=Number(o),s=isNaN(a)?"enable":"";!isNaN(a)&&"on"==t&&$(".option-titles-setting .btn_switch").click(),isNaN(a)?$(".option-titles-setting").show():$(".option-titles-setting").hide(),$(".option-titles-setting .btn_switch").removeClass("enable").addClass(s)}})},P.save_question_setting=function(t,e){P.ajaxPost("/edit/ajax_question_set/",t,function(t){if(200==t.status&&1==t.status_code){var i=t.data.question,o=i._id.$oid;QUESTION_DICT[o]=i,QMODEL_DICT[o]=null,e&&e()}else window.location.reload()})},P.save_project_setting=function(t,e){ajaxPost("/project/ajax_collect_setting/",t,function(t){200==t.status?e&&e(t):window.location.reload()})},P.save_address_option_setting=function(t,e){for(var i in t)"string"!=typeof t[i]&&(t[i]=JSON.stringify(t[i]));console.log("save_address_option_setting",t),P.ajaxPost("/edit/ajax_question_batchset/",t,function(t){if(200==t.status){var i=t.data.question,o=i._id.$oid;QUESTION_DICT[o]=i,QMODEL_DICT[o]=null,e&&e(t)}})},P.save_evaluation_question_setting=function(t,e,i,o,n){if(n){var a=n.attr("oid"),s=n.siblings(".dividing_value").children("input");if(n.hasClass("answer_score_ico"))if(n.toggleClass("selected"),n.hasClass("selected")){l=(l=s.val())||"none",i=toJSONString({correct_answer:"1",score:l});_=P.format_data_to_obj(t,e,i,a)}else{i=toJSONString({correct_answer:"0",score:"0"});var _=P.format_data_to_obj(t,e,i,a)}else{var l;l=(l=n.val())||"none",i=toJSONString({correct_answer:"1",score:l});_=P.format_data_to_obj(t,e,i,a)}}else{a=$(".only_answer option[value="+i+"]").attr("oid");i=0!=parseInt(i)?toJSONString({correct_answer:"1",score:"0"}):"none";_=P.format_data_to_obj(t,e,i,a)}P.save_question_setting(_,function(){if(P.question_answer_score_template(t,e,i),P.update_question_html(t,o),2==project.p_type&&P.calculation_project_total_score(),$("#question_"+t).addClass("question_focus"),$(".select_box .dividing_value input.evaluation_input").hasClass("answer_option_score")&&(n.hasClass("answer_option_score")||!n.hasClass("selected"))){for(var a=P.get_question(t),s=a.option_list.length,_=0,l=0;l<s;l++)_+=a.option_list[l].custom_attr.score?parseFloat(a.option_list[l].custom_attr.score):0;$('.dividing_value input[data-key="total_score"]').val(_),$('.dividing_value input[data-key="total_score"]').blur()}})},P.save_question_score=function(t,e,i,o,n){var a=n.attr("oid"),s=P.format_data_to_obj(t,e,i,a),_=P.get_question(t);if(n.hasClass("answer_option_score")){for(var l=_.option_list.length,d=Number(n.val()),r=0,c=0;c<l;c++)r+=_.option_list[c].custom_attr.score?parseFloat(_.option_list[c].custom_attr.score):0;if(r>d)return $(".evaluation_error_tip").removeClass("hide"),!1}else if(n.hasClass("answer_total_score")){var p=_.custom_attr.keywords_score?_.custom_attr.keywords_score:"",u=$(".answer_analysis_cot").val();d=Number(n.val());if(u)var m=u.split(";"),v=""==m[(l=m?m.length:"")-1]?l-1:l;if((v?p*v:p)>d)return $(".evaluation_error_tip").removeClass("hide"),!1}P.save_question_setting(s,function(){$(".evaluation_error_tip").addClass("hide"),P.update_question_html(t,o),P.question_answer_score_template(t,e,i),$("#question_"+t).addClass("question_focus"),2==project.p_type&&P.calculation_project_total_score()})},P.get_score_template_id=function(t){var e=P.get_question(t);return("6"==e.question_type||"95"==e.question_type?"blanks":"choice")+"_answerscore_setting_template"},P.delete_tag=function(t){for(var e=0;e<t.option_list.length;e++){var i=t.option_list[e].title,o=new RegExp("<[^>]*>","g");i=i.replace(o,""),t.option_list[e].title=i}if(t.extra_option_list)for(e=0;e<t.extra_option_list.length;e++){i=t.extra_option_list[e].title,o=new RegExp("<[^>]*>","g");i=i.replace(o,""),t.extra_option_list[e].title=i}},P.question_answer_score_template=function(t,e,i){var o=P.get_score_template_id(t),n=document.getElementById(o).innerHTML,a=P.get_question(t),s=a.custom_attr.disp_type,l=_.cloneDeep(a);P.update_question_object(t,s,l),P.delete_tag(l),e&&(l.custom_attr[e]=i);var d={question:l};$.extend(d,P.format_question_data_for_setting(t));var r=juicer(n,d);$("#evaluation_score").html(r)},P.question_options_title_template=function(t,e,i){var o=document.getElementById("options_title_setting_template").innerHTML,n=P.get_question(t),a=n.custom_attr.disp_type,s=_.cloneDeep(n);P.update_question_object(t,a,s),P.delete_tag(s),e&&(s.custom_attr[e]=i);var l={question:s};$.extend(l,P.format_question_data_for_setting(t));var d=juicer(o,l);$(".option-titles-wrapper").html(d)},P.save_option_setting=function(t,e,i,o){var n={project_id:get_oid(project),option_id:t,attr_key:e,attr_value:i};console.log("save_option_setting",n),P.ajaxPost("/edit/ajax_option_set/",n,function(t){if(200==t.status){var e=t.data.question,i=e._id.$oid;QUESTION_DICT[i]=e,o&&o()}})},P.save_extra_option_setting=function(t,e,i,o){var n={project_id:get_oid(project),extra_option_id:t,attr_key:e,attr_value:i};P.ajaxPost("/edit/ajax_extra_option_set/",n,function(t){if(200==t.status){var e=t.data.question,i=e._id.$oid;QUESTION_DICT[i]=e,o&&o()}})},P.save_option_sort=function(t,e,i){var o={question_id:t,option_id_list:toJSONString(e)};console.log("save_option_sort",o),P.ajaxPost("/edit/ajax_option_move/",o,function(t){if(200==t.status){var e=t.data.question,o=e._id.$oid;QUESTION_DICT[o]=e,P.update_setting_main_seq(),i&&i()}})},P.get_new_option_title=function(t,e,i){var o=P.get_question(t),n=o.question_type,a=o.custom_attr.disp_type,s=P.is_matrix_question(o)&&"row"==e,_="extra_option"==e,l=(s?o.matrixrow_list:_?o.extra_option_list:o.option_list).map(function(t){return i?"鍏朵粬":t.title}),d=new P.Name_deal;d.ErdogicFn(l);var r=d.DealFn(),c={};c[QUESTION_TYPE_MATRIX_SCORE]="鎵撳垎",c[QUESTION_TYPE_MATRIX_BLANK]="濉┖",c[QUESTION_TYPE_MULTIPLE_BLANK]="banked_cloze"===a?"閫夐」":"濉┖",c[QUESTION_TYPE_SCORE]="matrix_scale"==a?"鏍囬":Object(k.f)(o)?"姣旈噸":"閫夐」",c[QUESTION_TYPE_CLASSIFICATION]=_&&n===QUESTION_TYPE_CLASSIFICATION?"绫诲埆":"閫夐」";var p=s?"鐭╅樀琛�":c[n]?c[n]:"閫夐」";return i?"鍏朵粬":p+r},P.add_single_option=function(t,e){var i=$("#question_"+t),o=P.get_question(t),n=P.get_new_option_title(t,"",e),a=P.get_option_list_formatted(t,[n],e);if(o.question_type==QUESTION_TYPE_SCORE&&"proportion"==o.custom_attr.disp_type){var s=o.option_list.length,_=P.checkChangeOptionNum(t,s+1);if(!_.isSuccess)return Toast.hidden(),void Toast({message:_.errMsg,maxWidth:"360px"})}P.create_option(t,a,function(n){if(P.create_option_callback(t,n,"col"),P.is_matrix_question(o)){e&&P.matrix_option_operate(t,n.option_id_list[0],"col","setting");var a=i.find(".option_table"),s=a.parent();s.scrollLeft(a.outerWidth()-s.width())}else e&&i.find(".btn_option_setting:last").click();if(o.question_type===QUESTION_TYPE_CLASSIFICATION){var _=i.find(".q_option_list .q_option_wrap");_.scrollTop(_[0].scrollHeight),setTimeout(function(){var t=n.option_list[n.option_list.length-1]._id.$oid;i.find("#option_"+t+" .option_title").focus(),document.execCommand("selectAll",!1,null)})}else{var l=n.option_list[n.option_list.length-1]._id.$oid;i.find("#option_"+l+" .option_title").focus(),document.execCommand("selectAll",!1,null)}})},P.add_single_row=function(t){var e=$("#question_"+t),i=(P.get_question(t),P.get_new_option_title(t,"row")),o=P.get_option_list_formatted(t,[i]);P.create_matrixrow(t,o,function(i){P.create_option_callback(t,i,"row"),e.find(".option_table_wrap").scrollLeft(0);var o=i.row_list[i.row_list.length-1]._id.$oid;e.find("#option_"+o+" .option_title").focus(),document.execCommand("selectAll",!1,null)})},P.add_many_options=function(t,e,i){var o=P.get_question(e),n=o.question_type,a=o.option_list;P.is_matrix_question(o)&&"row"==i&&(a=o.matrixrow_list);var s=a.map(function(t){return t.title});P.show_batch_add_option_popup(t,n,e,i,s,"鎵归噺娣诲姞閫夐」")},P.show_batch_add_option_popup=function(t,e,i,o,n,a){var s;s=t.offset().left+600>=$(window).width()?"right":"left";var _="",l="",d=P.match_text_remove(n);if(d){for(var r=0;r<n.length;r++)_+=n[r]+"\r";l="color_gray"}var c={qid:i,question_type:e,def_option:_=d?_:"",color_gray:l,type:o},p=juicer($("#add_option_tpl").html(),c);jsBubble.show({obj:t,data:p,type:s,pyleft:0,pytop:-3,title:a||t.attr("title"),width:"500px",BoColor:"#fff",BaColor:"#fff",CBaColor:"#fff",TBaColor:"#fff",Close:!0,zIndex:99}),$(".new_poplayer[qid="+i+"] textarea").on("click",function(t){t.stopPropagation(),$(this).hasClass("color_gray")&&$(this).html("").removeClass("color_gray")})},P.match_text_remove=function(t){var e=!0,i=/^(閫夐」|鐭╅樀琛寍璇锋墦鍒唡璇峰～绌�)(\d+)$/;if(t.length>0&&t.length<=2)for(var o=0;o<t.length;o++){if(i.test(t[o]))parseInt(t[o].match(i)[2])!=o+1&&(e=!1);else e=!1}else e=!1;return e},P.add_batch_matrix_row_option=function(t,e){var i=P.get_option_list_formatted(t,e),o=P.get_question(t),n=$.map(o.matrixrow_list,function(t){return t.title});if(isNotEmpty(n)&&P.match_text_remove(n)){var a=$.map(o.matrixrow_list,function(t){return get_oid(t)});$.when(P.delete_matrixrow(t,a)).done(function(){P.create_matrixrow(t,i,function(e){a.forEach(function(t){$("#option_"+t).parent().remove()}),P.create_option_callback(t,e,"row")})})}else P.create_matrixrow(t,i,function(e){P.create_option_callback(t,e,"row")})},P.add_batch_matrix_col_option=function(t,e){var i=P.get_option_list_formatted(t,e),o=P.get_question(t),n=$.map(o.option_list,function(t){return t.title});if(isNotEmpty(n)&&P.match_text_remove(n)){var a=$.map(o.option_list,function(t){return get_oid(t)});$.when(P.delete_option(t,a)).done(function(){P.create_option(t,i,function(e){var i=$("#question_"+t).find(".option_table");a.forEach(function(t){var e=$("#option_"+t);if(P.is_matrix_question(o)){var n=e.parent(),a=$("td",n).index(e);$("tr",i).each(function(t,e){$(this).find("td:eq("+a+")").remove()})}else e.remove()}),P.create_option_callback(t,e,"col")})})}else P.create_option(t,i,function(e){P.create_option_callback(t,e,"col")})},P.create_option_callback=function(t,e,i){var o=P.get_question(t);P.is_matrix_question(o)?"col"==i?(P.render_matrix_col(t,e.option_list),P.init_matrix_td_width(t)):"row"==i&&P.render_matrixrow(t,e.row_list):"extra_option"==i?P.renderExtraOption(t,e.extra_option_list):P.render_option(t,e.option_list),P.update_option(t,e),P.check_update_option_select(t),P.question_answer_score_template(t),o.question_type===QUESTION_TYPE_CLASSIFICATION&&P.updateFirstOption(t,i),verify_question_option.hide(t)},P.add_batch_option=function(t,e){$("#question_"+t);var i=P.get_question(t),o=$(".new_poplayer[qid="+t+"] textarea").val(),n=o?o.split("\n"):[],a=[];if(n.forEach(function(t){isNotEmpty(t)&&a.push(t)}),P.is_batch_title_valid(a)){if(i.question_type==QUESTION_TYPE_SCORE&&"proportion"==i.custom_attr.disp_type){var s=$.map(i.option_list,function(t){return t.title}),_=a.length;P.match_text_remove(s)||(_=s.length+_);var l=P.checkChangeOptionNum(t,_);if(!l.isSuccess)return void $(".new_poplayer .err_msg").text(l.errMsg).show()}else if("banked_cloze"===i.custom_attr.disp_type&&i.extra_option_list.length+a.length>200)return Toast.hidden(),void Toast({message:"鏈€澶氬彲娣诲姞200涓€夐」",maxWidth:500});$(".jsBubble_s").remove(),P.is_matrix_question(i)&&"row"===e?P.add_batch_matrix_row_option(t,a):"banked_cloze"===i.custom_attr.disp_type?P.createStemOptions(t,a):i.question_type===QUESTION_TYPE_CLASSIFICATION&&"extra_option"===e?P.addBatchExtraOption(t,a):P.add_batch_matrix_col_option(t,a)}},P.is_batch_title_valid=function(t){return 0==t.length?($(".loadCon,.loadMack").remove(),loadMack({off:"on",Limg:0,text:"璇疯緭鍏ラ€夐」鍚嶇О",set:2e3}),!1):!(t.length>100)||($(".loadCon,.loadMack").remove(),loadMack({off:"on",Limg:0,text:"姣忔鏈€澶氬彧鑳芥坊鍔�100鏉￠€夐」",set:2e3}),!1)},P.Name_deal=function(){this.originalArr=[],this.numArr=[],this.Batch_data=[],this.num=-1,this.tsm=0,this.tsmC=0,this.ErdogicFn=function(t){var e=this;t.forEach(function(t){e.originalArr.push(t)})},this.EditFn=function(t){for(var e=!1,i=0;i<this.originalArr.length;i++)if(this.originalArr[i]==t){e=!0;break}return e},this.DealFn=function(){for(var t=/^(閫夐」|鐭╅樀琛寍鎵撳垎|濉┖|鏍囬|姣旈噸|绫诲埆)(\d+)$/,e=0;e<this.originalArr.length;e++){var i=this.originalArr[e];t.test(i)&&this.numArr.push(1*i.match(t)[2])}if(this.numArr=this.numArr.unique(),0==this.numArr.length)return this.num=1;this.numArr.sort(this.Conmpare);for(var o=0;o<this.numArr.length;o++)if(this.numArr[o]!==o+1){this.num=o+1;break}return-1==this.num&&(this.num=this.numArr[this.numArr.length-1]+1),this.num},this.BatchFn=function(t){this.Batch_data=[];this.tsm=0,this.tsm=0;for(var e=0;e<t.length;e++){var i=t[e].trim();""!==i&&(this.tsmC+=1,this.Batch_data.push(i))}return this.Batch_data},this.Conmpare=function(t,e){return t<e?-1:t>e?1:0}},P.get_option_list_formatted=function(t,e,i){for(var o=[],n=0;n<e.length;n++){var a=e[n];if(isNotEmpty(a)){var s={title:a,question_id:t};i&&(s.is_open=!0);var _=P.get_question(t);if(_.question_type==QUESTION_TYPE_MULTIPLE_BLANK?s.custom_attr={text_col:15,text_row:1}:_.question_type==QUESTION_TYPE_MATRIX_BLANK&&(s.custom_attr={text_col:10,text_row:1}),2===project.p_type&&check_in(_.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE])){var l=s.custom_attr||{};l.score="0",s.custom_attr=l}o.push(s)}}return o},P.create_option=function(t,e,i){var o;o=e.constructor==Array?{question_id:t,option_list_str:toJSONString(e)}:e;var n="/edit/ajax/option_create/"+get_oid(project);P.ajaxPost(n,o,function(e){if(e.matrix_col_limit)return $(".loadCon,.loadMack").remove(),void jsAlert({content:"<p style='text-align:left;'>鏈€澶氬彧鑳芥坊鍔�50鍒�</p>",obj:function(){}});if(e.option_limit){var o=P.get_question(t).question_type==QUESTION_TYPE_CLASSIFICATION?50:200;return $(".loadCon,.loadMack").remove(),void jsAlert({content:"<p style='text-align:left;'>鏈€澶氬彧鑳芥坊鍔�"+o+"涓€夐」</p>",obj:function(){}})}"200"==e.status&&i&&i(e)})},P.render_option=function(t,e){var i=$("#question_"+t),o=P.get_option_html(t),n={},a=P.get_question(t);if(a.question_type!=QUESTION_TYPE_SCORE||a.custom_attr.disp_type||(n.num=a.custom_attr.max_answer_num-a.custom_attr.min_answer_num+1),"matrix_scale"==a.custom_attr.disp_type)n.score_display=a.custom_attr.score_display,n.min=a.custom_attr.min_answer_num,n.max=a.custom_attr.max_answer_num,n.num=a.custom_attr.max_answer_num-a.custom_attr.min_answer_num+1;else if(a.question_type==QUESTION_TYPE_SCORE&&"proportion"==a.custom_attr.disp_type){var s=a.custom_attr;n.max_answer_num=s.max_answer_num,n.min_answer_num=s.min_answer_num,n.tick_data=s.tick_data||Object(k.d)(n.min_answer_num,n.max_answer_num),n.tick_width=100/(n.tick_data.length-1)}if(l(a)){n.num=a.custom_attr.max_answer_num-a.custom_attr.min_answer_num+1,n.edit_num=a.edit_num?a.edit_num:0;var _=a.option_list[1].custom_attr.label_data[n.edit_num+1+""];n.score_desc=_.score_desc,n.label_list=_.label_list,n.open_eval=a.custom_attr.open_eval,n.score_display=a.custom_attr.score_display}var d=juicer(o,{option_list:e,option_extra:n});i.find(".q_option_ul").append(d),a.question_type!=QUESTION_TYPE_SCORE||a.custom_attr.disp_type||i.find(".option_item").length>1&&i.find(".option_title_wrap.none").removeClass("none")},P.update_option=function(t,e){var i=P.get_question(t);if(e.row_id_list){var o=$.map(e.row_id_list,function(t){return""+t});i.matrixrow_id_list=i.matrixrow_id_list.concat(o),i.matrixrow_list=i.matrixrow_list.concat(e.row_list)}else if(e.extra_option_id_list){var n=$.map(e.extra_option_id_list,function(t){return""+t});i.extra_option_id_list=i.extra_option_id_list.concat(n),i.extra_option_list=i.extra_option_list.concat(e.extra_option_list)}else{var a=$.map(e.option_id_list,function(t){return""+t});i.option_id_list=i.option_id_list.concat(a),i.option_list=i.option_list.concat(e.option_list)}P.update_question(i)},P.delete_option=function(t,e,i,o){var n=null;if(e.constructor==Object)n=e;else{var a=null;a=e.constructor==Array?toJSONString(e):e,n={qid:t,option_id_or_list:a}}var s=$.Deferred();return P.ajaxPost("/edit/ajax/delete_option/"+get_oid(project),n,function(n){if(n.err_msg)loadMack({off:"on",Limg:1,text:"璇ラ€夐」鏈夐厤棰濊缃紝璇峰厛鍒犻櫎閰嶉璁剧疆",set:2e3});else{n.jump_count,P.set_jumpconstraint_status(n.qid);var a=P.get_question(t);if(2==project.p_type&&(a.question_max_score=n.question_str.question_max_score,a.question_min_score=n.question_str.question_min_score),e.constructor==Object){for(var _=JSON.parse(e.option_id_or_list),l=0;l<_.length;l++){var d=_[l];(r=a.option_id_list.indexOf(d))>-1&&(a.option_id_list.remove(r),a.option_list.remove(r))}a.custom_attr.horz_blank_content=e.horz_blank_content}else if(e.constructor==Array)for(l=0;l<e.length;l++){d=e[l];var r=a.option_id_list.indexOf(d);a.option_id_list.remove(r),a.option_list.remove(r),i&&$("#option_"+d).remove()}else{r=a.option_id_list.indexOf(e);a.option_id_list.remove(r),a.option_list.remove(r),i&&$("#option_"+e).remove()}P.update_question(a),s.resolve(n),"200"==n.status&&o&&o(n)}}),s.promise()},P.render_matrix_col=function(t,e){var i=$("#question_"+t).find(".option_table"),o=P.get_option_html(t,"col"),n=P.get_question(t),a={option_list:e,option_extra:{}};i.find("tr").each(function(t,e){if(0===t){var i=juicer(o,a);$(this).append(i)}else{var s=P.get_col_html_by_question_type(n.question_type),_=juicer(s,a);$(this).append(_)}})},P.create_matrixrow=function(t,e,i){var o={question_id:t,row_list_str:toJSONString(e)};P.ajaxPost("/edit/ajax/matrixrow_create/"+get_oid(project),o,function(t){if(t.matrix_row_limit)return $(".loadCon,.loadMack").remove(),void jsAlert({content:'<p style="text-align:left;">鏈€澶氬彧鑳芥坊鍔�50琛�</p>',obj:function(){}});"200"==t.status&&i&&i(t)})},P.render_matrixrow=function(t,e){var i=$("#question_"+t),o=P.get_option_html(t),n=P.get_question(t),a={row_list:e,option_list:n.option_list,option_extra:{}},s=i.find("table tr").eq(0).children().length-1-a.option_list.length;if(n.question_type==QUESTION_TYPE_MATRIX_BLANK)for(var _=0;_<s;_++)a.option_list.push({custom_attr:{text_row:"1"},_id:{$oid:""}});else for(_=0;_<s;_++)a.option_list.push(_);var l=juicer(o,a);i.find(".option_table").append(l)},P.update_matrixrow=function(t,e){var i=$.map(e.row_id_list,function(t){return""+t}),o=P.get_question(t);o.matrixrow_id_list=o.matrixrow_id_list.concat(i),o.matrixrow_list=o.matrixrow_list.concat(e.row_list),P.update_question(o)},P.delete_matrixrow=function(t,e){var i=null;i=e.constructor==Array?toJSONString(e):e;var o={qid:t,row_id_or_list:i},n=$.Deferred();return P.ajaxPost("/edit/ajax/delete_matrixrow/"+get_oid(project),o,function(i){var o=get_question(t);if(e.constructor==Array)for(var a=0;a<e.length;a++){var s=e[a],_=o.matrixrow_id_list.indexOf(s);o.matrixrow_id_list.remove(_),o.matrixrow_list.remove(_)}else{_=o.matrixrow_id_list.indexOf(e);o.matrixrow_id_list.remove(_),o.matrixrow_list.remove(_)}P.update_question(o),n.resolve(i)}),n.promise()},P.del_row=function(t){var e=get_parent($(t),"tr");e.attr("jump_id")&&del_jump_id_list.push(e.attr("jump_id")),e.remove(),0==$(".jumpconstraint").length&&$("#add_jump_btn").show(),0==$(".displayconstraint").length&&$("#add_display_btn").show()},P.get_new_row=function(){$("#add_jump_btn").before('<tr class="jumpconstraint"><td>濡傛灉鏈閫変腑</td><td><select name="option_id" class="option_select" value=""><option value="" selected>璇烽€夋嫨閫夐」</option></select></td><td>鍒欒烦杞埌</td><td><select name="jump_to_qid" class="jump_qid_select" value="" selected><option value="" selected>璇烽€夋嫨棰樼洰</option></select><div class="reduce"></div><div class="add"></div></td></tr>')},P.get_new_rows=function(){$("#add_display_btn").before('<tr class="displayconstraint"><td><select name="question_list" class="option_select" value=""><option value="" selected>璇烽€夋嫨棰樼洰</option></select></td><td><select name="display_condition" class="display_condition" value="" selected><option value="" selected>璇烽€夋嫨鏉′欢</option></select></td><td><select name="option_list" class="option_list" value=""  disabled="disabled"><option value="" selected>璇烽€夋嫨閫夐」</option></select><div class="reduce"></div><div class="add_btn"></div></td></tr>')},P.move_option=function(t,e,i,o){var n={question_id:t,option_id:e,direction:i};P.ajaxPost("/edit/ajax/option_move/"+get_oid(project),n,function(e){if(isNotEmpty(e.option_id_list)){var i=P.get_question(t);i.option_id_list=e.option_id_list,i.option_list=$.map(e.option_id_list,function(e){return P.get_option(t,e)}),o&&o()}})},P.move_matrixrow=function(t,e,i,o){var n={question_id:t,row_id:e,direction:i};P.ajaxPost("/edit/ajax/matrixrow_move/"+get_oid(project),n,function(e){if(isNotEmpty(e.row_id_list)){var i=P.get_question(t);i.matrixrow_id_list=e.row_id_list,i.matrixrow_list=$.map(e.row_id_list,function(e){return P.get_matrixrow(t,e)}),o&&o()}})},P.update_question=function(t){QUESTION_DICT[get_oid(t)]=t,QMODEL_DICT[get_oid(t)]=null,update_question_relation_option(t._id.$oid)},P.judge_setting_limit=function(t,e,i){if(""==e&&""!=i)return 3;if(""!=e&&""==i)return 3;if("max_answer_num"==t){if(e<i)return 1}else if("min_answer_num"==t&&e>i)return 1;return 3},P.update_order_limit_sort_count=function(t,e,i){var o=i.find('select[data-key="limit_sort_count"]'),n=o.val(),a=P.format_data_to_obj(t,"limit_sort_count","none"),s=e.option_list.length;if(n>s)P.save_question_setting(a,function(){var t=P.get_select_html(1,s);o.html(t).val(0)});else{var _=P.get_select_html(1,s);o.html(_).val(n)}},P.check_update_option_select=function(t){var e=P.get_question(t),i=e.question_type,o=$("#setting_main_wrap[qid="+t+"]");if(o.is(":visible")){if(i===QUESTION_TYPE_ORDER)P.update_order_limit_sort_count(t,e,o);else if(i===QUESTION_TYPE_CLASSIFICATION)P.updateCategoryMinMaxSelect(t);else if(!check_in(i,[QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_MATRIX_MULTIPLE]))return;var n=e.option_list.length,a=e.custom_attr.min_answer_num?parseInt(e.custom_attr.min_answer_num):0,s=e.custom_attr.max_answer_num?parseInt(e.custom_attr.max_answer_num):0,_=($("#question_"+t),o.find('.hd_select select[data-key="min_answer_num"]')),l=o.find('.hd_select select[data-key="max_answer_num"]'),d=a>n?0:a,r=s>n?0:s;if(s>n){var c=P.format_data_to_obj(t,"max_answer_num","none");P.save_question_setting(c,function(){P.update_option_max_select(t,l,d)})}else P.update_option_max_select(t,l,d);if(a>n){c=P.format_data_to_obj(t,"min_answer_num","none");P.save_question_setting(c,function(){P.update_option_min_select(t,_,r)})}else P.update_option_min_select(t,_,r)}},P.update_score_limit=function(t,e,i){var o=$("#question_"+t).find(".q_option_ul .option_item .score_wrap div"),n=$("#setting_main_wrap").find('.score[data-key="'+e+'"]'),a={},s=P.get_question(t);"max_answer_num"==e?(a.min=+i,a.max=10,a.val=s.custom_attr.max_answer_num,a.num=a.val-a.min+1):(a.min=0,a.max=+i,a.val=s.custom_attr.min_answer_num,a.num=a.max-a.val+1),o.attr("num",a.num),o.html(P.get_score_option_html(a)),n.html(P.get_score_select_html(a))},P.get_score_option_html=function(t){for(var e=['<span class="active"><em></em><i></i></span>'],i=1;i<t.num;i++)e.push("<span><em></em><i></i></span>");return e.join("")},P.get_score_select_html=function(t){for(var e=[],i=t.min;i<=t.max;i++)e.push("<option"+(i==t.val?" selected":"")+' value="'+i+'">'+i+"</option>");return e.join("")},P.update_option_select=function(t,e){var i=$("#setting_main_wrap[qid="+t+"]"),o=i.find(".setting_select_range");if(i.is(":visible")&&o.length){var n=i.find('.setting_select_range select[data-key="'+e+'"]');if("max_answer_num"==e){var a=parseInt(o.find('select[data-key="min_answer_num"]').val());P.update_option_max_select(t,n,a)}else if("min_answer_num"==e){var s=parseInt(o.find('select[data-key="max_answer_num"]').val());P.update_option_min_select(t,n,s)}}},P.update_option_min_select=function(t,e,i){var o=parseInt(e.val()),n=P.get_question(t).option_list.length,a=0==i?n:i,s=P.get_select_html(1,a,"椤�");e.html(s).val(o)},P.update_option_max_select=function(t,e,i){var o=parseInt(e.val()),n=P.get_question(t).option_list.length,a=0==i?1:i,s=P.get_select_html(a,n,"椤�");e.html(s).val(o)},P.get_select_html=function(t,e,i){i=i||"";for(var o=['<option value="0">涓嶉檺</option>'],n=t;n<=e;n++)o.push('<option value="'+n+'">'+n+i+"</option>");return o.join("")},P.create_page=function(t,e,i){var o=project.questionpage_list[t],n=o.question_list.slice(0,e),a=o.question_id_list.slice(0,e),s=o.question_list.slice(e),_=o.question_id_list.slice(e);o.question_list=n,o.question_id_list=a;var l={orig_page_id:get_oid(o),new_page_struct:toJSONString({project_id:get_oid(project),question_id_list:_})};P.ajaxPost("/edit/ajax/questionpage_create/"+get_oid(project),l,function(e){var o=e.new_page;o.question_list=s;for(var n=0;n<o.question_list.length;n++){o.question_list[n].questionpage_id=get_oid(o)}project.questionpage_list.splice(t+1,0,o),project.questionpage_id_list.splice(t+1,0,get_oid(o)),QUESTIONPAGE_DICT[get_oid(o)]=o,i&&i(e)})},P.delete_page=function(t,e){var i=project.questionpage_list[t],o={page_id:get_oid(i),page_count:t,project_id:get_oid(project)};P.ajaxPost("/edit/ajax/questionpage_delete/"+get_oid(project),o,function(o){if(o.is_del){for(var n=project.questionpage_list[t+1],a=0;a<n.question_id_list.length;a++){var s=n.question_id_list[a];P.get_question(s).questionpage_id=get_oid(i)}i.question_list=i.question_list.concat(n.question_list),i.question_id_list=i.question_id_list.concat(n.question_id_list),project.questionpage_list.remove(t+1),project.questionpage_id_list.remove(t+1),e&&e(o)}})},P.update_page_num=function(t){for(var e=P.$questionBox.find(".question_page"),i=t=t||0;i<e.length;i++){var o=e[i],n=juicer(m.pageTemplate,{pageNum:i+1,totalPage:e.length});$(o).after(n).remove()}},P.create_question=function(t,e,i,o){var n=INIT_QUESTION_MAP[t];if(isNotEmpty(n)){var a=project.questionpage_id_list[i];if(n.questionpage_id=a,2===project.p_type&&check_in(n.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_BLANK,QUESTION_TYPE_MULTIPLE_BLANK]))for(var s=0;s<n.option_list.length;s++){var _=n.option_list[s],l=_.custom_attr||{};l.score="0",_.custom_attr=l}var d={question_struct:toJSONString(n),questionpage_id:a,index:e},r="/edit/ajax/question_create/"+get_oid(project);P.ajaxPost(r,d,function(t){if(t.limit)return $(".loadCon,.loadMack").remove(),void jsAlert({content:"<p style='text-align:left;'>鏈€澶氬彧鑳芥坊鍔�200閬撻鐩�</p>",obj:function(){}});t.question.extra_data={},t.question.extra_data.sms_quota=t.extra_data.sms_quota,o&&o(t)})}},P.copy_question=function(t,e,i){P.ajaxPost("/edit/ajax/copy_question/"+get_oid(project),{qid:t},function(t){if(t.limit)return $(".loadCon,.loadMack").remove(),void jsAlert({content:"<p style='text-align:left;'>鏈€澶氬彧鑳芥坊鍔�200閬撻鐩�</p>",obj:function(){}});i&&i(t)})},P.question_create_update=function(t,e,i){var o=project.questionpage_id_list.indexOf(t),n=project.questionpage_list[o];e._id.$oid;n.question_list.splice(i,0,e),n.question_id_list.splice(i,0,get_oid(e)),Object(S.a)(e)},P.delete_question=function(t,e){var i=t.page_count,o=t.oid;if(isNotEmpty(o)){var n=project.questionpage_id_list[i],a="/edit/ajax/delete_question/"+get_oid(project),s={qid:o,page_id:n};P.ajaxPost(a,s,function(t){if("200"==t.status){var o=t.qid;if(t.err_msg)return $(".loadCon,.loadMack").remove(),void loadMack({off:"on",Limg:1,text:"璇ラ鐩湁閰嶉璁剧疆锛岃鍏堝垹闄ら厤棰濊缃�",set:2e3});if($("#question_"+o).find("li[data-related=true]").length>0||$("#question_"+o).find("div[data-related=true]").length>0){for(var n=[],a=QUESTION_DICT[o].related_question_list,s=0;s<a.length;s++){var _=a[s]._id.$oid;n.push(_)}update_related_question_dict(o,n)}$("#question_"+o).remove(),P.hide_setting_animate(),P.update_question_cid();var l=P.get_question(o),d=project.questionpage_list[i];d.question_list.splice(d.question_list.indexOf(l),1),d.question_id_list.splice(d.question_id_list.indexOf(get_oid(l)),1),Object(S.c)(o),P.show_or_hide_add_question_tip(P.$questionBox),2==project.p_type&&P.calculation_project_total_score();var r=t.rel_map.parseJSON();if(isNotEmpty(r))for(var o in r){r[o];P.set_jumpconstraint_status(o)}e&&e(t)}})}},P.get_project_order_list=function(){var t=[];return P.$questionBox.find(">.module").each(function(e,i){var o=$(i);o.is(".question_page")?t.push([]):(0==e&&t.push([]),t[t.length-1].push(o.attr("oid")))}),t},P.update_question_cid=function(){P.$questionBox.find(".q_seq").each(function(t,e){var i=$(this);i.text(t+1);var o=i.parents(".question").attr("oid");QUESTION_DICT[o].cid="Q"+(t+1),update_question_relation_option(o)})},P.init_question_cid=function(){P.$questionBox.find(".q_seq").each(function(t,e){$(this).text(t+1)})},P.save_question_order=function(t){var e=P.get_project_order_list(),i={order_list_str:toJSONString(e),project_id:get_oid(project)},o="/edit/ajax/save_question_order/"+get_oid(project);P.ajaxPost(o,i,function(i){i.reject&&window.location.reload(),"200"==i.status&&(P.update_pageid_for_question(e),P.update_setting_main_seq(),t&&t(i))})},P.update_setting_main_seq=function(){var t=$("#setting_main_wrap");if(t.is(":visible")){var e=t.attr("qid"),i=t.attr("option-id"),o=t.find(".question_seq"),n=t.find(".option_seq");if(o.text("Q"+$("#question_"+e).find(".q_seq").text()),i){var a=P.get_question(e).option_id_list.indexOf(i)+1;n.text(a),$("#option_"+i).addClass("option_hover")}}},P.update_pageid_for_question=function(t){for(var e=0;e<t.length;e++){var i=t[e],o=project.questionpage_id_list[e];P.get_questionpage(o).question_id_list=i;for(var n=[],a=0;a<i.length;a++){var s=i[a],_=P.get_question(s);_.questionpage_id!=o&&(_.questionpage_id=o),n.push(_)}QUESTIONPAGE_DICT[o].question_list=n;var l=project.questionpage_id_list.indexOf(o);l>-1&&(project.questionpage_list[l].question_list=n)}},P.init_address_select=function(t){for(var e=$("#question_"+t),i=e.find(".select_transverse select:eq(0)"),o=e.find(".select_transverse select:eq(1)"),n=e.find(".select_transverse select:eq(2)"),a='<option value="">璇烽€夋嫨甯�</option>',s='<option value="">璇烽€夋嫨鍖�/鍘�</option>',_=0;_<ssq_data.length;_++){var l=ssq_data[_];i.append("<option value="+l.name+">"+l.name+"</option>")}i.change(function(){if(""!=this.value){var t=this.value,e=ssq_data.filter(function(e){return e.name==t})[0];o.html(a);for(var i=0;i<e.sub.length;i++){var _=e.sub[i];o.append("<option value="+_.name+">"+_.name+"</option>")}n.html(s)}else o.html(a),n.html(s)}),o.change(function(){if(""!=this.value){var t=this.value,e=i.val(),o=ssq_data.filter(function(t){return t.name==e})[0].sub.filter(function(e){return e.name==t})[0];n.html(s);for(var a=0;a<o.sub.length;a++){var _=o.sub[a];n.append("<option value="+_.name+">"+_.name+"</option>")}}else n.html(s)})},P.show_toolbar=function(t,e,i,o){var n=$("#edit_tool_bar");0==n.length&&(n=$($("#edit_tool_bar_tpl").html()),$("body").append(n)),$("#edit_tool_bar .left .add_image").removeClass("disabled_upload_img");var a=!1;e&&((a=P.get_question(e).question_type===QUESTION_TYPE_CLASSIFICATION&&("option"===i||"extra_option"===i))&&P.setUploadImgStatus(e,t.html()));n.attr("edit-type",i),n.attr("qoute_title",o),"option"!=i&&"extra_option"!=i||(e=t.parents(".option_item").attr("oid")),window.edit_obj=t,window.tip_obj=function(){return $(".title_tips")},t.find("img").length>0&&!a&&new E(t.find("img")),e=e||"";var s=t.parents(".module"),_=s.attr("disp_type"),l=s.attr("question-type"),d=!0,r=!1,c=parseInt(t.offset().left),p=parseInt(t.offset().top);if("option"==i||"col"==i||"row"==i||"extra_option"==i||"stem_content"==i){P.showOptionVideo(w.a,l,_)||!1?n.find(".add-video").show():n.find(".add-video").hide()}else n.find(".add-video").show();"horz_blank"==_&&t.hasClass("horz_question_content")||"banked_cloze"==_&&"stem_content"==i?(n.find(".senior_edit").hide(),n.find(".insert-cloze").hide(),n.find(".insert-blank").css("display","inline-block")):"cloze"===_&&t.hasClass("cloze_question_content")?(n.find(".senior_edit").hide(),n.find(".insert-blank").hide(),n.find(".add-video").hide(),n.find(".insert-cloze").css("display","inline-block")):(n.find(".senior_edit").show(),n.find(".insert-blank").hide(),n.find(".insert-cloze").hide()),(t.hasClass("title_content")||t.hasClass("suffix_content")||t.hasClass("horz_question_content"))&&n.find(".add-video").hide(),(t.hasClass("title_content")||t.hasClass("prefix_content")||t.hasClass("suffix_content"))&&(d=!1);for(var u=!1,m=!1,v=0;v<project.questionpage_list.length;v++){for(var f=0;f<project.questionpage_list[v].question_list.length&&(project.questionpage_list[v].question_list[f].cid?(u=!0,m=!0):project.questionpage_list[v].question_list[f]._id.$oid==e&&(m=!0),!m);f++);if(m)break}(!u||u&&1==s.find(".q_seq").text()||t.hasClass("horz_question_content")||t.hasClass("cloze_question_content")||"banked_cloze"==_)&&(d=!1),"option"==i&&("imagevote_single"!=_&&"image_single"!=_&&"imagevote_multiple"!=_&&"image_multiple"!=_&&"dropdown"!=_||(r=!0)),r?n.addClass("mini"):n.removeClass("mini");var h="",q=!0;$(".editable_focus").length>0&&(q=parseInt($(".editable_focus").offset().left+$("#edit_tool_bar").width())),$(".option_focus").length>0&&(q=parseInt($(".option_focus").offset().left+$("#edit_tool_bar").width())),h=d?"":"none",p-=parseInt(n.height()),n.find(".right").attr("class","right "+h),q?n.css({left:c,top:p}).attr("oid",e).removeClass("none"):n.css({left:c,top:p}).addClass("none"),"matrix_scale"==_&&"col"==i&&n.css({left:c,top:p}).addClass("none")},P.ajaxPost=function(t,e,i,o){var n=$.cookie("_xsrf")||"";isNotEmpty(n)&&(e._xsrf=n),"undefined"!=typeof client_uuid&&(e.client_uuid=client_uuid,0==ajaxPostNum&&(P.saveLoading(),clearTimeout(window.timmer),window.timmer=setTimeout(function(){clearTimeout(window.timmer),0!=$(".loadCon").length&&"淇濆瓨涓�..."==$(".loadCon p").html()&&($(".loadCon,.loadMack").remove(),loadMack({off:"on",Limg:0,text:"缃戠粶鎯呭喌杈冨樊锛岀郴缁熷皢鑷姩鍒锋柊",set:2e3}),setTimeout(function(){location.reload()},1500))},3e4))),ajaxPostNum++,$.ajax({url:t,data:e,dataType:"JSON",type:"POST",timeout:6e4,error:o||function(){},success:function(t){if("200"==t.status){if(t.hasOwnProperty("edit_valid")&&!t.edit_valid)return void edit_lock_alert();ajaxPostNum--,isNotEmpty(i)&&i(t),t.err_msg||0!=ajaxPostNum||$(".loadCon,.loadMack").remove()}}})},P.saveLoading=function(t,e){loadMack({off:"on",Limg:'<img style="margin:10px auto;display:block;" src="/static/js/plug-in/load/loading_wb.gif" width="48" height="48" />',text:"淇濆瓨涓�...",set:0})},P.setFocus=function(t){var e=t[0];if(e){t.focus();var i=document.createRange();i.selectNodeContents(e),i.collapse(!1);var o=window.getSelection();0==o.anchorOffset&&(o.removeAllRanges(),o.addRange(i))}},P.validationNum=function(t,e){e?t.val(t.val().replace(/[^\d.]/g,"")):"contactInfo"==t.attr("id")?t.val(t.val().replace(/[^\d-]/g,"")):t.val(t.val().replace(/[^\d]/g,"")),t.val(t.val().replace(/^\./g,"")),t.val(t.val().replace(/\.{2,}/g,".")),t.val(t.val().replace(".","$#$").replace(/\./g,"").replace("$#$",".")),t.val(t.val().replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"))},P.pasteFun=function(t){var e=null,i=null;if(e=(e=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("text"):(t.originalEvent||t).clipboardData.getData("text/plain")||"").replace(/(\r\n)|(\n)/g,"<br>"),document.body.createTextRange){if(document.selection)i=document.selection.createRange();else if(document.getSelection){var o=window.getSelection().getRangeAt(0),n=document.createElement("span");n.innerHTML="&#FEFF;",o.deleteContents(),o.insertNode(n),(i=document.body.createTextRange()).moveToElementText(n),n.parentNode.removeChild(n)}i.pasteHTML(e),i.collapse(!1),i.select()}else document.execCommand("insertHtml",!1,e)},P.input_on_focus=function(t,e){var i=P.question_default_text_dic,o=t.text();if(e){var n=P.get_question(e),a=n.question_type,s=n.custom_attr.disp_type?n.custom_attr.disp_type:"",_=P.get_question_only_type(a,s);if(t.hasClass("q_title"))(i[_]&&o==i[_].title||i[_]&&o==i[_].title1)&&P.selectall_usefor_sh();else{if("鎬у埆"==_||"鍒ゆ柇棰�"==_)o!=i[_].option&&o!=i[_].option1||P.selectall_usefor_sh(),/^閫夐」\d+$/.test(o)&&P.selectall_usefor_sh();else if("妯悜濉┖棰�"==_)t.html()==i[_].option&&P.selectall_usefor_sh();else if("banked_cloze"===n.custom_attr.disp_type){i[_].option1.indexOf(o)>-1&&P.selectall_usefor_sh()}else if(a==QUESTION_TYPE_CLASSIFICATION){var l=t.html(),d=INIT_QUESTION_MAP[QUESTION_TYPE_CLASSIFICATION];(t.hasClass("category_title")?d.extra_option_list.map(function(t){return t.title}):d.option_list.map(function(t){return t.title})).indexOf(l)>=0&&P.selectall_usefor_sh()}new RegExp("^"+i[_].option+"\\d+$").test(o)&&P.selectall_usefor_sh(),new RegExp("^"+i[_].option1+"\\d+$").test(o)&&P.selectall_usefor_sh()}}else{var r=getProjectType(project.p_type,project.scene_type).typeEn;for(var c in i.project[r])if(o.trim()==i.project[r][c]){P.selectall_usefor_sh();break}}},P.selectall_usefor_sh=function(t,e){var i=setTimeout(function(){clearTimeout(i),document.execCommand("selectAll",!1,null)},100)},P.get_question_only_type=function(t,e){var i=P.question_default_text_dic;for(var o in i)if(i[o].question_type===t&&i[o].disp_type===e)return o},P.accessTreeDataByIndex=function(t,e,i,o){function n(t){return"[object Array]"===Object.prototype.toString.call(t)}if(!e||!n(t)||t.length<=0)return console.log("鏃犳晥鍙傛暟"),[];for(var a,s=_.cloneDeep(e),l=s||{children:[]},d=[],r=0,c=void 0===o,p=0,u=t.length;p<u;p++){if(r=Number.parseInt(t[p])-1,l.children||(l.children=[]),r>l.children.length)return console.log("鏃犳晥绱㈠紩",t,"涓殑绗�",p+1,"浣�"),s;if(p==u-1&&void 0!==o)return r<0?l.children.push(o):!1===o?l.children.splice(r,1):(a=o,"[object Object]"===Object.prototype.toString.call(a)?l.children[r]=o:console.log("鏃犳晥鐨勬柊鏁版嵁",o)),s;if(!l.children[r])return{};d=l.index&&n(l.index)?l.index:[],l=l.children[r],c&&!0===i&&(l.index=d?d.concat([t[p]]):[])}return l},P.edit_cascader_data_flat=function(t,e,i){if(!t||t.length<0||!i)return console.log("鏃犳晥鍙傛暟",arguments),[];var o=[],n=this.accessTreeDataByIndex([t[0]],i);o.push(i.children||[]),n.children||console.log("鏃犲瓙鏁版嵁",i);for(var a=1;o.length<e;)n=n.children||[],o.push(n),n=n[t[a]||t[a]>0?t[a]-1:0]||{},a++;return o},P.get_tree_max_level=function(t,e){return function t(e,i,o){var n=i,a=0,s=_.cloneDeep(e);if(!s.children||s.children.length<=0||n>=o)return n;for(s=s.children;s.length>0;)if((n=(a=t(s.pop(),i+1,o))>n?a:n)>=o)return n;return n}(t,0,e||4)},P.edit_cascader_data=function(t,e){var i=P.get_question(t),o=U(i)||[],n=L(i),a=!1;n=P.get_limit_len_list(n,4,{title:"璇烽€夋嫨"});o={children:o=_.cloneDeep(o)},$(window).on("mousewheel",A);for(var s=[1,1,1,1],l=P.edit_cascader_data_flat(s,4,o),d=0,r=s.length;d<r;d++)s[d]>0&&(!l[d]||s[d]>l[d].length)&&(s[d]=l[d]&&l[d].length>0?1:0);var c={cascaderNum:4,cascaderTitle:["涓€","浜�","涓�","鍥�"],cascader:l||[],cascaderActiveIndex:s,welcomeTitles:n},p={null:"姝ら€夐」涓嶈兘涓虹┖锛岄渶淇敼",same:"姝ら€夐」鍦ㄨ灞傜骇涓嬪唴瀹归噸澶嶏紝闇€淇敼",illegal:"閫夐」涓嶆敮鎸佽緭鍏モ€�>鈥濄€佲€�<鈥濈鍙�"},u=new Popup({wrapClass:"cascader_edit",head:{inner:"閫夐」缂栬緫"},content:{class:"cascader_edit_box",inner:juicer($("#cascader_edit_template").html(),c)},width:900,height:605,btnLeft:"鍙栨秷",btnRight:{inner:"淇濆瓨",class:"popup_btn_item popup_btn_right",onClick:function(){if(m.find(".js_illegal_active").length>0){Toast.hidden();var s=m.find(".js_illegal_active").attr("data-illegal-type");Toast({message:p[s],maxWidth:500})}else{if(!a)return $(window).off("mousewheel",A),u.destroy(),void(u=null);var _=P.get_tree_max_level(o,4),l=P.get_limit_len_list(n,_,{title:"璇烽€夋嫨"});P.save_question_option({qid:t,title:l,list:o.children},function(n){i=L(i=U(i,o.children||[]),n.question.option_list||[]),P.update_question(n.question),P.update_question_html(t,e),$("#question_"+t).addClass("question_focus"),$(window).off("mousewheel",A),u.destroy(),u=null})}}},btnAlign:"right",showMask:!0,showCloseBtn:!0,onClose:function(){Toast.hidden(),$(window).off("mousewheel",A),u.destroy(),u=null,g(!1)},onLeftClick:function(){Toast.hidden(),$(window).off("mousewheel",A),u.destroy(),u=null}});u.show();var m=$("#"+u.id).find(".cascader_edit_box");function v(t){return t?"true":"false"}function f(t){m.attr("data-notchange",v(t))}function h(t,e){t.attr("data-isedit",v(e))}function q(t,e){e?t.addClass("js_has_children"):t.removeClass("js_has_children")}function g(t){var e=t?"on":"off";m[e]("click",".cascader_col_item",b),m[e]("input","input.cascader_col_item_input",y),m[e]("blur","input.cascader_col_item_input",x),m[e]("click",".cascader_col_add_item",T),m[e]("click",".cascader_col_item_del",k)}setTimeout(function(){var t=m.find("input.cascader_col_item_input");t&&t.focus()},500),$(".cascader_col_wrap").css("maxHeight",m.find(".cascader_col").eq(0).height()-m.find(".cascader_col_title").outerHeight()-m.find(".cascader_col_add_item").outerHeight()-26),$.fn.mCustomScrollbar&&$(".cascader_col_wrap").mCustomScrollbar({theme:"minimal-dark",scrollInertia:0,mouseWheel:{preventDefault:!1}});var w=50;function b(t){var e,i=$(this),n=parseInt(i.attr("data-cascader-index")),a=i.parents(".cascader_col"),s=parseInt(a.attr("data-cascader-index"))||0,_=i.hasClass("js_selected");if(i.hasClass("js_edit_active")||"true"==m.attr("data-notchange"))m.find("input.cascader_col_item_input").focus();else{$(".cascader_col_item.welcome_item").removeClass("js_selected"),m.find("input.cascader_col_item_input").remove(),m.find(".js_edit_active").removeClass("js_edit_active");var l=i.find("div.cascader_col_item_input"),d=$("<input class='cascader_col_item_input'>");l.parent().append(d),d.focus(),d.val(l.text());var r=l.text().length+"/"+w;i.find(".cascader_col_item_limit").text(r),a.find(".js_selected").removeClass("js_selected"),a.attr("data-cascader-select-index",n);var c=E(s,n);if(e=P.accessTreeDataByIndex(c,o),!_){for(var p=s;s<4;)O(s+1,[],0,!1),s++;p<4&&n>0&&O(p+1,e.children||[],0,!0)}!e.children||e.children.length<=0?q(i,!1):q(i,!0),i.addClass("js_selected js_edit_active")}}function y(t){a=!0;var e=$(this);h(e,!0);var i=e.parents(".cascader_col_item");e.val().length>=w&&(Toast.hidden(),Toast("宸茶揪閫夐」瀛楁暟涓婇檺"),e.val(e.val().substr(0,w))),f(!1),i.removeClass("js_illegal_active").attr("data-illegal-type","");var o=e.val().length+"/"+w;i.find(".cascader_col_item_limit").text(o)}function x(t){var e=$(this),i=e.parents(".cascader_col"),a=parseInt(i.attr("data-cascader-index"))||1,s=parseInt(i.attr("data-cascader-select-index"))||0,_=$.trim(e.val()),l=e.parents(".cascader_col_item");if("true"==e.attr("data-isedit"))if(_)if(_.indexOf("<")>=0||_.indexOf(">")>=0)v("illegal");else{if(s<=0)return h(e,!1),l.find("div.cascader_col_item_input").text(_),r=_,void(n[(d=a)-1]&&(n[d-1].title=r));var d,r,c=i.find(".cascader_col_item:not(.welcome_item)");if(c&&c.length>0&&function(t,e){if(!t||t.length<=0)return!1;for(var i=0,o=t.length;i<o;i++)if(!$(t[i]).hasClass("js_selected")&&$(t[i]).find("div.cascader_col_item_input").text()==e)return!0;return!1}(c,_))v("same");else{h(e,!1),l.find("div.cascader_col_item_input").text(_);var u=E(a,s),m=P.accessTreeDataByIndex(u,o);m.title=_,console.log("new",m),o=P.accessTreeDataByIndex(u,o,!1,m)}}else v("null");function v(t){f(!0),l.addClass("js_illegal_active").attr("data-illegal-type",t),Toast.hidden(),Toast({message:p[t],maxWidth:500})}}function T(t){var e=$(this).parents(".cascader_col"),i=parseInt(e.attr("data-cascader-length"))||0,n=parseInt(e.attr("data-cascader-index"))||1;if(i+1>300)return Toast.hidden(),void Toast({message:"宸茶揪閫夐」鏁伴噺涓婇檺锛屾棤娉曠户缁坊鍔�",maxWidth:500});a=!0;for(var s=E(n,0),_={title:"鏂伴€夐」"+(i+1),children:[]};e.find(".cascader_col_item_input:contains('"+_.title+"')").length>0;)_.title=_.title+"1";o=P.accessTreeDataByIndex(s,o,!1,_);var l=N({cascaderIndex:i+1,order:i+1,title:_.title});e.attr("data-cascader-length",i+1),e.find(".cascader_col_main").append(l),"0"==e.attr("data-cascader-select-index")&&e.find(".cascader_col_wrap").mCustomScrollbar("scrollTo",100*(i+1),{timeout:150}),n>1&&i<=0&&q(I(n-1).find(".js_selected"),!0),e.find(".welcome_item").show()}g(!0);var j="cascader_pop_delete",C=sessionStorage.getItem(j)||"",S=C.indexOf(t)<0;function k(e){var i=$(this),n=i.parents(".cascader_col"),s=parseInt(n.attr("data-cascader-length"))||0,_=parseInt(n.attr("data-cascader-index"))||1;function l(){var t=parseInt(n.attr("data-cascader-select-index"))||0,e=E(_,t);if(o=P.accessTreeDataByIndex(e,o,!1,!1),i.parents(".cascader_col_item").remove(),n.attr("data-cascader-length",s-1).attr("data-cascader-select-index",0),t<s)for(;t<s;){var l=n.find(".cascader_col_item:not(.welcome_item)").eq(t-1);l.attr("data-cascader-index",t),l.find(".cascader_col_item_order").text(t),t++}for(s<=1&&(n.find(".welcome_item").hide(),_>1&&q(I(_-1).find(".js_selected"),!1));_<4;)O(_+1,[],0,!1),_++;a=!0,f(!1)}if(s<=1&&_<=1)return Toast.hidden(),void Toast("璇ラ€夐」涓嶅彲鍒犻櫎");S?P.edit_pop_confirm({title:"绯荤粺鎻愮ず",content:_<=3?"璇ョ骇閫夐」鍙婄浉鍏宠仈鐨勫瓙绾у皢鍏ㄩ儴鍒犻櫎锛岀‘瀹氳鍒犻櫎鍚楋紵":"纭畾瑕佸垹闄ゅ悧锛�",remind:"姝ゆ闂嵎缂栬緫锛屼笉鍐嶆彁閱�",btnLeft:"鍙栨秷",btnRight:"纭畾",onClose:function(t){},onLeftClick:function(t){},onRightClick:function(e){e.remind&&(sessionStorage.setItem(j,C?C+","+t:t),S=!1),l()}}):l()}function I(t){return m.find(".cascader_col[data-cascader-index="+t+"]")}function E(t,e){for(var i=[e],o=0;t-1>0;)o=I(t-1).attr("data-cascader-select-index"),console.log(o),i.unshift(parseInt(o)),t--;return i}function O(t,e,i,o){var n=I(t);n.find(".cascader_col_item:not(.welcome_item)").remove(),n.attr("data-cascader-length",e.length),n.attr("data-cascader-select-index",i||0),o?n.find(".cascader_col_add_item").show():n.find(".cascader_col_add_item").hide();var a=null;if(!e||e.length<=0)n.find(".welcome_item").hide();else{n.find(".welcome_item").show();for(var s=0,_=e.length;s<_;s++)a=N({cascaderIndex:s+1,order:s+1,title:e[s].title}),e[s].children&&e[s].children.length>0&&q(a,!0),n.find(".cascader_col_main").append(a),void 0!==i&&i==s+1&&a.addClass("js_selected")}}function N(t){var e=$("#cascader_col_item_templates").clone();return e.removeAttr("id"),e.attr("data-cascader-index",t.cascaderIndex),e.find(".cascader_col_item_order").text(t.order+"."),e.find(".cascader_col_item_input").text(t.title),e.show(),e}},P.edit_pop_confirm=function(t){var e={btnAlign:"right",showMask:t.showMask||!0,maskClickClose:t.maskClickClose||!1,showCloseBtn:t.showCloseBtn||!0,noScroll:t.noScroll||!0,popupType:"confirm",remind:t.remind||"涓嶅啀鎻愰啋",onClose:function(){t.onClose&&t.onClose(i),i.destroy()},onLeftClick:function(){t.onLeftClick&&t.onLeftClick(i),i.destroy()},onRightClick:function(){t.onRightClick&&t.onRightClick(i),i.destroy()}};t.title&&(e.head={inner:t.title,class:"switching_themes_title"}),t.content&&(e.content={inner:t.content,class:"switching_themes_content"}),t.btnLeft&&(e.btnLeft=t.btnLeft||"鍙栨秷"),t.btnRight&&(e.btnRight=t.btnRight||"纭畾");var i=new Popup(e);return i.show(),i},P.get_limit_len_list=function(t,e,i){var o=_.cloneDeep(t||[]);if(o.length>e)return o.splice(0,e);for(;o.length<e;)o.push(_.cloneDeep(i));return o},P.save_question_option=function(t,e){t={question_id:t.qid,option_list:toJSONString(t.title),option_data:toJSONString(t.list)};P.ajaxPost("/edit/ajax_cascade_question_save/",t,function(t){200==t.status&&1==t.status_code?e&&e(t.data?{question:t.data.question||{}}:{}):(Toast(t.msg),console.log(t.msg))})},P.save_question_option_titles=function(t,e,i){P.get_question(t).option_list=_.cloneDeep(e||[]),i&&i()},P.edit_cascader_import=function(t,e){var i=P.get_question(t),o={wrapClass:"cascader_import",head:{inner:'瀵煎叆閫夐」<span class="cascader_import_help icon_wj"><span class="text"><span class="icon"></span>浣跨敤Excel妯℃澘鏂囦欢锛屽彲瀵圭骇鑱旈閫夐」杩涜鎵归噺缂栬緫<a target="_blank" href="/helpcenter/list/5232da3989c0971aa67264b0/h35c872657a320fc7253ebf326">鏌ョ湅鏇村</a></span></span>'},content:{inner:$("#question_data_import_template").html()},showMask:!0,showCloseBtn:!0,onClose:function(){n.destroy()}},n=new Popup(o),a="";n.show();var s=$("#"+n.id).find(".import_data_box");s.dmUploader({url:"/edit/upload_excel_for_cascade/",dataType:"json",multiple:!1,extraData:{question_id:t,_xsrf:$.cookie("_xsrf")||""},maxFileSize:1073152,extFilter:"xls;xlsx",onInit:function(){},onNewFile:function(t,e){d("uploading",{btn:"鍙栨秷",percent:"0%"})},onComplete:function(){},onUploadProgress:function(t,e){if(n.visible){a=t;var i=e+"%";d("uploading",{btn:"鍙栨秷",percent:"100%"==i?"99%":i})}},onUploadSuccess:function(o,a){var s;n.visible&&200==a.status&&(1==a.status_code?(s=a.data,n.visible&&(U(i,s.option_data),L(i,s.option_list),P.update_question(i),P.update_question_html(t,e)),d("success",{btn:"鍏抽棴锛�5s锛�",percent:"100%"}),function t(e){n.visible&&setTimeout(function(){n.visible&&(d("success",{btn:"鍏抽棴锛�"+e+"s锛�",percent:"100%"}),e>0?t(e-1):r())},1e3)}(4)):d("fail",{percent:"100%",description:a.msg||"鏈煡閿欒锛岃閲嶈瘯"}))},onUploadError:function(t){d("fail",{percent:"100%",description:"涓婁紶澶辫触锛岃閲嶆柊灏濊瘯"}),console.log("涓婁紶澶辫触",t)},onFileTypeError:function(t){d("fail",{description:"涓婁紶鏂囦欢鏍煎紡閿欒锛岃鎸夌収妯℃澘鏂囦欢鏍煎紡杩涜濉啓",percent:"100%"})},onFileSizeError:function(t){d("fail",{description:"涓婁紶鏂囦欢澶у皬閿欒锛岃涓婁紶2M浠ヤ笅xls鏂囦欢锛�",percent:"100%"})},onFileExtError:function(t){d("fail",{description:"涓婁紶鏂囦欢鏍煎紡閿欒锛岃鎸夌収妯℃澘鏂囦欢鏍煎紡杩涜濉啓",percent:"100%"})},onFallbackMode:function(t){Toast("涓嶆敮鎸佹枃浠舵牸寮�")}}),s.on("click",".close_pop",r);var _=$(".import_data_preview"),l=$(".import_data_upload_status");function d(t,e){_.hide(),l.show(),"uploading"==t?(l.attr("data-status","uploading"),l.find(".status_text span").text("姝ｅ湪涓婁紶"),l.find(".close_pop").text(e.btn||"鍏抽棴"),l.find(".status_progress_percent div").css({width:e.percent||"99%"}),l.find(".status_progress_text").text(e.percent||"99%")):"success"==t?(l.find(".status_text span").text("涓婁紶鎴愬姛"),l.attr("data-status","success"),l.find(".status_progress_percent div").css({width:"100%"}),l.find(".status_progress_text").text("100%"),l.find(".close_pop").text(e.btn||"鍏抽棴")):"fail"==t&&(a="",l.find(".status_text span").text("涓婁紶澶辫触"),l.attr("data-status","fail"),l.find(".status_progress_percent div").css({width:"100%"}),l.find(".status_progress_text").text("100%"),l.find(".status_progress_description").text(e.description||""))}function r(){var t;"uploading"==l.attr("data-status")&&a?(t=a,s.dmUploader("cancel",t)):"success"==l.attr("data-status")&&(s.dmUploader("destroy"),n.destroy())}},P.updateProportionSlider=function(t){var e=P.get_question(t).option_list;$("#question_"+t).find(".q_option_ul").html(""),P.render_option(t,e)},P.checkChangeOptionNum=function(t,e){var i=QUESTION_DICT[t],o=i.custom_attr.limit_total,n=parseInt(i.custom_attr.total_value),a=parseInt(i.custom_attr.min_answer_num),s=parseInt(i.custom_attr.max_answer_num),_={isSuccess:!0,errMsg:""};return o?a*e>n?_={isSuccess:!1,errMsg:"涓嶅彲娣诲姞锛屽悇椤规渶灏忓€间箣鍜屼笉寰楀ぇ浜庢瘮閲嶆€诲拰"}:s*e<n?_={isSuccess:!1,errMsg:"涓嶅彲鍒犻櫎锛屽悇椤规渶澶у€间箣鍜屼笉寰楀皬浜庢瘮閲嶆€诲拰"}:_:(a*e>1e3&&(_={isSuccess:!1,errMsg:"涓嶅彲娣诲姞锛屽悇椤规渶灏忓€间箣鍜屼笉寰楀ぇ浜�1000"}),_)},P.checkTotalValue=function(t,e){var i=QUESTION_DICT[t],o=i.option_list.length,n=i.custom_attr.limit_total,a="on"==i.custom_attr.limit_max_min,s=parseInt(i.custom_attr.min_answer_num),_=parseInt(i.custom_attr.max_answer_num),l={isSuccess:!0,errMsg:""};return n?""===e||isNaN(e)?l={isSuccess:!1,errMsg:"杈撳叆妗嗕笉寰椾负绌�"}:e>1e3?l={isSuccess:!1,errMsg:"璇疯緭鍏ュ皬浜庣瓑浜�1000鐨勬暟瀛�"}:e<=0?l={isSuccess:!1,errMsg:"姣旈噸鎬诲拰涓嶅緱灏忎簬绛変簬0"}:a&&e<_?l={isSuccess:!1,errMsg:"姣旈噸鎬诲拰涓嶅緱灏忎簬鏈€澶у€�"}:a&&e<s?l={isSuccess:!1,errMsg:"姣旈噸鎬诲拰涓嶅緱灏忎簬鏈€灏忓€�"}:a&&e>_*o?l={isSuccess:!1,errMsg:"姣旈噸鎬诲拰涓嶅緱澶т簬鍚勯」鏈€澶у€间箣鍜�"}:a&&e<s*o?l={isSuccess:!1,errMsg:"姣旈噸鎬诲拰涓嶅緱灏忎簬鍚勯」鏈€灏忓€间箣鍜�"}:l:l},P.checkMinNum=function(t,e){var i=QUESTION_DICT[t],o=i.option_list.length,n=parseInt(i.custom_attr.total_value),a=i.custom_attr.limit_total,s=parseInt(i.custom_attr.max_answer_num),_={isSuccess:!0,errMsg:""};return""===e||isNaN(e)?_={isSuccess:!1,errMsg:"杈撳叆妗嗕笉寰椾负绌�"}:e<0?_={isSuccess:!1,errMsg:"鏈€灏忓€间笉寰楀皬浜�0"}:e>=s?_={isSuccess:!1,errMsg:"鏈€灏忓€间笉寰楀ぇ浜庣瓑浜庢渶澶у€�"}:a&&e>n?_={isSuccess:!1,errMsg:"鏈€灏忓€间笉寰楀ぇ浜庢瘮閲嶆€诲拰"}:a&&e*o>n?_={isSuccess:!1,errMsg:"鍚勯」鏈€灏忓€间箣鍜屼笉寰楀ぇ浜庢瘮閲嶆€诲拰"}:!a&&e>1e3?_={isSuccess:!1,errMsg:"鏈€灏忓€间笉寰楀ぇ浜�1000"}:_},P.checkMaxNum=function(t,e){var i=QUESTION_DICT[t],o=i.option_list.length,n=parseInt(i.custom_attr.total_value),a=i.custom_attr.limit_total,s=parseInt(i.custom_attr.min_answer_num),_={isSuccess:!0,errMsg:""};return""===e||isNaN(e)?_={isSuccess:!1,errMsg:"杈撳叆妗嗕笉寰椾负绌�"}:e<=s?_={isSuccess:!1,errMsg:"鏈€澶у€间笉寰楀皬浜庣瓑浜庢渶灏忓€�"}:a&&e*o<n?_={isSuccess:!1,errMsg:"鍚勯」鏈€澶у€间箣鍜屼笉寰楀皬浜庢瘮閲嶆€诲拰"}:a&&e>n?_={isSuccess:!1,errMsg:"鏈€澶у€间笉寰楀ぇ浜庢瘮閲嶆€诲拰"}:!a&&e>1e3?_={isSuccess:!1,errMsg:"鏈€澶у€间笉寰楀ぇ浜�1000"}:e<=0?_={isSuccess:!1,errMsg:"鏈€澶у€间笉寰楀皬浜庣瓑浜�0"}:_},P.updateArrowStatus=function(t,e){var i=e.find("input").first(),o=parseInt(i.val()),n=e.find(".w-icon-arrow-up"),a=e.find(".w-icon-arrow-down"),s={isSuccess:!0},_={isSuccess:!0},l=o+1,d=o-1;i.hasClass("total_value")?(s=P.checkTotalValue(t,l),_=P.checkTotalValue(t,d)):i.hasClass("max_answer_num")?(s=P.checkMaxNum(t,l),_=P.checkMaxNum(t,d)):i.hasClass("min_answer_num")&&(s=P.checkMinNum(t,l),_=P.checkMinNum(t,d)),s.isSuccess?n.removeClass("w-icon-arrow-disabled"):n.addClass("w-icon-arrow-disabled"),_.isSuccess?a.removeClass("w-icon-arrow-disabled"):a.addClass("w-icon-arrow-disabled")},P.question_default_text_dic={project:{survey:{title:"闂嵎鏍囬",begin:"鎰熻阿鎮ㄨ兘鎶藉嚭鍑犲垎閽熸椂闂存潵鍙傚姞鏈绛旈锛岀幇鍦ㄦ垜浠氨椹笂寮€濮嬪惂锛�",end1:"鎮ㄥ凡瀹屾垚鏈闂嵎锛屾劅璋㈡偍鐨勫府鍔╀笌鏀寔",end2:"涓嶅ソ鎰忔€濓紝鎮ㄤ笉澶€傚悎鏈璋冩煡锛岃阿璋㈡偍鐨勫弬涓�"},satis:{title:"婊℃剰搴﹁皟鏌ユ爣棰�",begin:"鎰熻阿鎮ㄨ兘鎶藉嚭鍑犲垎閽熸椂闂存潵鍙傚姞鏈绛旈锛岀幇鍦ㄦ垜浠氨椹笂寮€濮嬪惂锛�",end1:"鎮ㄥ凡瀹屾垚鏈闂嵎锛屾劅璋㈡偍鐨勫府鍔╀笌鏀寔",end2:"涓嶅ソ鎰忔€濓紝鎮ㄤ笉澶€傚悎鏈璋冩煡锛岃阿璋㈡偍鐨勫弬涓�"},form:{title:"琛ㄥ崟鏍囬",begin:"鎰熻阿鎮ㄨ兘鎶藉嚭鍑犲垎閽熸椂闂存潵濉啓浠ヤ笅鍐呭锛岀幇鍦ㄦ垜浠氨椹笂寮€濮嬪惂锛�",end1:"琛ㄥ崟宸叉垚鍔熸彁浜わ紝璋㈣阿鎮ㄧ殑鍙備笌",end2:"鎶辨瓑锛屾偍涓嶅お閫傚悎濉啓鏈〃鍗曪紝璋㈣阿鎮ㄧ殑鍙備笌"},assess:{title:"娴嬭瘎鏍囬",begin:"鎰熻阿鎮ㄨ兘鎶藉嚭鍑犲垎閽熸椂闂存潵鍙傚姞鏈绛旈锛岀幇鍦ㄦ垜浠氨椹笂寮€濮嬪惂锛�",end1:"娴嬭瘯缁撴潫锛屼綘鐨勫緱鍒嗘槸[Score]鍒�",end2:"浜诧紝鏈娴嬭瘎涓嶅お閫傚悎鎮紝璋㈣阿锛�"},vote_scene:{title:"鎶曠エ鏍囬",begin:"娆㈣繋鍙備笌鏈鎶曠エ锛岀幇鍦ㄦ垜浠氨椹笂寮€濮嬪惂锛�",end1:"鎶曠エ鎴愬姛锛屾劅璋㈡偍鐨勫府鍔╀笌鏀寔",end2:"涓嶅ソ鎰忔€濓紝鎮ㄤ笉澶€傚悎鏈璋冩煡锛岃阿璋㈡偍鐨勫弬涓�"}},"鍗曢€夐":{question_type:2,disp_type:"",title:"璇烽€夋嫨涓€涓€夐」",option:"閫夐」"},"澶氶€夐":{question_type:3,disp_type:"",title:"璇烽€夋嫨浠ヤ笅閫夐」 (澶氶€�)",title1:"鍗曢€夐",option:"閫夐」"},"鍥剧墖閫夋嫨棰�":{question_type:2,disp_type:"image_single",title:"璇烽€夋嫨浠ヤ笅鍥剧墖",option:"鍥剧墖"},"鍥剧墖澶氶€夐":{question_type:3,disp_type:"image_multiple",title:"鍥剧墖閫夋嫨棰�",option:"鍥剧墖"},"鍥剧墖鎶曠エ棰�":{question_type:2,disp_type:"imagevote_single",title:"璇风粰浠ヤ笅鍥剧墖鎶曠エ",option:"鍥剧墖"},"鍥剧墖鎶曠エ棰樺閫�":{question_type:3,disp_type:"imagevote_multiple",title:"鍥剧墖鎶曠エ棰�",option:"鍥剧墖"},"鏂囧瓧鎶曠エ棰�":{question_type:2,disp_type:"singlevote",title:"璇风粰浠ヤ笅閫夐」鎶曠エ",option:"閫夐」"},"鏂囧瓧鎶曠エ棰樺閫�":{question_type:3,disp_type:"multiplevote",title:"鏂囧瓧鎶曠エ棰�",option:"閫夐」"},"涓嬫媺棰�":{question_type:2,disp_type:"dropdown",title:"璇烽€夋嫨涓€涓€夐」",option:"閫夐」"},"涓嬫媺澶氶€夐":{question_type:3,disp_type:"multiple_dropdown",title:"璇烽€夋嫨浠ヤ笅閫夐」 (澶氶€�)",option:"閫夐」"},"鍗曡濉┖棰�":{question_type:6,disp_type:"",title:"璇峰～鍐欐湰椤瑰唴瀹�"},"澶氳濉┖棰�":{question_type:6,disp_type:"multiple",title:"濉┖棰�"},"澶氶」濉┖棰�":{question_type:95,disp_type:"",title:"璇峰～鍐欎互涓嬪唴瀹�",option:"濉┖"},"鎵撳垎棰�":{question_type:50,disp_type:"",title:"璇风粰鏈」鎵撳垎",option:"閫夐」"},"NPS 棰�":{question_type:50,disp_type:"nps_score",title:"鎮ㄥ悜鏈嬪弸鎴栧悓浜嬫帹鑽愭垜浠殑鍙兘鎬ф湁澶氬ぇ锛�"},"鎺掑簭棰�":{question_type:60,disp_type:"",title:"璇风粰浠ヤ笅閫夐」鎺掑簭",option:"閫夐」"},"澶囨敞璇存槑":{question_type:70,disp_type:"",title:"璇烽槄璇绘湰椤硅鏄庯紝鐒跺悗鍥炵瓟闂"},"濮撳悕":{question_type:6,disp_type:"name",title:"濮撳悕"},"鎵嬫満":{question_type:6,disp_type:"mobile",title:"鎵嬫満"},"閭":{question_type:6,disp_type:"email",title:"閭"},"鎬у埆":{question_type:2,disp_type:"sex",title:"鎬у埆",option:"鐢�",option1:"濂�"},"鏃ユ湡棰�":{question_type:95,disp_type:"date",title:"鏃ユ湡"},"鏃堕棿":{question_type:95,disp_type:"time",title:"鏃堕棿"},"鍦板潃":{question_type:8,disp_type:"address",title:"鍦板潃"},"鍦扮悊浣嶇疆":{question_type:95,disp_type:"geographical_multiple_blank",title:"鎵€鍦ㄤ綅缃�"},"涓婁紶棰�":{question_type:95,disp_type:"upload_file",title:"璇蜂笂浼犳枃浠�"},"鐭╅樀鍗曢€夐":{question_type:4,disp_type:"",title:"璇烽€夋嫨浠ヤ笅閫夐」",option:"閫夐」",option1:"鐭╅樀琛�"},"鐭╅樀澶氶€夐":{question_type:5,disp_type:"",title:"鐭╅樀鍗曢€夐",option:"閫夐」",option1:"鐭╅樀琛�"},"鐭╅樀鎵撳垎棰�":{question_type:7,disp_type:"",title:"璇风粰浠ヤ笅鍚勯」鎵撳垎",option:"鎵撳垎",option1:"鐭╅樀琛�"},"鐭╅樀濉┖棰�":{question_type:100,disp_type:"",title:"璇峰～鍐欎互涓嬪唴瀹�",option:"濉┖",option1:"鐭╅樀琛�"},"鐭╅樀閲忚〃棰�":{question_type:50,disp_type:"matrix_scale",title:"璇锋偍瀵逛互涓嬪悇琛屽唴瀹硅繘琛岃瘎浠�",option:"鏍囬"},"閲忚〃棰�":{question_type:50,disp_type:"scale",title:"璇锋偍瀵规椤圭洰杩涜璇勪环",option:"鏍囬"},"鍒ゆ柇棰�":{question_type:2,disp_type:"judge",title:"璇峰垽鏂湰椤瑰彊杩版槸鍚︽纭紵",option:"鏄�",option1:"鍚�"},"绠€绛旈":{question_type:6,disp_type:"short_answer",title:"璇风畝瑕侀槓杩颁綘鐨勮鐐�"},"绾ц仈棰�":{question_type:8,disp_type:"cascader",title:"璇烽€夋嫨浠ヤ笅閫夐」"},"姣旈噸棰�":{question_type:50,disp_type:"proportion",title:"璇烽€夋嫨浠ヤ笅鍚勯」鎵€鍗犵殑鐧惧垎姣�",option:"閫夐」"},"妯悜濉┖棰�":{question_type:95,disp_type:"horz_blank",title:"璇峰～鍐欎互涓嬩俊鎭�",option:'濮撳悕<span class="ipt-wrap"><input type="text" style="width: 64px"></span>骞撮緞<span class="ipt-wrap"><input type="text" style="width: 32px"></span>宀�<br>鑱旂郴鏂瑰紡<span class="ipt-wrap"><input type="text" style="width: 88px"></span>'},"骞撮緞":{question_type:2,disp_type:"age",title:"鎮ㄧ殑骞撮緞鏄�",option:"18宀佷互涓�",option1:"18~24宀�"},"瀛﹀巻":{question_type:2,disp_type:"education",title:"鎮ㄧ殑鏈€楂樺鍘嗭紙鍚洰鍓嶅湪璇伙級鏄紵",option:"灏忓鍙婁互涓�",option1:"鍒濅腑"},"鑱屼笟":{question_type:2,disp_type:"occupation",title:"鎮ㄧ洰鍓嶇殑鑱屼笟鏄紵",option:"鍦ㄦ牎瀛︾敓",option1:"鏀垮簻/鏈哄叧骞查儴/鍏姟鍛�"},"瀹屽舰濉┖":{question_type:95,disp_type:"cloze",title:"瀹屽舰濉┖"},"鍒嗙被棰�":{question_type:QUESTION_TYPE_CLASSIFICATION,disp_type:"",title:"璇锋寜鐓у垎绫昏鍒欙紝灏嗗乏渚ч€夐」鎷栧叆鍙充晶鍒嗙粍涓�",option:"閫夐」",option1:"绫诲埆"},"閫夎瘝濉┖":{question_type:QUESTION_TYPE_MULTIPLE_BLANK,disp_type:"banked_cloze",title:"閫夎瘝濉┖",option:"閫夐」",option1:["璇疯緭鍏ユ爣棰�","鐨�","鍦�","寰�"]}},P.format_option_description=function(t){var e=delete_html_tag(t);return e=e||"[鍥剧墖]"},P.showEndDescPlaceHolder=function(t){var e=t.html(),i=t.text(),o=/<(?:\/?img*\b(?:[=\s](['"]?)[\s\S]*?\1)*)\/?>/g.test(e)||!!i.replace(/\n/g,"");console.log("has-value",o),t.attr("has-value",o)},P.option_character_limit=function(t,e){return t.length>e&&(t=t.substring(0,e)+"..."),t},P.verify_question_option={show:function(t,e){$("#question_box").children("div").each(function(){$(this).attr("oid")==t&&($('<div class="edit_type_error">'+e+"</div>").insertBefore($(this).find(".q_content_wrap")),$(this).addClass("new_q_operate"))})},hide:function(t){$("#question_box").children("div").each(function(){$(this).attr("oid")==t&&($(this).find(".edit_type_error").remove(),$(this).removeClass("new_q_operate"))})}},P.matrixWidth_callback=function(t,e,i){QUESTION_DICT[t]=i,QMODEL_DICT[t]=null;var o=$("#question_"+t).find(".option_table"),n=0;o.find(">tbody tr").each(function(t){n=0,$(this).children("td").each(function(t){var i=$(this),o=parseFloat(i.css("paddingLeft"))+parseFloat(i.css("paddingRight"))+1;null==e[t]&&(e[t]=e[t-1]);var a=i.find(".td_wrap"),s=parseFloat(a.css("paddingLeft"))+parseFloat(a.css("paddingRight"))-10;a.css("width",parseInt(e[t])-s+"px"),n+=e[t]+o})}),o.width(n),$(".jsbox_close").click()},P.checkVideo=function(t){return t.match(/http(s)?:\/\/v.qq.com\/txp\/iframe\/player.html\?vid=([^&"]+)/)?"tx":t.match(/http(s)?:\/\/player.youku.com\/embed\/(.*)==/)?"yk":"global"},P.getVid=function(t){var e=/vid=([^&"]+)/.exec(t);return null!=e&&e[1]},P.getEmbed=function(t){var e=/embed\/(.*)==/.exec(t);return null!=e&&e[1]},P.saveVideo=function(t,e){var i,o,n="";switch(P.checkVideo(t)){case"tx":n="https://v.qq.com/txp/iframe/player.html?vid="+P.getVid(t)+"&autoplay=0&bullet=0";break;case"yk":n="https://player.youku.com/embed/"+P.getEmbed(t)+"=="}var a=$("#question_setting").find(".btn-layout-single:first-child"),s=a.attr("data-key"),_=a.attr("data-value"),l=edit_obj.parents(".question"),d=l.attr("oid"),r=$("#setting_main_wrap"),c=l.find(".q_seq").text(),p=[];if(edit_obj.hasClass("option_title")&&_&&-1!=_.indexOf(",")){p=_.split(","),_={layout:p[0],column_count:p[1]},l.find(".q_option_ul").attr({"data-column":_.column_count}),_=JSON.stringify(_);var u=P.format_data_to_obj(d,s,_);P.save_question_setting(u)}if(i='<iframe class="video-show-iframe" style="width:'+(o=parseInt(edit_obj.width()))+"px;height:"+parseInt(o/1.78)+'px" src="'+n+'" frameborder="0" allowfullscreen referrerpolicy="origin"></iframe>',edit_obj.find("iframe").length>0?edit_obj.html(edit_obj.html().replace(edit_obj.find("iframe").prop("outerHTML"),i)):edit_obj.append(i),edit_obj.hasClass("prefix_content"))P.save_project_content_editable_handler(edit_obj);else{var m=edit_obj.parents(".module"),v=m.attr("oid");P.save_question_content_editable_handler(m,v,edit_obj,e)}if(edit_obj.hasClass("option_title")&&_&&-1!=_.indexOf(",")){var f=P.get_question(d);f.custom_attr.layout=p[0],f.custom_attr.column_count=p[1],P.show_question_setting(r,d,c)}},P.validateVideoUrl=function(t){var e=t;if(e){var i=P.checkVideo(e);return 0!==e.length&&"global"!==i&&0!=(P.getVid(e)||P.getEmbed(e))||(Toast({message:"閾炬帴闈炴寚瀹氬钩鍙伴€氱敤浠ｇ爜",mask:!0}),!1)}return Toast({message:"杈撳叆鐨勯€氱敤浠ｇ爜涓虹┖",mask:!0}),!1},P.showOptionVideo=function(t,e,i){for(var o in t){var n=t[o];if(e==n.question_type&&("vertical"==i||"column"==i||n.disp_type==i)&&"show"===n.option_show_video)return!0}},P.getIframeBox=function(t,e){if(t.title){var i=parseInt($("#question_"+e).find(".q_title").width()),o=parseInt(i/1.78);$("#question_"+e).find(".q_title .video-show-iframe").css({width:i+"px",height:o+"px"})}var n=$("#question_"+e).attr("disp_type");(P.showOptionVideo(w.a,t.question_type,n)||!1)&&t.option_list&&t.option_list.length>0&&t.option_list.map(function(e,i){var o=$("#option_"+t.option_id_list[i]),n=parseInt(o.find(".option_title").width()),a=n/1.78;o.find(".option_title .video-show-iframe").css({width:n+"px",height:a+"px"})})},P.isShowColumnHandler=function(t,e){var i=$(t).parents(".module"),o=i.attr("disp_type"),n=i.attr("question-type"),a=$("#question_setting").find(".btn-layout-single");if((P.showOptionVideo(w.a,n,o)||!1)&&a.attr("status")&&!("open_video"==a.attr("status")||"disabled_video"==a.attr("status")&&$(t).find(".video-show-iframe").length>0)){e=i.attr("oid");var s=$("#setting_main_wrap"),_=i.find(".q_seq").text();P.show_question_setting(s,e,_)}},P.one_page_one_question=function(t,e){var i={project_id:get_oid(project),one_page_one_question:t};P.ajaxPost("/project/ajax_one_page_one_question_setting/",i,function(t){200==t.status&&1==t.status_code&&e&&e()})},P.setting_one_page_one_question=function(){var t=$(this),e="1"==t.attr("data-value")?"0":"1";P.one_page_one_question(e,function(){project.custom_attr.one_page_one_question=e,t.toggleClass("checked"),t.attr({"data-value":e});var i=$(".question_type_wrap").find('label[question-type="page"], label[disp-type="split_line"]'),o=$(".survey_question_wrap").find('.question_page, .question_split_line[disp_type="split_line"]');"1"==e?(i.addClass("split_line_or_paging_disabled show_title"),o.addClass("split_line_or_paging_disabled")):(i.removeClass("split_line_or_paging_disabled show_title"),o.removeClass("split_line_or_paging_disabled"))})},P.horizontal_blank_handler=function(t,e){var i=e.parents(".question").attr("oid");e.hasClass("horz_question_content")&&P.toggle_horz_blank_style(t,i)},P.toggle_horz_blank_style=function(t,e){var i=P.get_qmodel(e);$("#question_"+e);"focus"==t&&i.input_change_to_underline()},P.save_horz_blank=function(t,e){var i=QUESTION_DICT[t],o=(i.p_type,P.get_qmodel(t)),n=i.custom_attr.horz_blank_content;if(e!=n){var a=(e.match(/\_{3,}/g)||[]).length,s=i.option_list.length;if(a>50)return $(".loadCon,.loadMack").remove(),jsAlert({content:"<p style='text-align:left;'>鏈€澶氬彧鑳芥坊鍔�50涓€夐」</p>",obj:function(){}}),$("#question_"+t).find(".horz_question_content").html(n),void o.underline_change_to_input();if(a==s&&P.save_question_setting({project_id:get_oid(project),question_id:t,attr_key:"horz_blank_content",attr_value:e}),a>s){for(var _=a-s,l=[],d=0;d<_;d++)l.push({title:"濉┖"+(s+d+1),question_id:t});var r={question_id:t,option_list_str:toJSONString(l),horz_blank_content:e};P.create_option(t,r,function(i){P.update_option(t,i),QUESTION_DICT[t].custom_attr.horz_blank_content=e,t&&2==project.p_type&&P.question_answer_score_template(t)})}if(a<s){var c=new RegExp('<span class="ipt-wrap">(<input[^<>]+>)<span class="input_vr_icon"></span></span>',"g");if((e.match(c)||[]).length>0)return;_=s-a;var p=i.option_id_list;for(l=[],d=0;d<_;d++)l.push(p[p.length-(d+1)]);r={qid:t,option_id_or_list:toJSONString(l),horz_blank_content:e};P.delete_option(t,r,"",function(t){t.qid&&2==project.p_type&&P.question_answer_score_template(t.qid)})}o.underline_change_to_input()}else o.underline_change_to_input()},P.show_blank_attr_popup=function(t){var e=QUESTION_DICT[t];e.custom_attr.horz_blank_content=P.return_underline_change_to_input(e.custom_attr.horz_blank_content);var i=$("#q_horizontal_blank_attr_popup").html(),o=juicer(i,e),n=new Popup({head:{inner:"濉┖灞炴€�"},content:{inner:o,class:"blank-attr-popup"},btnLeft:"鍙栨秷",isFixed:!1,btnAlign:"right",showMask:!0,maskClickClose:!0,showCloseBtn:!0,noScroll:!1,btnRight:{inner:"纭畾",class:"popup_btn_item popup_btn_right",onClick:function(){P.save_horz_blank_attr(t,function(){n.destroy()})}},destroyOnClose:!0});P.blank_attr_popup_bind_event(),n.show()},P.blank_attr_popup_bind_event=function(){Selector(".content-limit-select","",function(t){var e=$(t.currentTarget),i=e.data("value"),o=e.parents("tr");o.find(".content-limit").attr("data-val",i),"mobile"==i?o.find(".count-limit div").addClass("hide").find("input").val(""):o.find(".count-limit div").removeClass("hide")});$(".popup_wrap").on("click",".w-select .w-select-input",function(t){var e=t.target,i=$($(e).closest(".w-select-dom")).find(".w-select-options-wrapper"),o=$(i).closest(".w-select").offset().top-$(".popup_wrap").offset().top+30;$(i).css({top:o})}),$(".setting-wrap").scroll(function(){$(".w-select-options-wrapper").hide(),$(".active-input").removeClass("active-input")}),$(".setting-wrap tr").click(function(){var t=$(this),e=+t.attr("data-index");t.addClass("active").siblings().removeClass("active"),$(".blank-attr-popup .question-wrap .ipt-wrap").removeClass("active"),$(".blank-attr-popup .question-wrap .ipt-wrap:eq("+e+")").addClass("active")}),$(".setting-wrap .required-all input").click(function(){var t=$(this).prop("checked");$(".setting-wrap .required input").prop("checked",t)}),$(".setting-wrap .count-limit input").keyup(function(){P.validationNum($(this))})},P.return_underline_change_to_input=function(t){for(var e=t,i=e.match(/\_{3,}/g)||[],o=0;o<i.length;o++){var n=i[o],a='<span class="ipt-wrap"><input type="text" disabled style="width: '+8*n.length+'px"></span>';e=e.replace(n,a)}return e},P.save_horz_blank_attr=function(t,e){for(var i=QUESTION_DICT[t],o=(i.option_list,i.option_id_list),n=$("#horz_pop_"+t+" table"),a={},s=0;s<o.length;s++){var _=n.find("tr.oid_"+o[s]),l={checkmethod:_.find(".content-limit").attr("data-val"),char_count_limit:_.find(".count-limit input").val().trim()?"on":"none",char_count:+_.find(".count-limit input").val().trim(),allow_null:_.find(".required input").prop("checked")?"none":"on"};a[o[s]]=l}P.save_question_setting({project_id:get_oid(project),question_id:t,attr_key:"horz_blank_attr",attr_value:JSON.stringify(a)},e)},P.horz_insert_underline=function(t){var e,i;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(i=e.getRangeAt(0)).deleteContents();var o=document.createElement("div");o.innerHTML=t;for(var n,a,s=document.createDocumentFragment();n=o.firstChild;)a=s.appendChild(n);i.insertNode(s),a&&((i=i.cloneRange()).setStartAfter(a),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)},P.setUploadImgStatus=function(t,e){var i=P.get_question(t),o=e.match(/<img/g);i.question_type==QUESTION_TYPE_CLASSIFICATION&&o&&o.length>0?$("#edit_tool_bar .left .add_image").addClass("disabled_upload_img"):$("#edit_tool_bar .left .add_image").removeClass("disabled_upload_img")},P.hideOperationWrap=function(t){t&&t.hasClass("classify_operate_icon")||($(".classify_operate_icon").removeClass("focused_operate"),$(".option_operation_wrap").remove())},P.moveExtraOption=function(t,e,i,o){var n={question_id:t,extra_option_id:e,direction:i};P.ajaxPost("/edit/ajax/extra_option_move/"+get_oid(project),n,function(e){isNotEmpty(e.extra_option_id_list)&&(P.get_question(t).extra_option_id_list=e.extra_option_id_list,o&&o())})},P.updateClassificationOptionSort=function(t,e,i,o){var n="extra_option"==o?$("#question_"+t+" #extra_option_"+e):$("#question_"+t+" #option_"+e);if("move_up"==i){var a=n.prev();n.after(a)}else if("move_down"==i){var s=n.next();n.before(s)}},P.deleteExtraOption=function(t,e,i){var o,n=null;e.constructor==Array?optionoptionParam=toJSONString(e):n=e,o={qid:t,extra_option_id_or_list:n},P.ajaxPost("/edit/ajax/delete_extra_option/"+get_oid(project),o,function(o){var n=get_question(t);if(e.constructor==Array)for(var a=0;a<e.length;a++){var s=e[a],_=n.extra_option_id_list.indexOf(s);n.extra_option_id_list.remove(_),n.extra_option_list.remove(_)}else{_=n.extra_option_id_list.indexOf(e);n.extra_option_id_list.remove(_),n.extra_option_list.remove(_)}P.update_question(n),i&&i()})},P.classificationOptionOperate=function(t,e,i,o){if(check_in(o,["move_up","move_down"])){var n="move_up"==o?"up":"down";"extra_option"==i?P.moveExtraOption(t,e,n,function(){P.updateClassificationOptionSort(t,e,o,i)}):P.move_option(t,e,n,function(){P.updateClassificationOptionSort(t,e,o,i)})}else"delete"===o&&("extra_option"===i?P.deleteExtraOption(t,e,function(){$("#question_"+t+" #extra_option_"+e).remove();var i=$("#question_"+t+" .q_category_list ul li");1===i.length&&i.find(".classify_operate_icon").hide(),P.updateCategoryMinMaxSelect(t),P.updateImgList(t,e,"","extra_option")}):$.when(P.delete_option(t,e,!0)).done(function(){$("#option_"+e).remove();var i=$("#question_"+t+" .q_option_list ul li");1===i.length&&i.find(".classify_operate_icon").hide(),P.updateCategoryMinMaxSelect(t),P.updateImgList(t,e,"","option")}))},P.addSingleCategory=function(t){var e=$("#question_"+t),i=P.get_new_option_title(t,"extra_option"),o=P.get_option_list_formatted(t,[i]);P.createExtraOption(t,o,function(i){P.create_option_callback(t,i,"extra_option");var o=e.find(".q_category_list .q_option_wrap");o.scrollTop(o[0].scrollHeight),setTimeout(function(){var t=i.extra_option_list[i.extra_option_list.length-1]._id.$oid;e.find("#extra_option_"+t+" .option_title").focus(),document.execCommand("selectAll",!1,null)})})},P.addMultiCategory=function(t,e,i){var o=P.get_question(e),n=o.question_type,a=o.extra_option_list.map(function(t){return t.title});P.show_batch_add_option_popup(t,n,e,i,a,"鎵归噺娣诲姞閫夐」")},P.renderExtraOption=function(t,e){var i=$("#question_"+t),o=m.optionTemplate.extra_option,n=juicer(o,{extra_option_list:e});i.find(".q_extra_option_ul").append(n)},P.createExtraOption=function(t,e,i){var o={question_id:t,extra_option_list_str:toJSONString(e)};P.ajaxPost("/edit/ajax/extra_option_create/"+get_oid(project),o,function(e){if(e.extra_option_limit){$(".loadCon,.loadMack").remove();var o='<p style="text-align:left;">鏈€澶氬彧鑳芥坊鍔�200涓€夐」</p>';return P.get_question(t).question_type===QUESTION_TYPE_CLASSIFICATION&&(o='<p style="text-align:left;">鏈€澶氬彧鑳芥坊鍔�10涓被鍒�</p>'),void jsAlert({content:o,obj:function(){}})}"200"==e.status&&i&&i(e)})},P.updateCategoryMinMaxSelect=function(t){var e=P.get_question(t),i=$("#setting_main_wrap[qid="+t+"]"),o=e.option_list.length,n=e.extra_option_list.length,a=e.custom_attr.category_min_num?parseInt(e.custom_attr.category_min_num):0,s=e.custom_attr.category_max_num?parseInt(e.custom_attr.category_max_num):0,_=i.find('.block_category select[data-key="category_min_num"]'),l=i.find('.block_category select[data-key="category_max_num"]'),d=Math.floor(o/n),r=a>d?0:a,c=0!==s&&s<d?s:d;if(s>o){var p=P.format_data_to_obj(t,"category_max_num","none");P.save_question_setting(p,function(){P.updateCategoryMaxSelect(t,l,r)})}else P.updateCategoryMaxSelect(t,l,r);if(a>d){p=P.format_data_to_obj(t,"category_answer_num","none");P.save_question_setting(p,function(){P.updateCategoryMinSelect(t,_,c)})}else P.updateCategoryMinSelect(t,_,c)},P.updateCategoryMinSelect=function(t,e,i){var o=P.get_question(t),n=o.option_list.length,a=o.extra_option_list.length,s=Math.floor(n/a);i=(i="none"==i||0==i?n:parseInt(i))>s?s:i;var _=parseInt(e.val()),l=P.get_select_html(1,i,"椤�");e.html(l).val(_),e.siblings(".w-select-dom").remove(),Selector(".category_min_select")},P.updateCategoryMaxSelect=function(t,e,i){var o=parseInt(e.val()),n=P.get_question(t).option_list.length,a=(i=parseInt(i))||1,s=P.get_select_html(a,n,"椤�");e.html(s).val(o),e.siblings(".w-select-dom").remove(),Selector(".category_max_select")},P.checkLimitLength=function(t,e,i){var o=e.val();e.val().length>i&&(errTooltip.show(t,{inner:"鏈€澶氳緭鍏�".concat(i,"瀛�"),direction:"top"}),e.val(o.slice(0,i)),setTimeout(function(){errTooltip.hidden()},1500))},P.addBatchExtraOption=function(t,e){var i=P.get_option_list_formatted(t,e);P.createExtraOption(t,i,function(e){P.create_option_callback(t,e,"extra_option")})},P.updateImgList=function(t,e,i,o,n){var a=P.get_question(t),s=/<img/.test(i),l=m.settingTemplate.image_edit,d=i.match(/(http:\/\/|https:\/\/)((\w|=|\?|\.|\/|&|-)+)/g),r=d&&d[0],c=$(".setting_item.classification_img_list"),p=$(".hd");if("extra_option"==o){var u=c.find(".extra_option_img_list");if(s){var v={type:"extra_option",option_id:e,img_address:r,img_name:n},f=juicer(l,v);p.removeClass("no_img"),0===u.find("div[oid=extra_option_"+e+"]").length&&u.append(f).removeClass("none"),a.classification_img_list.extra_option_img_list.push({extra_option_id:e,img_address:r,img_name:n})}else{u.find('div[oid="extra_option_'+e+'"]').remove(),0===c.find("input").length?(p.addClass("no_img"),c.find(".extra_option_img_list, .option_img_list").addClass("none")):0===u.find("input").length&&u.addClass("none");var h=a.classification_img_list.extra_option_img_list;a.classification_img_list.extra_option_img_list=_.filter(h,function(t){return t.extra_option_id!=e})}}else{var q=c.find(".option_img_list");if(s){v={type:"option",option_id:e,img_address:r,img_name:n},f=juicer(l,v);p.removeClass("no_img"),0===q.find("div[oid=option_"+e+"]").length&&q.append(f).removeClass("none"),a.classification_img_list.option_img_list.push({option_id:e,img_address:r,img_name:n})}else{q.find('div[oid="option_'+e+'"]').remove(),0==c.find("input").length?(p.addClass("no_img"),c.find(".extra_option_img_list, .option_img_list").addClass("none")):0===q.find("input").length&&q.addClass("none");var g=a.classification_img_list.option_img_list;a.classification_img_list.option_img_list=_.filter(g,function(t){return t.option_id!=e})}}},P.updateFirstOption=function(t,e){var i=$("#question_"+t);"extra_option"==e?i.find(".q_category_list ul li:first-child .classify_operate_icon").show():i.find(".q_option_list ul li:first-child .classify_operate_icon").show()},P.evaluation_popup_bind_event=function(t){$(".evaluation-edit-popup .tab-header li").on("click",function(){var e=$(this),i=parseInt(e.attr("data-index")),o=$(".edit-container[data-index="+i+"]"),n=o.find(".score-desc-edit");t.edit_num=i;var a=P.render_score_preview(t);$(".score-preview").html(a),e.addClass("selected").siblings().removeClass("selected"),o.addClass("selected").siblings().removeClass("selected");var s=n.val();n.val("").focus().val(s)}),$(".edit-container .score-desc-edit").on("input",function(e){var i=$(this).val().trim();i.length>0?$(".score-preview .score_desc").text("鈥�"+i+"鈥�"):$(".score-preview .score_desc").text(""),t.temp_data.label_data[t.edit_num+1].score_desc=i}),$(".edit-container .label-list-edit").on("compositionstart",function(t){$(this).attr("data-isChinese",!0)}),$(".edit-container .label-list-edit").on("input",function(e){"true"!==$(this).attr("data-isChinese")&&P.check_label_data($(this),t)}),$(".edit-container .label-list-edit").on("compositionend",function(e){$(this).attr("data-isChinese",!1),P.check_label_data($(this),t)})},P.check_label_data=function(t,e){var i,o=t.get(0),n=P.getCursorPosition(o),a=0,s=!1,_=t.val().split("\n");_.length>10&&(_=_.slice(0,10),s=!0);for(var l=0;l<_.length;l++){if(_[l].length>10){_[l]=_[l].slice(0,10),n=(a+=10)+l,s=!0;break}a+=_[l].length}i=_.join("\n"),t.val(i),s&&P.setCursorPosition(o,n);var d=e.edit_num;e.temp_data.label_data[d+1].label_list=_,e.temp_data.label_data[d+1].label_list_str=i;var r=P.render_score_preview(e);$(".score-preview").html(r)},P.create_evaluation_model=function(t){for(var e in t.edit_num=$("#question_"+t._id.$oid).find(".score_wrap span.active").length-1,t.temp_data={label_data:{}},t.option_list[1].custom_attr.label_data){var i=t.option_list[1].custom_attr.label_data[e];t.temp_data.label_data[e]={score_desc:i.score_desc,label_list:i.label_list,label_list_str:i.label_list.join("\n")}}},P.render_score_preview=function(t){var e=m.optionTemplate.evaluation_pop;return juicer(e,t)},P.template_change_reminder=function(t){var e=new Popup({head:{inner:"鍒囨崲妯℃澘鎻愰啋"},content:{inner:"鍒囨崲妯℃澘锛岀郴缁熷皢涓嶄細淇濆瓨鎮ㄥ垰鍒氬仛鎵€鐨勪慨鏀癸紝璇风煡鎮夈€�"},btnLeft:"鍙栨秷鎿嶄綔",btnRight:"纭畾",isFixed:!1,btnAlign:"right",showMask:!0,maskClickClose:!0,showCloseBtn:!0,noScroll:!1,popupType:"confirm",remind:!0,onClose:function(){e.destroy(),e=null},onLeftClick:function(){$(".popup_remindWrap .icon_check_box").hasClass("active")&&setCookie("notReminderTemplateChange",1,1e4),e.destroy(),e=null},onRightClick:function(){$(".popup_remindWrap .icon_check_box").hasClass("active")&&setCookie("notReminderTemplateChange",1,1e4),e.destroy(),e=null,t&&t()}});e.show()},P.evaluation_edit_confirm=function(t,e,i){var o={head:{inner:"缂栬緫纭"},content:{inner:"绗�".concat(t.join("銆�"),"鍒嗗€煎皻鏈坊鍔犳爣绛撅紝鐐瑰嚮鈥滀繚瀛樷€濆皢鑷姩鍏抽棴鈥滆嚦灏戦€夋嫨涓€涓爣绛锯€濊缃€�")},btnLeft:"鍙栨秷鎿嶄綔",btnRight:"淇濆瓨",isFixed:!1,btnAlign:"right",showMask:!0,maskClickClose:!0,showCloseBtn:!0,noScroll:!1,popupType:"confirm",remind:!1,onClose:function(){n.destroy(),n=null,i&&i()},onLeftClick:function(){n.destroy(),n=null,i&&i()},onRightClick:function(){n.destroy(),n=null,$("#question_setting .setting_item label.one_label_limit").removeClass("checked").attr("data-value","none"),e&&e()}},n=new Popup(o);n.show()},P.save_label_change=function(t,e){var i=P.get_question(t),o=i.option_list[1]._id.$oid,n=JSON.stringify(e);P.save_option_setting(o,"label_data",n,function(){var t=i._id.$oid,e=i.edit_num;delete(i=QUESTION_DICT[t]).temp_data,i.edit_num=e,$("#question_"+t).find(".q_option_ul").html(""),P.render_option(t,i.option_list)})},P.change_template=function(t,e,i,o){var n=$("#question_"+t),a=P.format_data_to_obj(t,e,i);P.save_question_setting(a,function(){var e=P.get_question(t);$("#question_"+t+" .q_option_ul").attr("class","q_option_ul ui-sortable "+o.iconType),n.find(".q_title").text(o.title),n.find(".q_option_ul").html(""),P.render_option(t,e.option_list),"customize"==e.custom_attr.base_on?(Selector.changeSelectorValue({selector:"#question_setting .evaluation-select",value:5}),$("#question_setting .evaluation-select").removeClass("none")):$("#question_setting .evaluation-select").addClass("none")})},P.getCursorPosition=function(t){var e=0;if(document.selection){t.focus();var i=document.selection.createRange();i.moveStart("character",-t.value.length),e=i.text.length}else(t.selectionStart||"0"==t.selectionStart)&&(e=t.selectionStart);return e},P.setCursorPosition=function(t,e){if(t.setSelectionRange)t.focus(),t.setSelectionRange(e,e);else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",e),i.moveStart("character",e),i.select()}},P.show_qlib_popup=function(t){var e=P.get_qlib_list_html("pop",{category_id:t});window.popup=new Popup({head:{inner:"棰樺簱",class:"q-lib-pop"},content:{inner:e,class:"q-lib-pop-content"},destroyOnClose:!0,btnLeft:{inner:"鍙栨秷",class:"popup_btn_item popup_btn_left",onClick:function(){if(P.qlib_list_bind_event(),window.globalData.qlib_checked_qid_list.length>0)new Popup({head:{inner:"鎻愮ず",class:"testclass"},content:{inner:"鏄惁娓呯┖骞跺叧闂搴撳脊绐楋紵",class:"testclass"},popupType:"confirm",btnLeft:"鍚�",btnRight:"鏄�",isFixed:!1,btnAlign:"right",showCloseBtn:!0,noScroll:!1,onRightClick:function(){P.qlib_init_checked_question(),popup.destroy()}}).show();else popup.destroy()}},btnRight:{inner:"娣诲姞 "+window.globalData.qlib_checked_qid_list.length+" 棰� 鑷抽」鐩�",class:"popup_btn_item popup_btn_right add-qlib-question-to-project",onClick:function(){if(P.qlib_list_bind_event(),0!=window.globalData.qlib_checked_qid_list.length){for(var t=[],e=project.questionpage_list[project.questionpage_list.length-1].question_list.length,i=0;i<window.globalData.qlib_checked_question_list.length;i++){var o=window.globalData.qlib_checked_question_list[i];t.push({questionlib_id:o.qid,index:i+e,is_search:o.is_search})}P.ajaxPost("/edit/ajax/questionlib_question_create/",{project_id:project_id,questionpage_id:project.questionpage_id_list[project.questionpage_id_list.length-1],questionlib_data:JSON.stringify(t),_xsrf:$.cookie("_xsrf")||""},function(t){P.qlib_create_question_callback(t.data),P.qlib_init_checked_question(),popup.destroy()})}else popup.destroy()}},isFixed:!1,btnAlign:"right",showMask:!0,showCloseBtn:!0,noScroll:!1,onClose:function(){P.qlib_list_bind_event(),P.qlib_init_checked_question()}}),window.popup.page=1,setTimeout(function(){var t=$(".qlib-list-wrap"),e=Selector("#qlib-popup .qlib-select","",function(t){var e=$(t.currentTarget).data("value");""!=e||1!=window.globalData.not_send_ajax?P.update_qlib_list({category_id:e}):window.globalData.not_send_ajax=!1});window.globalData.qlib_sele=e,$("#qlib-popup").on("click",".w-select .w-select-input",function(t){var e=t.target,i=$($(e).closest(".w-select-dom")).find(".w-select-options-wrapper"),o=$(i).closest(".w-select").offset().top-$("#qlib-popup").offset().top+34;$(i).css({top:o})}),$("#qlib-popup").scroll(function(){$(".w-select-options-wrapper").hide(),$(".active-input").removeClass("active-input")}),t.scroll(function(){0==t.scrollTop()?($(".tool-wrap").removeClass("bg-fff"),t.removeClass("mt58")):($(".tool-wrap").addClass("bg-fff"),t.addClass("mt58"));var e=t.scrollTop()+t.outerHeight(!0);$(".qlib-list-wrap .question-item:last").offset().top-100<=e&&(popup.page=+popup.page+1,window.globalData.qlibTotalPage>=popup.page&&P.update_qlib_list({page:popup.page,keywords:$(".qlib-search-ipt input").val().trim(),category_id:$("select[name=category_id]").val()}))}),popup.show()},200)},P.get_qlib_list_html=function(t,e){juicer.register("replace_tag",function(t){return t=replaceHtmlTag(t,"img","[鍥剧墖]"),t=replaceHtmlTag(t,"iframe","[瑙嗛]")});var i=e.keywords||"",o=e.category_id||"",n=e.page||"1";"undefined"!=typeof popup&&(popup.page=n);var a,s=e.page_size||"20";return $.ajax({url:"/es/questionlib/search",data:{keywords:i,category_id:o,page:n,page_size:s},async:!1,success:function(i){var n,s=i.data.question_lib_data;window.globalData.qlibTotalPage=s.total_page,$(".total-question span:last-child").text("鍏�"+(s.total>1e5?"100000+":s.total)+"棰�"),0==s.questionlib_list.length?$(".qlib-list-wrap").addClass("empty-list"):$(".qlib-list-wrap").removeClass("empty-list"),e.keywords?(window.globalData.not_send_ajax=!0,window.globalData.qlib_sele.changeValue({value:""}),$(".total-question span:first-child").removeClass("hide")):($(".total-question span:first-child").addClass("hide"),$(".qlib-search-ipt input").val("")),n="pop"==t?$("#qlib-popup-tpl").html():$("#qlib-popup-list-tpl").html(),a=juicer(n,{checked_question:window.globalData.qlib_checked_qid_list,listData:s,category_id:o,keywords:i.data.keywords,has_option_list:["鍗曢€夐","澶氶€夐","涓嬫媺濉┖棰�","澶氶」濉┖棰�","鎺掑簭棰�"]})}}),a},P.update_qlib_list=function(t){var e=P.get_qlib_list_html("list",t);t.page?($(".qlib-list-wrap").removeClass("empty-list"),$(".qlib-list-wrap").append(e)):$(".qlib-list-wrap").html(e)},P.qlib_create_question_callback=function(t){for(var e,i=t.page_id,o=t.question_list,n=0;n<o.length;n++){var a=o[n];e=a._id.$oid;q.sortObj.find(".module").length;P.question_create_update(i,a,q.questionSite);var s=P.get_question_html(a);P.hide_add_question_tip(q.sortObj),$(s).appendTo(q.sortObj),C.initQuestionEvent(e),P.update_question_cid(),$("#question_"+e).find(".q_title").length&&($("#question_"+e).find(".q_title").attr({contenteditable:!0}).focus(),document.execCommand("selectAll",!1,null))}$("html,body").animate({scrollTop:$("#question_"+e).offset().top-80},"slow"),$(".loadCon,.loadMack").remove(),q.eventEndTime=(new Date).getTime()},P.qlib_init_checked_question=function(){window.globalData.qlib_checked_question_list=[],window.globalData.qlib_checked_qid_list=[]},P.qlib_list_bind_event=function(){$(".question_type_wrap .question-lib-box").one({click:function(t){P.show_qlib_popup($(this).attr("data-id"))}},".qlib-search, .category-list p")},P.insertClozeBlank=function(t){var e=P.get_question(t);if(e.option_list.length>=50)return Toast.hidden(),Toast({message:"鏈€澶氬彧鑳芥坊鍔�50涓€夐」",maxWidth:"500px"}),void(window.isInsertCloze=!1);var i=m.optionTemplate.cloze_label,o=juicer(i,{order:n});P.insertHtmlBeforeCursor(o);var n=P.getClozeOrder(t),a=P.getClozeOptions(t);e.option_list.length!==a.length?P.deleteCloze(t,function(){P.createClozeBlank(t,n)}):P.createClozeBlank(t,n)},P.createClozeBlank=function(t,e){var i=P.get_question(t),o=P.getClozeContentList(t),n=o.length;(0===n||1===n&&""===o[0])&&(o=["",""]);var a="same"===i.custom_attr.cloze_score_rule,s=[{title:"濉┖",question_id:t,custom_attr:{cloze_option_content:"A;B;C;D",cloze_option_answer:"A",cloze_option_score:a?i.custom_attr.cloze_same_score:0}}],_={question_id:t,option_list_str:toJSONString(s),order:e,cloze_content_list:toJSONString(o)};P.create_option(t,_,function(i){QUESTION_DICT[t].custom_attr.cloze_content_list=o,QUESTION_DICT[t].option_list.splice(e-1,0,i.option_list[0]),QUESTION_DICT[t].option_id_list.splice(e-1,0,i.option_id_list[0]),P.updateClozeScore(t),P.renderClozeContent(t),window.isInsertCloze=!1,$("#question_".concat(t," .cloze_question_content")).click()})},P.insertHtmlBeforeCursor=function(t){var e,i;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(i=e.getRangeAt(0)).deleteContents();var o=document.createElement("div");o.innerHTML=t;for(var n,a,s=document.createDocumentFragment();n=o.firstChild;)a=s.appendChild(n);i.insertNode(s),a&&((i=i.cloneRange()).setStartAfter(a),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)},P.updateClozeScore=function(t){var e=P.get_question(t);if("same"===e.custom_attr.cloze_score_rule){var i=parseFloat(e.custom_attr.cloze_same_score);e.question_max_score=i*e.option_list.length}else{var o=0;e.option_list.forEach(function(t){o+=parseFloat(t.custom_attr.cloze_option_score)}),e.question_max_score=o}2===project.p_type&&(P.updateMaxScore(t),P.calculation_project_total_score())},P.renderClozeContent=function(t){var e=P.get_question(t),i={cloze_content_list:e.custom_attr.cloze_content_list,option_id_list:e.option_id_list},o=m.optionTemplate.cloze,n=juicer(o,i);$("#question_"+t+" .cloze_question_content").html(n)},P.getClozeOrder=function(t){var e=0;return $("#question_".concat(t," .cloze_lable")).each(function(t,i){if(e++,!$(i).attr("oid"))return!1}),e},P.getClozeOptions=function(t){var e=$("#question_"+t+" .cloze_question_content .cloze_lable"),i=[];return e.each(function(t,e){var o=e.getAttribute("oid");o&&i.push(o)}),i},P.getClozeContentList=function(t){var e=$("#question_"+t+" .cloze_question_content"),i=[""];return e.contents().each(function(t,e){if(3===e.nodeType||1===e.nodeType&&("BR"===e.nodeName||"IMG"===e.nodeName)){var o=3===e.nodeType?e.nodeValue||"":"BR"===e.nodeName?"<br>":e.outerHTML,n=i.length,a=i[n-1];i[n-1]=a+o,"text"}else 1===e.nodeType&&"cloze_lable"===e.className&&(i.push(""),"input")}),i},P.deleteCloze=function(t,e){var i=P.getClozeContentList(t),o=P.getClozeOptions(t),n=P.get_question(t),a=[],s={qid:t,cloze_content_list:toJSONString(i)};n.option_id_list.forEach(function(t){-1===o.indexOf(t)&&a.push(t)}),s.option_id_or_list=toJSONString(a),P.delete_option(t,s,"",function(){P.get_question(t).custom_attr.cloze_content_list=i,P.updateClozeScore(t),P.renderClozeContent(t),P.setFocus($("#question_".concat(t," .cloze_question_content"))),e&&e()})},P.saveClozeContent=function(t){var e=P.getClozeContentList(t),i=P.get_question(t),o=i.custom_attr.cloze_content_list;if(P.getClozeOptions(t).length!==i.option_list.length)P.deleteCloze(t);else{if(_.isEqual(e,o))return;P.save_question_setting({project_id:get_oid(project),question_id:t,attr_key:"cloze_content_list",attr_value:toJSONString(e)},function(){P.get_question(t).custom_attr.cloze_content_list=e,P.renderClozeContent(t)})}},P.checkClozeScore=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4?arguments[4]:void 0,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=t.val(),_=/^((0|[1-9][0-9]?)(\.5|\.)?|100)$/,l=!0;if(!_.test(s))if(l=!1,i){var d=s.length-1;for(s=s.slice(0,d);s&&!_.test(s);)s=s.slice(0,--d)}else s=o;l||(t.val(s),a&&P.showErrorTip(e.currentTarget,"鏁板€奸渶浠嬩簬0~100涔嬮棿锛屼负0.5鐨勬暣鏁板€�","top",2e3)),i||((_=/\.$/).test(s)&&(s=s.slice(0,s.length-1),t.val(s)),n&&n())},P.updateMaxScore=function(t){var e=P.get_question(t).question_max_score,i=$("#question_"+t+" .q_title .evaluation_score");if(0!==e)if(0===i.length){var o='<span class="evaluation_score">(鏈€楂樺垎鍊硷細'.concat(e,"鍒�)</span>");$("#question_"+t+" .q_title").append(o)}else i.text("(鏈€楂樺垎鍊硷細".concat(e,"鍒�)")).removeClass("hide");else i.remove()},P.showErrorTip=function(t,e,i,o,n){errTooltip.show(t,{inner:e,direction:i}),setTimeout(function(){errTooltip.hidden(),n&&n()},o)},P.insertBankedCloze=function(t){var e=P.get_question(t);if(e.option_list.length>=50)return Toast.hidden(),Toast({message:"璇ラ涓渶澶氬彲鎻掑叆50涓～绌虹",maxWidth:"500px"}),void(window.isInsertBankedCloze=!1);P.insertHtmlBeforeCursor('<input class="banked_cloze_option" disabled />');var i=P.getBankedClozeOptionOrder(t),o=P.getBankedClozeOption(t);e.option_list.length!==o.length?P.deleteBankedClozeOption(t,function(){P.createBankedClozeOption(t,i)}):P.createBankedClozeOption(t,i)},P.createBankedClozeOption=function(t,e){var i=P.getStemContentList(t),o={question_id:t,option_list_str:toJSONString([{title:"濉┖",question_id:t}]),order:e,stem_content_list:toJSONString(i)};P.create_option(t,o,function(o){var n=get_question(t);n.custom_attr.stem_content_list=i,n.custom_attr.stem_content_obj_list=Object(x.a)(i),n.option_list.splice(e-1,0,o.option_list[0]),n.option_id_list.splice(e-1,0,o.option_id_list[0]),P.updateBankedClozeScore(t),P.renderBankedCloze(t),P.updateAnswerSetting(t),window.isInsertBankedCloze=!1,setTimeout(function(){var e=edit_obj.parents("li").data("index");$("#question_".concat(t," .q_stem_content_ul li:nth-child(").concat(e+1,") .stem_content")).click()},100)})},P.deleteBankedClozeOption=function(t,e){$("#question_".concat(t," .stem_content[contenteditable=true]")).attr("contenteditable",!1);var i=P.getStemContentList(t),o=P.getBankedClozeOption(t),n=P.get_question(t),a=[],s={qid:t,stem_content_list:toJSONString(i)};n.option_id_list.forEach(function(t){-1===o.indexOf(t)&&a.push(t)}),s.option_id_or_list=toJSONString(a),P.delete_option(t,s,"",function(o){var n=P.get_question(t);n.custom_attr.stem_content_list=i,n.custom_attr.stem_content_obj_list=Object(x.a)(i),P.updateBankedClozeScore(t),P.renderBankedCloze(t),P.updateAnswerSetting(t),e&&e()})},P.saveStemContent=function(t){var e=P.getStemContentList(t),i=P.get_question(t),o=i.custom_attr.stem_content_list;if(P.getBankedClozeOption(t).length!==i.option_list.length)P.deleteBankedClozeOption(t);else{if(_.isEqual(e,o))return;P.save_question_setting({project_id:get_oid(project),question_id:t,attr_key:"stem_content_list",attr_value:toJSONString(e)},function(){P.updateBankedClozeQuestion(t)})}},P.getStemContentList=function(t){var e=$("#question_"+t+" .stem_content"),i=[];return e.each(function(t,e){var o=[""];$(e).contents().each(function(t,e){if(3===e.nodeType||1===e.nodeType&&("BR"===e.nodeName||"IMG"===e.nodeName)){var i=3===e.nodeType?e.nodeValue||"":"BR"===e.nodeName?"<br>":e.outerHTML,n=o.length,a=o[n-1];o[n-1]=a+i,"text"}else 1===e.nodeType&&$(e).hasClass("banked_cloze_option")&&(o.push(""),"input")}),i.push(o)}),i},P.getBankedClozeOption=function(t){var e=$("#question_"+t+" .stem_content .banked_cloze_option"),i=[];return e.each(function(t,e){var o=e.getAttribute("oid");o&&i.push(o)}),i},P.getBankedClozeOptionOrder=function(t){var e=0;return $("#question_".concat(t," .banked_cloze_option")).each(function(t,i){if(e++,!$(i).attr("oid"))return!1}),e},P.getStemOptionList=function(t){var e=$("#question_".concat(t," .stem_option_wrap .stem_option")),i=[];return e.each(function(t,e){i.push(e.innerText)}),i},P.updateBankedClozeScore=function(t){var e=P.get_question(t);if("select_correct"===e.custom_attr.calculation){var i=e.custom_attr.total_score,o=e.option_list.length;e.question_max_score=i*o}else e.question_max_score=parseFloat(e.custom_attr.total_score);2===project.p_type&&(P.updateMaxScore(t),P.calculation_project_total_score())},P.renderBankedCloze=function(t){var e=P.get_question(t),i={stem_content_obj_list:e.custom_attr.stem_content_obj_list,option_id_list:e.option_id_list,blank_style:e.custom_attr.blank_style},o=m.optionTemplate.banked_cloze,n=juicer(o,i);$("#question_"+t+" .q_stem_content_ul").html(n)},P.renderStemOption=function(t,e){e=P.get_question(t).extra_option_list;var i=m.optionTemplate.stem_option,o=juicer(i,{stemOptions:e});$("#question_"+t+" .q_stem_option_ul").html(o)},P.createStem=function(t){var e=P.get_question(t);if(e.custom_attr.stem_content_list.length>=50)return Toast.hidden(),void Toast({message:"鏈€澶氬彲娣诲姞50涓骞�",maxWidth:500});var i=[];$.extend(!0,i,e.custom_attr.stem_content_list),i.push(["璇疯緭鍏ユ爣棰�"]),P.save_question_setting({project_id:get_oid(project),question_id:t,attr_key:"stem_content_list",attr_value:toJSONString(i)},function(){P.updateBankedClozeQuestion(t),P.renderBankedCloze(t),$("#question_".concat(t," .q_stem_content_ul li:last-child .stem_content")).click(),document.execCommand("selectAll",!1,null)})},P.deleteStem=function(t,e){var i=$("#question_".concat(t," .q_stem_content_ul li:nth-child(").concat(e+1,")"));if(i.find(".banked_cloze_option").length>0)i.remove(),P.deleteBankedClozeOption(t);else{i.remove();var o=P.getStemContentList(t);P.save_question_setting({project_id:get_oid(project),question_id:t,attr_key:"stem_content_list",attr_value:toJSONString(o)},function(){P.updateBankedClozeQuestion(t),P.renderBankedCloze(t)})}},P.createSingleStemOption=function(t){if(P.get_question(t).extra_option_list.length>=200)return Toast.hidden(),void Toast({message:"鏈€澶氬彲娣诲姞200涓€夐」",maxWidth:500});var e=P.get_new_option_title(t,"extra_option"),i=P.get_option_list_formatted(t,[e]);P.createExtraOption(t,i,function(e){P.update_option(t,e),P.updateStemOption(t),$("#question_".concat(t," .q_stem_option_ul li:last-child .stem_option")).click(),document.execCommand("selectAll",!1,null)})},P.updateStemOption=function(t){P.renderStemOption(t),P.updateAnswerSetting(t)},P.createStemOptions=function(t,e){var i=P.get_option_list_formatted(t,e);P.createExtraOption(t,i,function(e){P.update_option(t,e),P.updateStemOption(t),$("#question_".concat(t," .q_stem_option_ul li:last-child .stem_option")).click(),document.execCommand("selectAll",!1,null)})},P.saveStemOptionSort=function(t){var e=[];$("#question_"+t+" .stem_option_item").each(function(t,i){e.push($(i).attr("oid"))});var i={question_id:t,extra_option_id_list:toJSONString(e)};P.ajaxPost("/edit/ajax_option_move/",i,function(t){if(200==t.status){var e=t.data.question,i=e._id.$oid;QUESTION_DICT[i]=e,P.updateStemOption(i)}})},P.updateBankedClozeQuestion=function(t){var e=P.get_question(t);e.custom_attr.stem_content_obj_list=Object(x.a)(e.custom_attr.stem_content_list)},P.saveBankedClozeSort=function(t){var e=P.getStemContentList(t),i=P.getBankedClozeOption(t),o={question_id:t,option_id_list:toJSONString(i),stem_content_list:toJSONString(e)};P.ajaxPost("/edit/ajax_option_move/",o,function(t){if(200==t.status){var e=t.data.question,i=e._id.$oid;QUESTION_DICT[i]=e,P.updateBankedClozeQuestion(i),P.renderBankedCloze(i),P.updateAnswerSetting(i)}})},P.checkTotalScore=function(t){var e=t.val(),i={isSuccess:!0,errMsg:"",recoverValue:t.parents(".w-input-number").data("value")},o=parseFloat(e);return(/\.(\d)*\./.test(e)||/(\.[^5])|(\.5[^5])/g.test(o))&&(i={isSuccess:!1,errMsg:"鐩墠鍙敮鎸�0.5鐨勮鍒嗘柟寮�",recoverValue:parseInt(e)+".5"}),i},P.saveTotalScore=function(t,e,i,o){if(i!==P.get_question(t).custom_attr.total_score+""){var n=P.format_data_to_obj(t,e,i);P.save_question_setting(n,function(e){2===project.p_type&&(P.updateMaxScore(t),P.calculation_project_total_score()),o&&o()})}},P.updateAnswerSetting=function(t){var e=P.get_question(t),i=_.cloneDeep(e);P.delete_tag(i);var o={option_list:i.option_list,extra_option_list:i.extra_option_list},n=m.settingTemplate.answer_setting,a=juicer(n,o);$("#question_setting .answer_settings").html(a),Selector("#question_setting .answer_settings .w-select")},P.initialTitleSwitching=function(t,e,i){P.save_title(t,"question",e,"",function(){i&&i()})},P.updateQuestionHtml=function(t,e,i,o,n){P.update_question_html(e,n),isNotEmpty(t.jumpconstraint_id_list2)||isNotEmpty(t.displayconstraint_id_list2),P.set_jumpconstraint_status(get_oid(t)),$("#question_"+e).addClass("question_focus"),P.question_answer_score_template(e,i,o,"",n),2==project.p_type&&P.calculation_project_total_score()},P.bindNumberInputEvent=function(t,e){var i={selector:"",min:0,max:100,step:1,isFloat:!1,canEmpty:!0,relatedSelector:"",relation:"",errMsg:"",errMsg1:"",saveParamKeys:["qid","key"],saveFn:function(){},saveCallback:function(){},validFunc:null};$.extend(i,t),i.selector.on({"hover input":function(t){var e=$(this),o=e.find(".w-icon-arrow-up"),n=e.find(".w-icon-arrow-down"),a=e.find("input"),s=a.val();"input"===t.type&&(s=i.isFloat?s.replace(/(^\.)|([^\d^\.]+)/g,""):s.replace(/[^0-9]/g,""),a.val(s));var _=i.isFloat?parseFloat(s):parseInt(s);if(i.canEmpty&&""===s)return o.addClass("w-icon-arrow-disabled"),void n.addClass("w-icon-arrow-disabled");var l=P.getMinAndMax(i),d=l.min,r=l.max,c=null;i.validFunc&&(c=i.validFunc(a)),_>r||_<d||c&&!c.isSuccess?(o.addClass("w-icon-arrow-disabled"),n.addClass("w-icon-arrow-disabled")):(_===r?o.addClass("w-icon-arrow-disabled"):o.removeClass("w-icon-arrow-disabled"),_===d?n.addClass("w-icon-arrow-disabled"):n.removeClass("w-icon-arrow-disabled"))},blur:function(t){var e=$(this),o=e.find("input"),n=o.val(),a=i.isFloat?parseFloat(n):parseInt(n),s=e.data("value"),_=[];if(i.saveParamKeys.forEach(function(t,i){_.push(e.data(t))}),i.canEmpty&&""===n)s!=n&&i.saveFn.apply(i,_.concat(["",function(){if(e.data("value",""),i.saveCallback){var t=e.data("qid")||e.data("pageid");t&&i.saveCallback(t)}}]));else{var l=i.errMsg,d=i.errMsg1,r=P.getMinAndMax(i),c=r.min,p=r.max;i.relatedSelector&&("le"===i.relation&&p<i.max&&a>p&&(l=d),"ge"===i.relation&&c>i.min&&a<c&&(l=d));var u=null;i.validFunc&&((u=i.validFunc(o)).isSuccess||(l=u.errMsg)),isNaN(a)||a>p||a<c||u&&!u.isSuccess?(o.focus(),P.showErrorTip(t.target,l,"top",2e3,function(){var t=s;u&&!u.isSuccess&&(t=u.recoverValue),o.val(t);var n=i.isFloat?parseFloat(s):parseInt(s);isNaN(n)&&e.find(".w-icon").addClass("w-icon-arrow-disabled"),n<p&&e.find(".w-icon-arrow-up").removeClass("w-icon-arrow-disabled"),n>c&&e.find(".w-icon-arrow-down").removeClass("w-icon-arrow-disabled")})):i.saveFn.apply(i,_.concat([a,function(){if(o.val(a),e.data("value",a),i.saveCallback){var t=e.data("qid")||e.data("pageid");i.saveCallback(t)}}])),o.removeClass("focus_border")}}},i.targetSelector),i.selector.on({click:function(t){var e=$(this),o=e.parents(".w-input-number"),n=o.find(".w-icon-arrow-up"),a=o.find(".w-icon-arrow-down"),s=o.find("input"),_=i.isFloat?parseFloat(s.val()):parseInt(s.val());if(isNaN(_))o.find(".w-icon").addClass(".w-icon-arrow-disabled");else{s.addClass("focus_border");var l=P.getMinAndMax(i),d=l.min,r=l.max,c=_;e.hasClass("w-icon-arrow-up")?((c=_+i.step)>=r?e.addClass("w-icon-arrow-disabled"):c>d&&a.removeClass("w-icon-arrow-disabled"),c<=r&&_>=d&&s.val(c)):((c=_-i.step)<=d?e.addClass("w-icon-arrow-disabled"):c<r&&n.removeClass("w-icon-arrow-disabled"),c>=d&&_<=r&&s.val(c))}}},i.targetSelector+" .w-icon")},P.getMinAndMax=function(t){var e=t.min,i=t.max;if(t.relatedSelector){var o=$(t.relatedSelector+" input").val(),n=t.isFloat?parseFloat(o):parseInt(o);isNaN(n)||("le"===t.relation&&n<i&&(i=n),"ge"===t.relation&&n>e&&(e=n))}return{min:e,max:i}},window.verify_question_option=P.verify_question_option,window.get_qmodel=P.get_qmodel,window.matrixWidth_callback=P.matrixWidth_callback;var Q=P,M={singleSelectType:{attr:a.a.singleSelectType,value:"鍗曢€夐",icon:"single",letter_spacing:"three_letter_spacing"},multipleSelectType:{attr:a.a.multipleSelectType,value:"澶氶€夐",icon:"multiple",letter_spacing:"three_letter_spacing"},judgeType:{attr:a.a.judgeType,value:"鍒ゆ柇棰�",icon:"judge",letter_spacing:"three_letter_spacing"},imageType:{attr:a.a.imageType,value:"鍥剧墖閫夋嫨",icon:"image"},imageVoteType:{attr:a.a.imageVoteType,value:"鍥剧墖鎶曠エ",icon:"image_vote"},fontVoteType:{attr:a.a.fontVoteType,value:"鏂囧瓧鎶曠エ",icon:"font_vote"},dropdownType:{attr:a.a.dropdownType,value:"涓嬫媺棰�",icon:"dropdown",letter_spacing:"three_letter_spacing"},cascaderType:{attr:a.a.cascaderType,value:"绾ц仈棰�",icon:"cascader",letter_spacing:"three_letter_spacing"},blankType:{attr:a.a.blankType,value:"濉┖棰�",icon:"blank",letter_spacing:"three_letter_spacing"},multipleBlankType:{attr:a.a.multipleBlankType,value:"澶氶」濉┖",icon:"multiple_blank"},shortAnswerType:{attr:a.a.shortAnswerType,value:"绠€绛旈",icon:"short_answer",letter_spacing:"three_letter_spacing"},scoreType:{attr:a.a.scoreType,value:"鎵撳垎棰�",icon:"score",letter_spacing:"three_letter_spacing"},npsType:{attr:a.a.npsType,value:"NPS 棰�",icon:"nps"},sortType:{attr:a.a.sortType,value:"鎺掑簭棰�",icon:"sort",letter_spacing:"three_letter_spacing"},remarkType:{attr:a.a.remarkType,value:"澶囨敞璇存槑",icon:"desc"},splitPageType:{attr:a.a.splitPageType,value:"鍒嗛〉",icon:"split_page",letter_spacing:"two_letter_spacing"},splitLineType:{attr:a.a.splitLineType,value:"鍒嗗壊绾�",icon:"split_line",letter_spacing:"three_letter_spacing"},nameType:{attr:a.a.nameType,value:"濮撳悕",icon:"name",letter_spacing:"two_letter_spacing"},mobileType:{attr:a.a.mobileType,value:"鎵嬫満",icon:"mobile",letter_spacing:"two_letter_spacing"},emailType:{attr:a.a.emailType,value:"閭",icon:"email",letter_spacing:"two_letter_spacing"},sexType:{attr:a.a.sexType,value:"鎬у埆",icon:"sex",letter_spacing:"two_letter_spacing"},dateType:{attr:a.a.dateType,value:"鏃ユ湡",icon:"date",letter_spacing:"two_letter_spacing"},timeType:{attr:a.a.timeType,value:"鏃堕棿",icon:"time",letter_spacing:"two_letter_spacing"},ageType:{attr:a.a.ageType,value:"骞撮緞",icon:"age",letter_spacing:"two_letter_spacing"},educationType:{attr:a.a.educationType,value:"瀛﹀巻",icon:"education",letter_spacing:"two_letter_spacing"},majorType:{attr:a.a.majorType,value:"涓撲笟",icon:"major",letter_spacing:"two_letter_spacing"},universityType:{attr:a.a.universityType,value:"闄㈡牎",icon:"university",letter_spacing:"two_letter_spacing"},industryType:{attr:a.a.industryType,value:"琛屼笟",icon:"industry",letter_spacing:"two_letter_spacing"},occupationType:{attr:a.a.occupationType,value:"鑱屼笟",icon:"occupation",letter_spacing:"two_letter_spacing"},addressType:{attr:a.a.addressType,value:"鍩庡競锛忓湴鍧€",icon:"address"},geographyType:{attr:a.a.geographyType,value:"鍦扮悊浣嶇疆",icon:"geography"},uploadFileType:{attr:a.a.uploadFileType,value:"鏂囦欢涓婁紶",icon:"upload"},matrixSelectType:{attr:a.a.matrixSelectType,value:"鐭╅樀閫夋嫨",icon:"matrix_select"},matrixScoreType:{attr:a.a.matrixScoreType,value:"鐭╅樀鎵撳垎",icon:"matrix_score"},matrixBlankType:{attr:a.a.matrixBlankType,value:"鐭╅樀濉┖",icon:"matrix_blank"},matrixScaleType:{attr:a.a.matrixScaleType,value:"鐭╅樀閲忚〃",icon:"matrix_scale"},scaleType:{attr:a.a.scaleType,value:"閲忚〃棰�",icon:"scale",letter_spacing:"three_letter_spacing"},horizontalBlankType:{attr:a.a.horizontalBlankType,value:"妯悜濉┖",icon:"horizontal_blank"},proportionType:{attr:a.a.proportionType,value:"姣旈噸棰�",icon:"proportion",letter_spacing:"three_letter_spacing"},classificationType:{attr:a.a.classificationType,value:"鍒嗙被棰�",icon:"classification",letter_spacing:"three_letter_spacing"},evaluationType:{attr:a.a.evaluationType,value:"璇勪环棰�",icon:"evaluation",letter_spacing:"three_letter_spacing"},clozeType:{attr:a.a.clozeType,value:"瀹屽舰濉┖",icon:"cloze"},bankedClozeType:{attr:a.a.bankedClozeType,value:"閫夎瘝濉┖",icon:"banked_cloze"}};function z(t,e,i){var o="";return"1"==i&&(o="split_line_or_paging_disabled"),function(t){return M.splitPageType.split_line_or_paging_disabled=t,M.splitLineType.split_line_or_paging_disabled=t,{survey:[{title:"閫夋嫨棰�",message:[M.singleSelectType,M.multipleSelectType,M.imageType,M.imageVoteType,M.fontVoteType,M.dropdownType,M.cascaderType,M.classificationType,M.scaleType]},{title:"濉┖棰�",message:[M.blankType,M.multipleBlankType,M.horizontalBlankType]},{title:"鎵撳垎鎺掑簭",message:[M.evaluationType,M.scoreType,M.npsType,M.sortType,M.proportionType]},{title:"澶囨敞璇存槑",message:[M.remarkType,M.splitPageType,M.splitLineType]},{title:"涓汉淇℃伅",message:[M.nameType,M.mobileType,M.emailType,M.sexType,M.dateType,M.timeType,M.ageType,M.educationType,M.majorType,M.universityType,M.industryType,M.occupationType,M.addressType,M.geographyType]},{title:"鍏朵粬棰樺瀷",message:[M.uploadFileType,M.matrixSelectType,M.matrixScoreType,M.matrixBlankType,M.matrixScaleType]}],form:[{title:"閫夋嫨棰�",message:[M.singleSelectType,M.multipleSelectType,M.imageType,M.imageVoteType,M.fontVoteType,M.dropdownType,M.cascaderType,M.scaleType]},{title:"濉┖棰�",message:[M.blankType,M.multipleBlankType,M.horizontalBlankType]},{title:"鎵撳垎鎺掑簭",message:[M.evaluationType,M.scoreType,M.npsType,M.sortType,M.proportionType]},{title:"澶囨敞璇存槑",message:[M.remarkType,M.splitLineType]},{title:"涓汉淇℃伅",message:[M.nameType,M.mobileType,M.emailType,M.sexType,M.dateType,M.timeType,M.ageType,M.educationType,M.majorType,M.universityType,M.industryType,M.occupationType,M.addressType,M.geographyType]},{title:"鍏朵粬棰樺瀷",message:[M.uploadFileType,M.matrixScaleType]}],assess:[{title:"閫夋嫨棰�",message:[M.singleSelectType,M.multipleSelectType,M.judgeType,M.imageType,M.dropdownType,M.scaleType]},{title:"濉┖棰�",message:[M.blankType,M.multipleBlankType,M.horizontalBlankType,M.shortAnswerType,M.bankedClozeType,M.clozeType]},{title:"澶囨敞璇存槑",message:[M.remarkType,M.splitPageType,M.splitLineType]},{title:"涓汉淇℃伅",message:[M.nameType,M.mobileType,M.emailType,M.sexType,M.dateType,M.timeType,M.ageType,M.educationType,M.majorType,M.universityType,M.industryType,M.occupationType,M.addressType,M.geographyType]},{title:"鍏朵粬棰樺瀷",message:[M.uploadFileType,M.cascaderType,M.proportionType,M.evaluationType]}],vote:[{title:"鎶曠エ棰�",message:[M.fontVoteType,M.imageVoteType]},{title:"閫夋嫨棰�",message:[M.singleSelectType,M.multipleSelectType,M.imageType,M.dropdownType,M.matrixSelectType,M.cascaderType,M.scaleType]},{title:"濉┖棰�",message:[M.blankType,M.multipleBlankType,M.horizontalBlankType,M.matrixBlankType]},{title:"鎵撳垎鎺掑簭",message:[M.evaluationType,M.scoreType,M.matrixScoreType,M.npsType,M.sortType,M.proportionType]},{title:"澶囨敞璇存槑",message:[M.remarkType]},{title:"涓汉淇℃伅",message:[M.nameType,M.mobileType,M.emailType,M.sexType,M.dateType,M.timeType,M.ageType,M.educationType,M.majorType,M.universityType,M.industryType,M.occupationType,M.addressType,M.geographyType]},{title:"鍏朵粬棰樺瀷",message:[M.uploadFileType,M.splitPageType,M.splitLineType,M.matrixScaleType]}],satis:[{title:"閫夋嫨棰�",message:[M.singleSelectType,M.multipleSelectType,M.imageType,M.imageVoteType,M.fontVoteType,M.dropdownType,M.cascaderType,M.classificationType,M.scaleType]},{title:"鎵撳垎鎺掑簭",message:[M.evaluationType,M.scoreType,M.npsType,M.sortType,M.proportionType]},{title:"濉┖棰�",message:[M.blankType,M.multipleBlankType,M.horizontalBlankType]},{title:"澶囨敞璇存槑",message:[M.remarkType,M.splitPageType,M.splitLineType]},{title:"涓汉淇℃伅",message:[M.nameType,M.mobileType,M.emailType,M.sexType,M.dateType,M.timeType,M.ageType,M.educationType,M.majorType,M.universityType,M.industryType,M.occupationType,M.addressType,M.geographyType]},{title:"鍏朵粬棰樺瀷",message:[M.uploadFileType,M.matrixSelectType,M.matrixScoreType,M.matrixBlankType,M.matrixScaleType]}]}}(o)[t=function(t,e){return t="vote_scene"==e?"vote":"satis"==e?"satis":"1"==t?"form":"2"==t?"assess":"survey"}(t,e)]}var D=function(t,e,i){var o=z(t,e,i),n=document.getElementById("left_question_template").innerHTML,a=juicer(n,{data:o});$(".question_type_wrap .question_type_dl").html(a),$.fn.mCustomScrollbar&&$(".question_type_wrap").mCustomScrollbar({theme:"minimal-dark",scrollInertia:0,mouseWheel:{preventDefault:!0}})};Object(S.b)(),window.juicer.set({"tag::interpolateOpen":"&{","tag::noneencodeOpen":"&&{"}),D(window.project.p_type,window.project.scene_type,window.project.custom_attr.one_page_one_question);var R=$(".survey_main"),B=$("#question_box");C.initMainEvent(R),Q.init_question(B,C),q.init(".question_type_wrap","#question_box",C)}]);